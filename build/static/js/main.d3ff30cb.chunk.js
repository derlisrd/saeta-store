(this["webpackJsonpsaeta-store"]=this["webpackJsonpsaeta-store"]||[]).push([[0],{348:function(e,t){},447:function(e,t){},449:function(e,t){},459:function(e,t){},461:function(e,t){},487:function(e,t){},489:function(e,t){},490:function(e,t){},495:function(e,t){},497:function(e,t){},503:function(e,t){},505:function(e,t){},524:function(e,t){},536:function(e,t){},539:function(e,t){},630:function(e,t){},631:function(e,t){},742:function(e,t,a){"use strict";a.r(t);var r=a(4),n=a(68),o=a.n(n),c=a(1),i=a.n(c),s=a(5),l=a.n(s),d=a(9),u=a(38),j=a.n(u),b=a(58),p=Object(b.b)(),m="",O="storefront",x="https://wopash.saetaweb.com/api/",h="Sistema",f="rtivcin5dlrl7x5h5pf4zqxrdxzlz43yp8ryrq47r98k",g="saetastore",_=a(81),v=a.n(_),C=function(e){return v.a.AES.decrypt(e,g).toString(v.a.enc.Utf8)},k={get:function(){var e=Object(d.a)(l.a.mark((function e(t){var a,r,n,o,c,i,s,d,u,b,p,m,O,h,g,_,v,k,S,y,w,F,I,P;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.table,r=t.sort,n=void 0===r?"":r,o=t.pagenumber,c=void 0===o?"":o,i=t.pagesize,s=void 0===i?"":i,d=t.fields,u=void 0===d?"":d,b=t.where,p=void 0===b?"":b,m=t.include,O=void 0===m?"":m,h=t.on,g=void 0===h?"":h,_=t.token,v=void 0===_?"":_,k=t.filtersSearch,S=void 0===k?"":k,y=t.filtersField,w=void 0===y?"":y,e.prev=1,F=C(v),I="".concat(x).concat(a,"?where=").concat(p,"&sort=").concat(n,"&page[number]=").concat(c,"&page[size]=").concat(s,"&fields=").concat(u,"&include=").concat(O,"&on=").concat(g,"&token=").concat(F,"&filters[search]=").concat(S,"&filters[field]=").concat(w),e.next=6,fetch(I,{headers:{"X-Api-Token":f}});case 6:return P=e.sent,e.next=9,P.json();case 9:return e.abrupt("return",e.sent);case 12:return e.prev=12,e.t0=e.catch(1),j.a.isCancel(e.t0)&&console.log("Request canceled",e.t0),e.abrupt("return",{response:"Error",message:e.t0});case 16:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t){return e.apply(this,arguments)}}(),getPromise:function(e){var t=e.table,a=e.sort,r=void 0===a?"":a,n=e.pagenumber,o=void 0===n?"":n,c=e.pagesize,i=void 0===c?"":c,s=e.fields,l=void 0===s?"":s,d=e.where,u=void 0===d?"":d,j=e.include,b=void 0===j?"":j,p=e.on,m=void 0===p?"":p,O=e.token,h=void 0===O?"":O,g=e.filtersSearch,_=void 0===g?"":g,v=e.filtersField,k=void 0===v?"":v;return new Promise((function(e,a){try{var n=C(h),c="".concat(x).concat(t,"?where=").concat(u,"&sort=").concat(r,"&page[number]=").concat(o,"&page[size]=").concat(i,"&fields=").concat(l,"&include=").concat(b,"&on=").concat(m,"&token=").concat(n,"&filters[search]=").concat(_,"&filters[field]=").concat(k);fetch(c,{headers:{"X-Api-Token":f}}).then((function(e){return e.json()})).then((function(t){return e(t)}))}catch(s){a(s)}}))},deleteImage:function(){var e=Object(d.a)(l.a.mark((function e(t){var a,r,n,o,c,i,s,d;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.table,r=t.path,n=t.idImage,o=t.token,e.prev=1,c=C(o),i="".concat(x).concat(a,"/").concat(r,"/?accion=deleteImage&token=").concat(c,"&idImage=").concat(n),e.next=6,j()({url:i,method:"DELETE",headers:{"X-Api-Token":f}});case 6:return s=e.sent,e.next=9,s.data;case 9:return e.abrupt("return",e.sent);case 12:return e.prev=12,e.t0=e.catch(1),d=[{results:"error",response:"error",message:e.t0}],e.abrupt("return",d);case 16:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t){return e.apply(this,arguments)}}(),uploadImage:function(){var e=Object(d.a)(l.a.mark((function e(t){var a,r,n,o,c,i,s,d,u,b,p;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.file,r=t.token,n=t.table,o=void 0===n?"":n,c=t.data,i=t.path,s=void 0===i?Date.now():i,(d=new FormData).append("table",o),d.append("path",s),d.append("data",JSON.stringify(c)),d.append("image",a),e.prev=6,u=C(r),e.next=10,j()({url:"".concat(x,"Upload/?token=").concat(u),method:"POST",data:d,headers:{"Content-Type":"multipart/form-data","X-Api-Token":f}});case 10:return b=e.sent,e.next=13,b.data;case 13:return e.abrupt("return",e.sent);case 16:return e.prev=16,e.t0=e.catch(6),p=[{results:"error",response:"error"}],e.abrupt("return",p);case 20:case"end":return e.stop()}}),e,null,[[6,16]])})));return function(t){return e.apply(this,arguments)}}(),login:function(){var e=Object(d.a)(l.a.mark((function e(t){var a,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,j()({url:"".concat(x,"Auth/Login"),method:"POST",data:JSON.stringify(t),headers:{"X-Api-Token":f}});case 3:return a=e.sent,e.next=6,a.data;case 6:return e.abrupt("return",e.sent);case 9:return e.prev=9,e.t0=e.catch(0),console.log(e.t0),r=[{results:"error",response:"error",message:e.t0}],e.abrupt("return",r);case 14:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),validateToken:function(){var e=Object(d.a)(l.a.mark((function e(t){var a,r,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=C(t),e.next=4,j()({url:"".concat(x,"Auth/ValidateToken"),method:"POST",data:JSON.stringify({token:a}),headers:{"X-Api-Token":f}});case 4:return r=e.sent,e.next=7,r.data;case 7:return e.abrupt("return",e.sent);case 10:return e.prev=10,e.t0=e.catch(0),n=[{results:"error",response:"error",message:e.t0}],e.abrupt("return",n);case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}(),updatePassword:function(){var e=Object(d.a)(l.a.mark((function e(t){var a,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,j()({url:"".concat(x,"Auth/UpdatePassword"),method:"POST",data:JSON.stringify(t),headers:{"X-Api-Token":f}});case 3:return a=e.sent,e.next=6,a.data;case 6:return e.abrupt("return",e.sent);case 9:return e.prev=9,e.t0=e.catch(0),r=[{results:"error",response:"error",message:e.t0}],e.abrupt("return",r);case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),confirmPassword:function(){var e=Object(d.a)(l.a.mark((function e(t){var a,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,j()({url:"".concat(x,"Auth/ConfirmPassword"),method:"POST",data:JSON.stringify(t),headers:{"X-Api-Token":f}});case 3:return a=e.sent,e.next=6,a.data;case 6:return e.abrupt("return",e.sent);case 9:return e.prev=9,e.t0=e.catch(0),r=[{results:"error",response:"error",message:e.t0}],e.abrupt("return",r);case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),register:function(){var e=Object(d.a)(l.a.mark((function e(t){var a,r,n,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.datos,e.prev=1,r="".concat(x,"Auth/Register"),e.next=5,j()({url:r,method:"POST",data:JSON.stringify(a),headers:{"X-Api-Token":f}});case 5:return n=e.sent,e.next=8,n.data;case 8:return e.abrupt("return",e.sent);case 11:return e.prev=11,e.t0=e.catch(1),o=[{results:"error",response:"error",message:e.t0}],e.abrupt("return",o);case 15:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t){return e.apply(this,arguments)}}(),insert:function(){var e=Object(d.a)(l.a.mark((function e(t){var a,r,n,o,c,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.table,r=t.data,n=t.token,e.prev=1,o=C(n),e.next=5,j()({url:"".concat(x).concat(a,"/?token=").concat(o),method:"POST",data:JSON.stringify(r),headers:{"X-Api-Token":f}});case 5:return c=e.sent,e.next=8,c.data;case 8:return e.abrupt("return",e.sent);case 11:return e.prev=11,e.t0=e.catch(1),i=[{results:"error",response:"error"}],e.abrupt("return",i);case 15:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t){return e.apply(this,arguments)}}(),update:function(){var e=Object(d.a)(l.a.mark((function e(t){var a,r,n,o,c,i,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.table,r=t.data,n=t.id,o=t.token,e.prev=1,c=C(o),e.next=5,j()({url:"".concat(x).concat(a,"/").concat(n,"/?token=").concat(c),method:"PUT",data:JSON.stringify(r),headers:{"X-Api-Token":f}});case 5:return i=e.sent,e.next=8,i.data;case 8:return e.abrupt("return",e.sent);case 11:return e.prev=11,e.t0=e.catch(1),s=[{results:"error",response:"error",message:e.t0}],e.abrupt("return",s);case 15:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t){return e.apply(this,arguments)}}(),delete:function(){var e=Object(d.a)(l.a.mark((function e(t){var a,r,n,o,c,i,s,d,u,b,p,m,O;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.table,r=t.id,n=void 0===r?"":r,o=t.token,c=t.namecolumns,i=void 0===c?"":c,s=t.ids,d=void 0===s?"":s,e.prev=1,u=C(o),b=""!==n?n+"/":"",p="".concat(x).concat(a,"/").concat(b,"?token=").concat(u,"&namecolumns=").concat(i,"&ids=").concat(d),e.next=7,j()({url:p,method:"DELETE",headers:{"X-Api-Token":f}});case 7:return m=e.sent,e.next=10,m.data;case 10:return e.abrupt("return",e.sent);case 13:return e.prev=13,e.t0=e.catch(1),O=[{results:"error",response:"error",message:e.t0}],e.abrupt("return",O);case 17:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(t){return e.apply(this,arguments)}}()},S=a(17),y=a.n(S),w=a(0),F=Object(c.createContext)(),I=function(){var e=Object(c.useContext)(F);return{logueado:e.logueado,recordar:e.recordar,setRecordar:e.setRecordar,cargando:e.cargando,Loguearse:e.Loguearse,setMensajeAlerta:e.setMensajeAlerta,mensajeAlerta:e.mensajeAlerta,nombre_user:e.nombre_user,id_user:e.id_user,rol_user:e.rol_user,token_user:e.token_user,cargandoMensaje:e.cargandoMensaje,DesLoguearse:e.DesLoguearse,username_user:e.username_user,permisos:e.permisos,DescifrarTexto:e.DescifrarTexto}},P=function(e){var t=e.children,a=Object(c.useState)(!1),n=Object(r.a)(a,2),o=n[0],i=n[1],s=Object(c.useState)(!1),u=Object(r.a)(s,2),j=u[0],b=u[1],m=Object(c.useState)(!0),O=Object(r.a)(m,2),x=O[0],h=O[1],f=Object(c.useState)(null),_=Object(r.a)(f,2),C=_[0],S=_[1],I=Object(c.useState)(!1),P=Object(r.a)(I,2),A=P[0],D=P[1],E=function(e){return v.a.AES.encrypt(e,g).toString()},N=JSON.parse(sessionStorage.getItem("dataUser"))||JSON.parse(localStorage.getItem("dataUser")),T={permisos:N?N.permisos:[],token_user:N?N.token_user:"",nombre_user:N?N.nombre_user:"",username_user:N?N.username_user:"",id_user:N?N.id_user:"",rol_user:N?N.rol_user:""},R=Object(c.useState)(T),M=Object(r.a)(R,2),L=M[0],W=M[1],z=Object(c.useCallback)(Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!L.token_user||""===L.token_user||o){e.next=5;break}return e.next=3,k.validateToken(L.token_user);case 3:(t=e.sent).found>0&&"ok"===t.response?i(!0):y()({title:t.response,text:t.message,icon:"error",dangerMode:!0}).then((function(){U()}));case 5:h(!1);case 6:case"end":return e.stop()}}),e)}))),[L,o]),q=Object(c.useCallback)(function(){var e=Object(d.a)(l.a.mark((function e(t){var a,r,n,o,c,s,d,u,b,m,O;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return S(null),D(!0),e.prev=2,e.next=5,Promise.all([k.getPromise({table:"empresas"}),k.login(t),k.getPromise({table:"monedas"})]);case 5:if(a=e.sent,r=a[0],n="ok"===r.response?r.results[0]:{},o=null===n||void 0===n?void 0:n.licencia,c=o.split("-"),(s=new Date).setFullYear(parseInt(c[0]),parseInt(c[1])-1,parseInt(c[2])),!(new Date>=s)){e.next=20;break}return y()({text:"Su licencia ha vencido.",icon:"warning"}),S("Su licencia ha vencido"),D(!1),e.abrupt("return",!1);case 20:if(!((d=a[1]).found>0&&"ok"===d.response)){e.next=39;break}return u=d.results[0],e.next=25,k.get({table:"permisos_users",where:"id_user_permiso,=,".concat(u.id_user),fields:"id_permiso_permiso"});case 25:b=e.sent,m=a[2],localStorage.setItem("dataMonedas",JSON.stringify(m.results)),O={permisos:b.results,token_user:E(u.token_user),nombre_user:u.nombre_user,username_user:E(u.username_user),id_user:u.id_user,rol_user:u.rol_user},W(O),i(!0),j?localStorage.setItem("dataUser",JSON.stringify(O)):sessionStorage.setItem("dataUser",JSON.stringify(O)),localStorage.setItem("dataEmpresa",JSON.stringify(n)),localStorage.removeItem("facturasStorage"),localStorage.removeItem("dataProductos"),p.push("/dashboard"),D(!1),e.next=41;break;case 39:S(a[1].message),D(!1);case 41:e.next=46;break;case 43:e.prev=43,e.t0=e.catch(2),y()({text:"Servidor no responde."});case 46:case"end":return e.stop()}}),e,null,[[2,43]])})));return function(t){return e.apply(this,arguments)}}(),[j]),U=function(){var e=Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{i(!1),D(!1),W({permisos:[],token_user:"",nombre_user:"",username_user:"",id_user:"",rol_user:""}),sessionStorage.removeItem("dataUser"),localStorage.removeItem("dataUser"),localStorage.removeItem("dataProductos"),localStorage.removeItem("facturasStorage"),localStorage.removeItem("compras")}catch(t){console.log(t)}case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(c.useEffect)((function(){var e=new AbortController,t=!0;return t&&z(),function(){t=!1,e.abort()}}),[z]);var B=L.id_user,V=L.rol_user,H=L.token_user,G=L.nombre_user,J=L.username_user,Y=L.permisos;return Object(w.jsx)(F.Provider,{value:{logueado:o,recordar:j,setRecordar:b,cargando:x,Loguearse:q,setMensajeAlerta:S,mensajeAlerta:C,nombre_user:G,id_user:B,rol_user:V,token_user:H,cargandoMensaje:A,DesLoguearse:U,username_user:J,permisos:Y,DescifrarTexto:function(e){return v.a.AES.decrypt(e,g).toString(v.a.enc.Utf8)}},children:t})},A=a(846),D=a(246),E=a(845),N=a(808),T=Object(c.createContext)(),R=function(){var e=Object(c.useContext)(T);return{themeMode:e.themeMode,setThemeMode:e.setThemeMode,changeTheme:e.changeTheme,drawerWidth:e.drawerWidth}},M=function(e){var t=e.children,a=Object(c.useState)("light"),n=Object(r.a)(a,2),o=n[0],i=n[1],s=Object(D.a)({palette:{mode:"light"===o?"light":"dark",background:{paper:"light"===o?"#fff":"#171721",default:"light"===o?"#f9f9f9":"#101013"},neutral:{main:"#64748B",contrastText:"#fff"}},typography:{fontSize:13,fontWeightMedium:"bold",fontWeightRegular:"500",fontFamily:"Montserrat",caption:{fontSize:11},body1:{fontSize:14}},components:{MuiTypography:{},MuiLink:{defaultProps:{}},MuiCard:{styleOverrides:{root:{borderRadius:"12px",boxShadow:"7px 6px 8px 1px rgb(0 0 0 / 10%), 0px 1px 1px 0px rgb(0 0 0 / 14%), 3px 3px 3px 0px rgb(0 0 0 / 12%)"}}},MuiPaper:{styleOverrides:{root:{transition:"all 0.01s linear"}}},MuiListItem:{styleOverrides:{root:{fontWeight:"bold",borderRadius:"9px",transition:"all 0.01s linear","&.Mui-selected":{backgroundColor:"light"===o?"#b9ddff":"#0066cc","& span":{fontWeight:"bold"}},"&:hover":{backgroundColor:"light"===o?"#b9ddff":"#0066cc",fontWeight:"bold"}}}},MuiCssBaseline:{styleOverrides:{body:{transition:"all 0.01s linear"}}}}});document.body.style.backgroundColor="dark"===o?"#171721":"#fff";return Object(c.useEffect)((function(){!function(){var e=localStorage.getItem("themeMode");e?i(e):localStorage.setItem("themeMode","light")}()}),[]),Object(w.jsx)(T.Provider,{value:{themeMode:o,setThemeMode:i,changeTheme:function(){"light"===o?(localStorage.setItem("themeMode","dark"),i("dark")):(localStorage.setItem("themeMode","light"),i("light"))},drawerWidth:275},children:Object(w.jsxs)(E.a,{theme:s,children:[Object(w.jsx)(N.a,{}),Object(w.jsx)(A.a,{elevation:0,children:t})]})})},L=Object(c.createContext)(),W=function(e){var t=e.children,a=Object(c.useState)(0),n=Object(r.a)(a,2),o=n[0],i=n[1],s=Object(c.useState)([]),u=Object(r.a)(s,2),j=u[0],b=u[1],p=I(),m=p.permisos,O=p.logueado,x=Object(c.useCallback)(Object(d.a)(l.a.mark((function e(){var t,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!O){e.next=7;break}if(!(m.findIndex((function(e){return"37"===e.id_permiso_permiso}))>-1)){e.next=7;break}return e.next=5,k.get({table:"productos",include:"productos_depositos",on:"id_producto,id_producto_deposito",where:"minimo_producto,>=,stock_producto_deposito,and,tipo_producto,=,1,and,notificar_producto,=,1",fields:"id_producto,nombre_producto,codigo_producto"});case 5:"ok"===(t=e.sent).response?(a=t.results.length,i(a),b(t.results)):console.log(t);case 7:case"end":return e.stop()}}),e)}))),[m,O]);return Object(c.useEffect)((function(){var e=new AbortController,t=!0;return t&&x(),function(){t=!1,e.abort()}}),[x]),Object(w.jsx)(L.Provider,{value:{cantidad:o,setCantidad:i,lista:j,setLista:b},children:t})},z=a(824),q=a(838),U=a(847),B=Object(z.a)((function(e){return{backdrop:{zIndex:e.zIndex.drawer+1,color:"#fff",backdropFilter:"blur(2px)"}}}));function V(){var e=B();return Object(w.jsx)(q.a,{className:e.backdrop,open:!0,children:Object(w.jsx)(U.a,{color:"inherit"})})}var H=a(23),G=a(6),J=a(49),Y=a.n(J),K=a(78),X=a.n(K),Q=a(174),Z=a(839),$=a(840),ee=a(848),te=a(187),ae=a(849),re=a(810),ne=a(850),oe=a(851),ce=a(852),ie=a(853),se=a(854),le=a(855),de=a(827),ue={goto:function(e){p.push("/"+e)},getDaysInMonth:function(e,t){return new Date(e,t,0).getDate()},getFechaHorarioString:function(){var e=new Date,t=e.getFullYear().toString()+"-"+(e.getMonth()+1).toString().padStart(2,0)+"-"+e.getDate().toString().padStart(2,0),a=e.getHours().toString().padStart(2,0)+":"+e.getMinutes().toString().padStart(2,0)+":"+e.getSeconds().toString().padStart(2,0);return"".concat(t," ").concat(a)},getHorarioActualString:function(){var e=new Date;return e.getHours().toString().padStart(2,0)+":"+e.getMinutes().toString().padStart(2,0)+":"+e.getSeconds().toString().padStart(2,0)},getFechaActualString:function(){var e=new Date;return e.getDate().toString().padStart(2,0)+"-"+(e.getMonth()+1).toString().padStart(2,0)+"-"+e.getFullYear().toString()},fechaActualDMY:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=new Date,a=(t=null===e?new Date:new Date(e)).getDate().toString().padStart(2,0)+"-"+(t.getMonth()+1).toString().padStart(2,0)+"-"+t.getFullYear().toString();return a},fechaActualYMD:function(){var e=new Date;return e.getFullYear().toString()+"-"+(e.getMonth()+1).toString().padStart(2,0)+"-"+e.getDate().toString().padStart(2,0)},HoraActualHMS:function(){var e=new Date;return"".concat(e.getHours(),":").concat(e.getMinutes(),":").concat(e.getSeconds())},fechaEs:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t={year:"numeric",month:"long",day:"numeric",weekday:"long"};return(null===e?new Date:new Date(e)).toLocaleDateString("es-ES",t)},fechaMesEs:function(e){var t=new Date(e).getMonth()+1;return new Date(2e3,t,1).toLocaleDateString("es-ES",{month:"long"})},getDiasDelMes:function(e){var t=e.substr(0,3),a=e.substr(-2,2);return new Date(t,a,0).getDate()},fechaEsDMY:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(null===t)e=new Date;else{var a=new Date(t),r=t.substr(0,4),n=t.substr(-2,2),o=a.getMonth()+1;e=new Date(r,o,n)}var c={year:"numeric",month:"long",day:"numeric"};return e.toLocaleDateString("es-ES",c)},redondeo2decimales:function(e){var t=parseFloat(e);return Math.round(100*t)/100},redondeo:function(e){var t=parseFloat(e);return Math.round(t)},numberFormat:function(e){return parseFloat(e).toLocaleString("de-DE")},SacarPunto:function(e){return e.replace(/[.\s]/g,"")},ComaPorPunto:function(e){return e.replace(/[,\s]/g,".")},numberSeparator:function(e){return parseFloat(e).toLocaleString("de-DE")},NumeroALetras:function(e,t){var a={numero:e,enteros:Math.floor(e),centavos:Math.round(100*e)-100*Math.floor(e),letrasCentavos:"",letrasMonedaPlural:t,letrasMonedaSingular:t,letrasMonedaCentavoPlural:"",letrasMonedaCentavoSingular:""};return a.centavos>0&&(a.letrasCentavos="CON "+(1===a.centavos?xe(a.centavos)+" "+a.letrasMonedaCentavoSingular:xe(a.centavos)+" "+a.letrasMonedaCentavoPlural)),0===a.enteros?"CERO "+a.letrasMonedaPlural+" "+a.letrasCentavos:1===a.enteros?xe(a.enteros)+" "+a.letrasMonedaSingular+" "+a.letrasCentavos:xe(a.enteros)+" "+a.letrasMonedaPlural+" "+a.letrasCentavos}};function je(e){switch(e){case 1:return"UN";case 2:return"DOS";case 3:return"TRES";case 4:return"CUATRO";case 5:return"CINCO";case 6:return"SEIS";case 7:return"SIETE";case 8:return"OCHO";case 9:return"NUEVE";default:return""}}function be(e){var t=Math.floor(e/10),a=e-10*t;switch(t){case 1:switch(a){case 0:return"DIEZ";case 1:return"ONCE";case 2:return"DOCE";case 3:return"TRECE";case 4:return"CATORCE";case 5:return"QUINCE";default:return"DIECI"+je(a)}case 2:switch(a){case 0:return"VEINTE";default:return"VEINTI"+je(a)}case 3:return pe("TREINTA",a);case 4:return pe("CUARENTA",a);case 5:return pe("CINCUENTA",a);case 6:return pe("SESENTA",a);case 7:return pe("SETENTA",a);case 8:return pe("OCHENTA",a);case 9:return pe("NOVENTA",a);case 0:default:return je(a)}}function pe(e,t){return t>0?e+" Y "+je(t):e}function me(e){var t=Math.floor(e/100),a=e-100*t;switch(t){case 1:return a>0?"CIENTO "+be(a):"CIEN";case 2:return"DOSCIENTOS "+be(a);case 3:return"TRESCIENTOS "+be(a);case 4:return"CUATROCIENTOS "+be(a);case 5:return"QUINIENTOS "+be(a);case 6:return"SEISCIENTOS "+be(a);case 7:return"SETECIENTOS "+be(a);case 8:return"OCHOCIENTOS "+be(a);case 9:return"NOVECIENTOS "+be(a);default:return""+be(a)}}function Oe(e,t,a,r){var n=Math.floor(e/t),o=e-n*t,c="";return n>0&&(c=n>1?me(n)+" "+r:a),o>0&&(c+=""),c}function xe(e){var t=1e6,a=e-Math.floor(e/t)*t,r=Oe(e,t,"UN MILLON DE","MILLONES DE"),n=function(e){var t=1e3,a=e-Math.floor(e/t)*t,r=Oe(e,t,"UN MIL","MIL"),n=me(a);return""===r?n:r+" "+n}(a);return""===r?n:r+" "+n}var he=function(e){e.columnas;return Object(w.jsx)(re.a,{sx:{display:"flex",width:"100%",alignItems:"center",justifyContent:"center"},children:Object(w.jsx)(U.a,{})})},fe=a(94),ge=a.n(fe),_e=ge.a.ExcelFile,ve=ge.a.ExcelFile.ExcelSheet,Ce=ge.a.ExcelFile.ExcelColumn,ke=function(e){var t=e.element,a=e.data,r=e.columns,n=e.sheetname,o=void 0===n?"Archivo":n,c=e.filename;e.obs;return Object(w.jsx)(_e,{filename:c,element:t||Object(w.jsx)("button",{children:"Download"}),children:Object(w.jsx)(ve,{data:a,name:o,children:r.map((function(e,t){return Object(w.jsx)(Ce,{label:e.title,value:e.field},t)}))})})},Se=Object(z.a)((function(e){var t,a;return{tableContainer:{position:"relative",overflowX:"unset",marginBottom:25,padding:5,backgroundColor:e.palette.background.paper,transition:"all 0.1s linear"},tableheader:(t={},Object(G.a)(t,e.breakpoints.down("md"),{display:"none"}),Object(G.a)(t,"position","sticky"),Object(G.a)(t,"top","63px"),Object(G.a)(t,"zIndex",10),Object(G.a)(t,"transition","all 0.2s linear"),Object(G.a)(t,"backgroundColor",e.palette.background.default),t),head:{marginBottom:"15px"},tablecell:{},tablelist:(a={},Object(G.a)(a,e.breakpoints.down("md"),{display:"flex",flexDirection:"column",margin:"0 0 10px 0",borderBottom:"1px solid silver"}),Object(G.a)(a,"borderRadius","8px"),a),tableitem:Object(G.a)({},e.breakpoints.down("md"),{display:"flex",justifyContent:"space-between"}),columname:Object(G.a)({display:"none",textTransform:"uppercase"},e.breakpoints.down("md"),{display:"block"}),bold:{fontWeight:"bold"},avatar:{backgroundColor:e.palette.primary.main,padding:25},ButtonAcciones:{margin:"0 5px"}}})),ye=function(e){var t=e.nombretabla,a=e.subtitle,r=e.columnas,n=e.filas,o=e.icono,i=e.Acciones,s=e.extraprops,l=e.namecolumnID,d=e.extra,u=e.search,j=e.cargando,b=e.showOptions,p=e.option,m=void 0===p?"opciones":p,O=e.print,x=e.exportCSV,h=e.exportPDF,f=e.exportExcel,g=e.caption,_=Se(),v=Object(c.useRef)(null);if(!r)return Object(w.jsx)("h1",{children:'Falta el props "columnas"'});if(!i)return Object(w.jsx)("h1",{children:'Falta el props "Acciones"'});if(!n)return Object(w.jsx)("h1",{children:'Falta el props "Filas"'});var C=[],k=[];return r.forEach((function(e){!0===e.NoPrint||(C.push({field:e.field,displayName:e.title}),k.push({label:e.title,key:e.field}))})),Object(w.jsxs)("div",{children:[Object(w.jsxs)(Z.a,{container:!0,spacing:1,justify:"space-evenly",className:_.head,children:[o&&Object(w.jsx)(Z.a,{item:!0,xs:12,md:1,zeroMinWidth:!0,children:Object(w.jsx)($.a,{variant:"rounded",className:_.avatar,children:Object(w.jsx)(ee.a,{fontSize:"large",children:o})})}),Object(w.jsxs)(Z.a,{item:!0,xs:12,sm:12,md:11,zeroMinWidth:!0,children:[Object(w.jsx)(te.a,{variant:"button",children:t}),Object(w.jsx)("br",{}),Object(w.jsx)(te.a,{variant:"caption",children:a})]}),Object(w.jsx)(Z.a,{xs:12,item:!0,sm:12,md:6,children:d&&d}),Object(w.jsx)(Z.a,{xs:12,item:!0,children:u&&u}),Object(w.jsxs)(Z.a,{xs:12,item:!0,children:[O&&Object(w.jsx)(ae.a,{className:_.ButtonAcciones,variant:"outlined",onClick:function(){Y()({printable:n,properties:C,type:"json",gridHeaderStyle:"color: red;  border: 2px solid #3971A5;",gridStyle:"border: 2px solid #3971A5;",header:'<h3 class="custom-h3">'.concat(t,"</h3>"),style:".custom-h3 { color: red; }"})},startIcon:Object(w.jsx)(ee.a,{children:"print"}),children:"Imprimir"}),x&&Object(w.jsx)(Q.CSVLink,{data:n,style:{textDecoration:"none"},headers:k,filename:ue.fechaActualDMY(),children:Object(w.jsx)(ae.a,{className:_.ButtonAcciones,startIcon:Object(w.jsx)(ee.a,{children:"text_snippet"}),variant:"outlined",children:"csv"})}),h&&Object(w.jsx)(X.a,{targetRef:v,filename:ue.fechaActualDMY(),children:function(e){var t=e.toPdf;return Object(w.jsx)(ae.a,{className:_.ButtonAcciones,variant:"outlined",startIcon:Object(w.jsx)(ee.a,{children:"picture_as_pdf"}),onClick:t,children:"PDF"})}}),f&&Object(w.jsx)(ke,{columns:r,data:n,sheetname:t,filename:t+ue.fechaActualDMY(),element:Object(w.jsx)(ae.a,{variant:"outlined",startIcon:Object(w.jsx)(ee.a,{children:"file_download"}),children:"Excel"})})]})]}),j?Object(w.jsx)(he,{columnas:r}):n.length>0?Object(w.jsx)(re.a,{boxShadow:2,borderRadius:3,children:Object(w.jsx)(ne.a,{id:"table_print",ref:v,className:_.tableContainer,children:Object(w.jsxs)(oe.a,{children:[Object(w.jsx)("caption",{children:Object(w.jsxs)("b",{children:[" ",g||t," "]})}),Object(w.jsx)(ce.a,{className:_.tableheader,children:Object(w.jsxs)(ie.a,{children:[r.map((function(e,t){return Object(w.jsx)(se.a,{className:_.tablecell,align:"center",children:Object(w.jsx)(te.a,{variant:"overline",className:_.bold,children:e.title})},t)})),Object(w.jsx)(se.a,{align:"center",className:_.tablecell,children:Object(w.jsx)(te.a,{variant:"overline",className:_.bold,children:m})})]})}),Object(w.jsx)(le.a,{children:n.map((function(e,t){return Object(w.jsxs)(ie.a,{role:"checkbox",hover:!0,className:_.tablelist,children:[r.map((function(t,a){return Object(w.jsxs)(se.a,{className:_.tableitem,align:t.align?t.align:"center",children:[Object(w.jsxs)("span",{className:_.columname,children:[t.title,":"," "]}),Object(w.jsxs)("span",{style:t.style?t.style:t.styleCondicion?t.styleCondicion[e[t.comparaItem]]:null,children:[t.isNumber?ue.numberSeparator(e[t.field]):t.extra?t.extra:t.items?t.items[e[t.comparaItem]]:t.isDate?ue.fechaActualDMY(e[t.field]):t.img?Object(w.jsx)("img",{width:"50",src:e[t.field],alt:"img"}):e[t.field],t.extraitem&&t.extraitem]})]},a)})),Object(w.jsx)(se.a,{align:"center",children:b&&Object(w.jsx)(i,{filaProps:e,id:e[l],extraprops:e[s]})})]},e[l]?e[l]:t)}))})]})})}):Object(w.jsx)(de.a,{icon:Object(w.jsx)(ee.a,{children:"block"}),severity:"warning",children:Object(w.jsx)(te.a,{variant:"body1",children:"No hay registros"})})]})},we=a(811),Fe=a(857),Ie=a(864),Pe=a(856),Ae=a(865),De=a(866),Ee=a(822),Ne=function(e){var t=e.children;return Object(w.jsx)(Ee.a.div,{initial:{opacity:0,y:"-50px"},animate:{opacity:1,y:0},transition:{duration:.4},children:t})},Te=a(2),Re=Object(c.createContext)(),Me=function(e){var t=e.children,a=JSON.parse(localStorage.getItem("dataProductos")),n=Object(c.useState)({padres:[],categorias:[]}),o=Object(r.a)(n,2),i=o[0],s=o[1],u=Object(c.useState)(30),j=Object(r.a)(u,2),b=j[0],p=j[1],m=Object(c.useState)(0),O=Object(r.a)(m,2),x=O[0],h=O[1],f=Object(c.useState)(0),g=Object(r.a)(f,2),_=g[0],v=g[1],C=I().token_user,S=Object(c.useState)(!0),F=Object(r.a)(S,2),P=F[0],A=F[1],D=Object(c.useState)(!1),E=Object(r.a)(D,2),N=E[0],T=E[1],R=Object(c.useState)(!1),M=Object(r.a)(R,2),L=M[0],W=M[1],z=function(){var e=Object(d.a)(l.a.mark((function e(t,r){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:y()({title:"Borrar?",text:r,icon:"warning",buttons:["Cancelar","OK"]}).then(function(){var e=Object(d.a)(l.a.mark((function e(r){var n,o,c,i,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r){e.next=18;break}return A(!0),e.next=4,k.get({table:"productos",fields:"id_producto",where:"id_categoria_producto,=,".concat(t)});case 4:return n=e.sent,e.next=7,k.get({table:"categorias",field:"id_categoria",where:"id_padre_categoria,=,".concat(t)});case 7:if(o=e.sent,!(n.found>0||o.found>0)){e.next=12;break}"ok"===n.response?y()({icon:"error",title:"Error",text:"No se puede borrar porque tiene productos/categorias en ella"}):console.log(n),e.next=17;break;case 12:return e.next=14,k.delete({table:"categorias",id:t,token:C});case 14:c=e.sent,y()({icon:"success",text:"Borrado correctamente"}),"ok"===c.response&&(a&&(i=Object(Te.a)({},a),s=i.categorias.findIndex((function(e){return e.id_categoria===t})),i.categorias.splice(s,1),localStorage.setItem("dataProductos",JSON.stringify(i))),U());case 17:A(!1);case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),q=function(){var e=Object(d.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log(t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),U=Object(c.useCallback)(Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return A(!0),e.t0=Promise,e.t1=k.get({table:"categorias",fields:"id_categoria,nombre_categoria,id_padre_categoria",pagenumber:_,pagesize:b,sort:"-nombre_categoria"}),e.next=5,k.get({table:"categorias",fields:"id_categoria,nombre_categoria,id_padre_categoria"});case 5:e.t2=e.sent,e.t3=[e.t1,e.t2],e.t0.all.call(e.t0,e.t3).then((function(e){s({padres:e[1].results,categorias:e[0].results}),h(e[0].total),A(!1)}));case 8:case"end":return e.stop()}}),e)}))),[b,_]);return Object(c.useEffect)((function(){var e=!0,t=new AbortController;return e&&U(),function(){e=!1,t.abort()}}),[U]),Object(w.jsx)(Re.Provider,{value:{listas:i,cargando:P,setCargando:A,buscarRegistro:q,openDialog:N,setOpenDialog:T,openDialogEdit:L,setOpenDialogEdit:W,borrarRegistro:z,limite:b,setLimite:p,page:_,setPage:v,countTotal:x,getLista:U},children:t})},Le=function(){var e=function(){var e=Object(c.useContext)(Re);return{listas:e.listas,cargando:e.cargando,setCargando:e.setCargando,buscarRegistro:e.buscarRegistro,openDialog:e.openDialog,setOpenDialog:e.setOpenDialog,openDialogEdit:e.openDialogEdit,setOpenDialogEdit:e.setOpenDialogEdit,borrarRegistro:e.borrarRegistro,limite:e.limite,setLimite:e.setLimite,page:e.page,setPage:e.setPage,countTotal:e.countTotal,getLista:e.getLista}}(),t=e.listas,a=e.cargando,n=e.buscarRegistro,o=e.borrarRegistro,i=e.page,s=e.limite,l=e.setPage,d=e.countTotal,u=Object(c.useState)(""),j=Object(r.a)(u,2),b=j[0],p=j[1],m=t.categorias.filter((function(e){return e.nombre_categoria.toLowerCase().includes(b.toLowerCase())})),O={0:"Padre"};t.padres.forEach((function(e){O[e.id_categoria]=e.nombre_categoria}));var x=[{field:"id_categoria",title:"ID"},{field:"nombre_categoria",title:"Nombre"},{field:"id_padre_categoria",title:"Padre",items:O,comparaItem:"id_padre_categoria"}],h=Object(w.jsxs)(we.a,{direction:"row",spacing:2,children:[Object(w.jsx)(Fe.a,{InputProps:{endAdornment:Object(w.jsx)(Ie.a,{position:"end",children:Object(w.jsx)(Pe.a,{onClick:function(){n(b)},children:Object(w.jsx)(ee.a,{children:"search"})})})},onKeyPress:function(e){"Enter"===e.key&&n(b)},onChange:function(e){return p(e.target.value)},variant:"outlined",label:"Buscar"}),Object(w.jsx)(Ae.a,{title:"AGREGAR NUEVO",arrow:!0,children:Object(w.jsx)(ae.a,{color:"primary",variant:"outlined",size:"large",onClick:function(){ue.goto("categorias/new")},children:"AGREGAR"})})]});return Object(w.jsxs)(Ne,{children:[Object(w.jsx)(ye,{nombretabla:"Categorias",icono:"category",bgicono:"#3f51b5",namecolumnID:"id_categoria",columnas:x,filas:m,Acciones:function(e){var t=e.id,a=e.extraprops;return Object(w.jsxs)(we.a,{direction:"row",spacing:1,justifyContent:"center",children:[Object(w.jsx)(De.a,{variant:"round",color:"primary",size:"small",onClick:function(){ue.goto("categorias/new/".concat(t))},children:Object(w.jsx)(ee.a,{children:"edit"})}),Object(w.jsx)(De.a,{variant:"round",color:"secondary",size:"small",onClick:function(){o(t,a)},children:Object(w.jsx)(ee.a,{children:"delete"})})]})},extraprops:"nombre_categoria",cargando:a,search:h,showOptions:!0}),Object(w.jsxs)(we.a,{spacing:2,justifyContent:"center",direction:"row",children:[i>0&&Object(w.jsx)(ae.a,{onClick:function(){if(i>0){var e=parseInt(i)-parseInt(s);l(e)}},variant:"outlined",children:"Atr\xe1s"}),d>i&&i+s<d&&Object(w.jsx)(ae.a,{variant:"outlined",onClick:function(){var e=parseInt(i)+parseInt(s);l(e)},children:"Siguiente"})]})]})},We=function(){return Object(w.jsx)(Me,{children:Object(w.jsx)(Le,{})})},ze=a(867),qe=a(868),Ue=a(869),Be=a(870),Ve=a(860),He=a(861),Ge=a(830),Je=a(842),Ye=a(871),Ke=a(885),Xe=function(){var e=Object(H.h)().id,t=JSON.parse(localStorage.getItem("dataProductos")),a=Object(c.useRef)(null),n=I().token_user,o=Object(c.useState)([]),i=Object(r.a)(o,2),s=i[0],u=i[1],j=Object(c.useState)(!0),b=Object(r.a)(j,2),p=b[0],m=b[1],O={id_categoria:"",nombre_categoria:"",id_padre_categoria:"0"},x=Object(c.useState)(O),h=Object(r.a)(x,2),f=h[0],g=h[1],_=Object(c.useState)({nombre_categoria:!1,error:!1,errorMsj:"Complete el campo correctamente"}),v=Object(r.a)(_,2),C=v[0],S=v[1],F=function(){return ue.goto("categorias")},P=function(e){var t=e.target,a=t.name,r=t.value;g(Object(Te.a)(Object(Te.a)({},f),{},Object(G.a)({},a,r)))},A=function(){var a=Object(d.a)(l.a.mark((function a(r){var o,c,i;return l.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(r.preventDefault(),!(f.nombre_categoria.length<2)){a.next=4;break}return S(Object(Te.a)(Object(Te.a)({},C),{},{nombre_categoria:!0,error:!0})),a.abrupt("return",!1);case 4:if(m(!0),S(Object(Te.a)(Object(Te.a)({},C),{},{nombre_categoria:!1,error:!1})),!e){a.next=13;break}return a.next=9,k.update({table:"categorias",data:f,token:n,id:e});case 9:"ok"===a.sent.response&&y()({icon:"success",text:"Actualizado",timer:1300}).then((function(){if(t){var a=Object(Te.a)({},t),r=a.categorias.findIndex((function(t){return t.id_categoria===e}));a.categorias[r].nombre_categoria=f.nombre_categoria,localStorage.setItem("dataProductos",JSON.stringify(a))}g(O),F()})),a.next=18;break;case 13:return delete f.id_categoria,a.next=16,k.insert({table:"categorias",data:f,token:n});case 16:"ok"===(o=a.sent).response&&(y()({icon:"success",text:"Agregado",timer:1300}),t&&(c=Object(Te.a)({},t),i={nombre_categoria:f.nombre_categoria,id_categoria:o.last_id},c.categorias.push(i),localStorage.setItem("dataProductos",JSON.stringify(c))),g(O));case 18:m(!1);case 19:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),D=Object(c.useCallback)(Object(d.a)(l.a.mark((function t(){var a,r,n,o,c,i;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(m(!0),a=JSON.parse(localStorage.getItem("dataProductos")),!e){t.next=20;break}if(null!==a){t.next=14;break}return t.next=6,k.get({table:"categorias",fields:"id_categoria,nombre_categoria,id_padre_categoria",where:"id_categoria,!=,".concat(e),sort:"-nombre_categoria"});case 6:return r=t.sent,u(r.results),t.next=10,k.get({table:"categorias",where:"id_categoria,=,".concat(e),sort:"-nombre_categoria"});case 10:n=t.sent,g({id_categoria:e,id_padre_categoria:n.results[0].id_padre_categoria,nombre_categoria:n.results[0].nombre_categoria}),t.next=18;break;case 14:o=a.categorias.filter((function(t){return t.id_categoria!==e})),u(o),c=a.categorias.findIndex((function(t){return t.id_categoria===e})),g({id_categoria:e,nombre_categoria:a.categorias[c].nombre_categoria,id_padre_categoria:a.categorias[c].id_padre_categoria});case 18:t.next=28;break;case 20:if(!a){t.next=24;break}u(a.categorias),t.next=28;break;case 24:return t.next=26,k.get({table:"categorias",fields:"id_categoria,nombre_categoria,id_padre_categoria"});case 26:i=t.sent,u(i.results);case 28:m(!1);case 29:case"end":return t.stop()}}),t)}))),[e]);return Object(c.useEffect)((function(){var e=!0,t=new AbortController;return e&&D(),function(){e=!1,t.abort()}}),[D]),Object(w.jsx)(ze.a,{fullWidth:!0,open:!0,onClose:F,children:Object(w.jsxs)("form",{onSubmit:A,children:[Object(w.jsx)(qe.a,{children:"Agregar Categor\xeda"}),Object(w.jsxs)(Ue.a,{dividers:!0,children:[C.error&&Object(w.jsx)(Ke.a,{severity:"error",children:C.errorMsj}),Object(w.jsxs)(Z.a,{container:!0,spacing:2,children:[Object(w.jsx)(Z.a,{item:!0,xs:12,children:p&&Object(w.jsx)(Be.a,{})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(Fe.a,{autoFocus:!0,inputRef:a,onChange:P,label:"Nombre",autoComplete:"off",name:"nombre_categoria",value:f.nombre_categoria,InputProps:{startAdornment:Object(w.jsx)(Ie.a,{position:"start",children:Object(w.jsx)(ee.a,{color:"action",children:"inventory_2"})})},fullWidth:!0,required:!0,variant:"outlined",error:C.nombre_categoria,helperText:"Nombre de categor\xeda",disabled:p})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsxs)(Ve.a,{fullWidth:!0,children:[Object(w.jsx)(He.a,{variant:"outlined",children:"Categor\xeda padre"}),Object(w.jsxs)(Ge.a,{name:"id_padre_categoria",value:f.id_padre_categoria,onChange:P,variant:"outlined",disabled:p,children:[Object(w.jsx)(Je.a,{value:"0",children:"Ninguno"}),s.map((function(e){return Object(w.jsx)(Je.a,{value:e.id_categoria,children:e.nombre_categoria},e.id_categoria)}))]})]})})]})]}),Object(w.jsxs)(Ye.a,{children:[Object(w.jsx)(ae.a,{type:"submit",color:"primary",variant:"outlined",disabled:p,children:"GUARDAR"}),Object(w.jsx)(ae.a,{onClick:F,variant:"outlined",disabled:p,children:"CERRAR"})]})]})})},Qe=a(18),Ze=Object(c.createContext)(),$e=function(e){var t=e.children,a=I().token_user,n=Object(H.f)(),o=n.search?new URLSearchParams(n.search):0,i=Object(c.useState)(o&&o.get("p")&&!isNaN(o.get("p"))?parseInt(o.get("p")):0),s=Object(r.a)(i,2),u=s[0],j=s[1],b=Object(c.useState)(30),p=Object(r.a)(b,2),m=p[0],O=p[1],x=Object(c.useState)("0"),h=Object(r.a)(x,2),f=h[0],g=h[1],_=Object(c.useState)([]),v=Object(r.a)(_,2),C=v[0],S=v[1],F=Object(c.useState)(!0),P=Object(r.a)(F,2),A=P[0],D=P[1],E=Object(c.useState)({nombre_cliente:"",nro_cliente:"",ruc_cliente:"",email_cliente:"",direccion_cliente:"",tipo_cliente:3}),N=Object(r.a)(E,2),T=N[0],R=N[1],M=function(){var e=Object(d.a)(l.a.mark((function e(t){var a,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return D(!0),a={tables:"clientes",where:"nombre_cliente,like,'%".concat(t,"%'"),fields:"id_cliente,nombre_cliente,ruc_cliente,telefono_cliente"},e.next=4,k.get(a);case 4:r=e.sent,j(0),r.results.length>0&&"ok"===r.response&&(S(r.results),ue.goto("/clientes")),D(!1);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),L=function(){var e=Object(d.a)(l.a.mark((function e(t,r){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:y()({buttons:{cancel:"Cancelar",confirm:"Confirmar"},icon:"warning",text:"Cliente: ".concat(r),title:"Eliminar este registro?"}).then(function(){var e=Object(d.a)(l.a.mark((function e(r){var n,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r){e.next=5;break}return e.next=3,k.delete({table:"clientes",id:t,token:a});case 3:"ok"===e.sent.response&&(n=Object(Qe.a)(C),o=C.findIndex((function(e){return e.id_cliente===t})),n.splice(o,1),S(n),y()({icon:"success",text:"Eliminado correctamente"}));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),W=Object(c.useCallback)(Object(d.a)(l.a.mark((function e(){var t,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return D(!0),t={table:"clientes",fields:"id_cliente,nombre_cliente,ruc_cliente,telefono_cliente",orderBy:"-id_cliente"},e.next=4,k.get(t);case 4:"ok"===(a=e.sent).response?(S(a.results),g(a.total)):console.log(a),D(!1);case 7:case"end":return e.stop()}}),e)}))),[]);return Object(c.useEffect)((function(){var e=new AbortController,t=!0;return t&&W(),function(){t=!1,e.abort()}}),[W]),Object(w.jsx)(Ze.Provider,{value:{lista:C,setLista:S,cargando:A,setCargando:D,formulario:T,setFormulario:R,page:u,setPage:j,limite:m,setLimite:O,buscarRegistro:M,BorrarCliente:L,countTotal:f},children:t})},et=function(){var e=function(){var e=Object(c.useContext)(Ze);return{lista:e.lista,setLista:e.setLista,cargando:e.cargando,setCargando:e.setCargando,formulario:e.formulario,setFormulario:e.setFormulario,page:e.page,setPage:e.setPage,limite:e.limite,setLimite:e.setLimite,buscarRegistro:e.buscarRegistro,BorrarCliente:e.BorrarCliente,countTotal:e.countTotal}}(),t=e.lista,a=e.cargando,n=e.page,o=e.setPage,i=e.limite,s=e.buscarRegistro,l=e.countTotal,d=e.BorrarCliente,u=Object(c.useState)(""),j=Object(r.a)(u,2),b=j[0],p=j[1],m=t.filter((function(e){return e.nombre_cliente.toLowerCase().includes(b.toLowerCase())||e.ruc_cliente.toLowerCase().includes(b.toLowerCase())})),O=Object(w.jsxs)(we.a,{direction:"row",spacing:2,children:[Object(w.jsx)(Fe.a,{InputProps:{endAdornment:Object(w.jsx)(Ie.a,{position:"end",children:Object(w.jsx)(Pe.a,{onClick:function(){s(b)},children:Object(w.jsx)(ee.a,{children:"search"})})})},onKeyPress:function(e){"Enter"===e.key&&s(b)},onChange:function(e){return p(e.target.value)},variant:"outlined",label:"Buscar"}),Object(w.jsx)(ae.a,{color:"primary",variant:"outlined",size:"large",onClick:function(){return ue.goto("clientes/new/")},children:"AGREGAR"})]});return Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(ye,{nombretabla:"Clientes",icono:"people",bgicono:"#3f51b5",namecolumnID:"id_cliente",columnas:[{field:"id_cliente",title:"ID"},{field:"ruc_cliente",title:"Documento"},{field:"nombre_cliente",title:"Nombre"},{field:"telefono_cliente",title:"Contacto"}],filas:m,Acciones:function(e){var t=e.id,a=e.extraprops;return Object(w.jsxs)(we.a,{direction:"row",spacing:1,justifyContent:"center",children:[Object(w.jsx)(De.a,{variant:"round",color:"primary",size:"small",onClick:function(){return ue.goto("clientes/new/".concat(t))},children:Object(w.jsx)(ee.a,{children:"edit"})}),Object(w.jsx)(De.a,{variant:"round",color:"secondary",size:"small",onClick:function(){return d(t,a)},children:Object(w.jsx)(ee.a,{children:"delete"})})]})},extraprops:"nombre_cliente",search:O,cargando:a,showOptions:!0}),Object(w.jsxs)(we.a,{direction:"row",spacing:2,justifyContent:"center",children:[n>0&&Object(w.jsx)(ae.a,{onClick:function(){if(n>0){var e=parseInt(n)-parseInt(i);o(e)}},variant:"outlined",children:"Atr\xe1s"}),l>n&&n+i<l&&Object(w.jsx)(ae.a,{variant:"outlined",onClick:function(){var e=parseInt(n)+parseInt(i);o(e)},children:"Siguiente"})]})]})},tt=function(){return Object(w.jsx)($e,{children:Object(w.jsx)(et,{})})},at=a(835),rt=a(812),nt=a(843),ot=a(872),ct=a(826),it=function(){var e=Object(H.h)().id,t=I().token_user,a=Object(c.useState)({nombre_cliente:"",telefono_cliente:"",ruc_cliente:"",email_cliente:"",direccion_cliente:"",tipo_cliente:"3"}),n=Object(r.a)(a,2),o=n[0],i=n[1],s=Object(c.useState)(!0),u=Object(r.a)(s,2),j=u[0],b=u[1],p=function(e){var t=e.target,a=t.name,r=t.value;i(Object(Te.a)(Object(Te.a)({},o),{},Object(G.a)({},a,r)))},m=function(){var a=Object(d.a)(l.a.mark((function a(r){var n,c;return l.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(r.preventDefault(),n=null,c="",!e){a.next=10;break}return a.next=6,k.update({table:"clientes",data:o,token:t,id:e});case 6:n=a.sent,c="Actualizado",a.next=14;break;case 10:return a.next=12,k.insert({table:"clientes",data:o,token:t});case 12:n=a.sent,c="Agregado";case 14:"ok"===n.response&&(y()({icon:"success",title:c,timer:1300}),ue.goto("clientes"));case 15:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),O=Object(c.useCallback)(Object(d.a)(l.a.mark((function t(){var a;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e){t.next=5;break}return t.next=3,k.get({table:"clientes",where:"id_cliente,=,".concat(e)});case 3:a=t.sent,i(Object(Te.a)({},a.results[0]));case 5:b(!1);case 6:case"end":return t.stop()}}),t)}))),[e]);Object(c.useEffect)((function(){var e=new AbortController,t=!0;return t&&O(),function(){t=!1,e.abort()}}),[O]);var x=function(){ue.goto("clientes")};return Object(w.jsx)(ze.a,{fullWidth:!0,open:!0,maxWidth:"md",onClose:x,children:Object(w.jsxs)("form",{onSubmit:m,children:[Object(w.jsxs)(qe.a,{children:[e?"Editar":"Nuevo"," cliente"]}),Object(w.jsx)(Ue.a,{dividers:!0,children:Object(w.jsxs)(Z.a,{container:!0,spacing:2,children:[Object(w.jsx)(Z.a,{item:!0,xs:12,children:j&&Object(w.jsx)(Be.a,{})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsxs)(at.a,{separator:"\u203a",children:[Object(w.jsx)(te.a,{variant:"overline",children:"Clientes"}),Object(w.jsx)(te.a,{variant:"overline",children:"Nuevo"})]})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:6,children:Object(w.jsx)(Fe.a,{autoFocus:!0,onChange:p,name:"nombre_cliente",required:!0,value:o.nombre_cliente&&o.nombre_cliente,fullWidth:!0,label:"Nombre",variant:"outlined"})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:6,children:Object(w.jsx)(Fe.a,{fullWidth:!0,required:!0,onChange:p,name:"ruc_cliente",value:o.ruc_cliente,label:"Ruc o CI",variant:"outlined"})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:6,children:Object(w.jsx)(Fe.a,{name:"telefono_cliente",label:"N\xfamero de tel\xe9fono",onChange:p,value:null!==o.telefono_cliente?o.telefono_cliente:"",fullWidth:!0,variant:"outlined"})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:6,children:Object(w.jsx)(Fe.a,{fullWidth:!0,label:"Direcci\xf3n",onChange:p,name:"direccion_cliente",value:null!==o.direccion_cliente?o.direccion_cliente:""})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:6,children:Object(w.jsx)(Fe.a,{fullWidth:!0,onChange:p,name:"email_cliente",value:null!==o.email_cliente?o.email_cliente:"",label:"Correo Electr\xf3nico",variant:"outlined"})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:6,children:Object(w.jsxs)(Ve.a,{component:"fieldset",children:[Object(w.jsx)(rt.a,{component:"legend",children:"Tipo:"}),Object(w.jsxs)(nt.a,{name:"tipo_cliente",value:o.tipo_cliente,onChange:p,children:[Object(w.jsx)(ot.a,{value:3,control:Object(w.jsx)(ct.a,{checked:"3"===o.tipo_cliente}),label:"Casual"}),Object(w.jsx)(ot.a,{value:2,control:Object(w.jsx)(ct.a,{checked:"2"===o.tipo_cliente}),label:"Minorista"}),Object(w.jsx)(ot.a,{value:1,control:Object(w.jsx)(ct.a,{checked:"1"===o.tipo_cliente}),label:"Mayorista"})]})]})})]})}),Object(w.jsxs)(Ye.a,{children:[Object(w.jsx)(ae.a,{size:"large",startIcon:Object(w.jsx)(ee.a,{children:"save"}),variant:"outlined",color:"primary",type:"submit",children:"GUARDAR"}),Object(w.jsx)(ae.a,{onClick:x,size:"large",variant:"outlined",children:"CANCELAR"})]})]})})},st=a(873),lt=a(47),dt=[{id_permiso:1,text:"Realizar venta",icon:"sell",bgcolor:"success.main",color:"#FFF",url:"".concat(m,"/ventas")},{id_permiso:30,text:"Cotizaci\xf3n",icon:"monetization_on",bgcolor:"#45007d",color:"#FFF",url:"".concat(m,"/monedas")},{id_permiso:44,text:"Informes",icon:"trending_up",bgcolor:"#3f51b5",color:"#FFF",url:"".concat(m,"/informes")},{id_permiso:8,text:"Productos",icon:"inventory_2",bgcolor:"error.main",color:"error.contrastText",url:"".concat(m,"/productos")},{id_permiso:4,text:"Lista facturas",icon:"assignment",bgcolor:"#7db346",color:"#FFF",url:"".concat(m,"/facturas")},{id_permiso:16,text:"Entregas",icon:"delivery_dining",bgcolor:"#f27474",color:"primary.contrastText",url:"".concat(m,"/entregas")},{id_permiso:24,text:"Mov. de cajas",icon:"leaderboard",bgcolor:"#4caf50",color:"#FFF",url:"".concat(m,"/movimientos")},{id_permiso:22,text:"Cajas",icon:"savings",bgcolor:"#ffa500",color:"#FFF",url:"".concat(m,"/cajas")},{id_permiso:28,text:"Clientes",icon:"people",bgcolor:"secondary.main",color:"secondary.contrastText",url:"".concat(m,"/clientes")},{id_permiso:43,text:"Inventario",icon:"handyman",bgcolor:"info.main",color:"info.contrastText",url:"".concat(m,"/clientes")},{id_permiso:34,text:"Usuarios",icon:"manage_accounts",bgcolor:"#009688",color:"#FFF",url:"".concat(m,"/usuarios")}],ut={en:{Inicio:"Home",Ventas:"Sales","Realizar Ventas":"Make sales",Informes:"Reports",Ajustes:"Settings",Productos:"Products",Compras:"Purchase",Cuentas:"Collection","Nueva venta":"New sale","Lista Facturas":"Sale list","Lista facturas":"Sale list","Arqueo de Cajas":"Cash registers","Categor\xedas":"Categories","Categor\xeda":"Category","Art\xedculos":"Articles",Opciones:"Options","C\xf3digo":"Code",Bienvenido:"Welcome",Mantenimiento:"Maintenance",Entregas:"Deliveries",Nombre:"Name","Datos de Empresa":"Enterprise data","Registro de facturas":"Bills register",Clientes:"Customers",Monedas:"Coins",Impuestos:"Taxes",Usuarios:"Users","Unidad de medida":"Unit of measuremen",Empleados:"Employees","Mov. de cajas":"Movements","Apertura/Cierre":"Open/Close",Cajas:"Registers",Proveedores:"Providers",Marcas:"Brands",Apartados:"Transfers",Inventario:"Inventory",Depositos:"Deposits","Lista de productos":"Products list",Presupuestos:"Budget","Realizar venta":"New sale","Cotizaci\xf3n":"Quotation",SubModDashboard:"Welcome! This is the main panel of the system, here you can find shortcuts to access the different lists of each module of the system.","Nuevo producto":"New product"},es:{Inicio:"Inicio",Ventas:"Ventas","Realizar Ventas":"Realizar ventas",Informes:"Informes",Ajustes:"Ajustes",Productos:"Productos",Compras:"Compras",Cuentas:"Cuentas","Nueva venta":"Nueva venta","Lista Facturas":"Lista Facturas","Arqueo de Cajas":"Arqueo de Cajas","Categor\xedas":"Categor\xedas","Categor\xeda":"Categor\xeda","Art\xedculos":"Art\xedculos",Opciones:"Opciones","C\xf3digo":"C\xf3digo",Bienvenido:"Bienvenido",Mantenimiento:"Mantenimiento",Entregas:"Entregas",Nombre:"Nombre","Datos de Empresa":"Datos de Empresa","Registro de facturas":"Registro de facturas",Clientes:"Clientes",Monedas:"Monedas",Impuestos:"Impuestos",Usuarios:"Usuarios",SubModDashboard:"\xa1Bienvenido! Este es el panel principal del sistema ac\xe1 podr\xe1 encontrar atajos para acceder a los distintos listados de cada m\xf3dulo del sistema.","Nuevo producto":"Nuevo producto / servicio"},pt:{Inicio:"Inicio",Ventas:"Vendas","Realizar Ventas":"Realizar ventas",Informes:"Informes",Ajustes:"Ajustes",Productos:"Productos",Compras:"Compras",Cuentas:"Cuentas","Nuevo producto":"Novo produto"}},jt=Object(c.createContext)(),bt=function(){var e=Object(c.useContext)(jt);return{lang:e.lang,setLang:e.setLang,lenguaje:e.lenguaje,setLenguaje:e.setLenguaje,changeLang:e.changeLang}},pt=function(e){var t=e.children,a=Object(c.useState)("es"),n=Object(r.a)(a,2),o=n[0],i=n[1],s=Object(c.useState)(null===ut||void 0===ut?void 0:ut[o]),l=Object(r.a)(s,2),d=l[0],u=l[1];return Object(c.useEffect)((function(){}),[]),Object(w.jsx)(jt.Provider,{value:{lang:d,setLang:u,lenguaje:o,setLenguaje:i,changeLang:function(e){u(null===ut||void 0===ut?void 0:ut[e])}},children:t})},mt=Object(z.a)((function(e){return{icono:{fontSize:100},grid:{display:"grid",gap:"10px",gridTemplateColumns:"repeat(auto-fill,minmax(175px,1fr))"},mb20:{marginBottom:"20px"},box:{display:"flex",justifyContent:"center",flexDirection:"column",alignItems:"center",border:"1px solid whitesmoke",borderRadius:"6px"},titulo:{marginBottom:e.spacing(4)},link:{textDecoration:"none"}}})),Ot=function(){var e=mt(),t=I(),a=t.permisos,r=t.nombre_user,n=bt().lang,o=[];return dt.forEach((function(e){a.some((function(t){return parseInt(t.id_permiso_permiso)===parseInt(e.id_permiso)}))&&o.push(e)})),Object(w.jsxs)(st.a,{children:[Object(w.jsxs)("div",{className:e.titulo,children:[Object(w.jsxs)(te.a,{variant:"h5",children:["Hola: ",r]}),Object(w.jsx)(te.a,{variant:"caption",children:null===n||void 0===n?void 0:n.SubModDashboard})]}),Object(w.jsx)("div",{className:e.grid,children:o.map((function(t,a){return Object(w.jsx)("div",{children:Object(w.jsx)(lt.a,{to:t.url,className:e.link,children:Object(w.jsxs)(re.a,{bgcolor:t.bgcolor,className:e.box,color:t.color,p:2,children:[Object(w.jsx)(ee.a,{className:e.icono,children:t.icon}),Object(w.jsx)(te.a,{variant:"button",children:(null===n||void 0===n?void 0:n[t.text])?null===n||void 0===n?void 0:n[t.text]:t.text})]})})},a)}))})]})},xt=Object(c.createContext)(),ht=function(){var e=Object(c.useContext)(xt);return{lista:e.lista,setLista:e.setLista,desdeFecha:e.desdeFecha,setDesdeFecha:e.setDesdeFecha,hastaFecha:e.hastaFecha,setHastaFecha:e.setHastaFecha,cargando:e.cargando,setCargando:e.setCargando,cargandoFactura:e.cargandoFactura,total:e.total,setTotal:e.setTotal,dialogs:e.dialogs,setDialogs:e.setDialogs,formulario:e.formulario,setFormulario:e.setFormulario,fecha:e.fecha,filtro:e.filtro,setFiltro:e.setFiltro,inputSearch:e.inputSearch,setInputSearch:e.setInputSearch,getBuscarFactura:e.getBuscarFactura,consultarParaImprimir:e.consultarParaImprimir,itemsFactura:e.itemsFactura,setItemsFactura:e.setItemsFactura}},ft=function(e){var t=e.children,a=Object(c.useState)([]),n=Object(r.a)(a,2),o=n[0],i=n[1],s=Object(c.useState)(0),u=Object(r.a)(s,2),j=u[0],b=u[1],p=Object(c.useState)({estado:!1,imprimir:!1,imprimirFactura:!1,imprimirRecibo:!1}),m=Object(r.a)(p,2),O=m[0],x=m[1],h=ue.fechaActualYMD(),f=Object(c.useState)(!0),g=Object(r.a)(f,2),_=g[0],v=g[1],C=Object(c.useState)(!0),S=Object(r.a)(C,2),y=S[0],F=S[1],I=Object(c.useState)(h),P=Object(r.a)(I,2),A=P[0],D=P[1],E=Object(c.useState)(h),N=Object(r.a)(E,2),T=N[0],R=N[1],M=Object(c.useState)(""),L=Object(r.a)(M,2),W=L[0],z=L[1],q=Object(c.useState)({abreviatura_moneda:"",direccion_cliente:"",estado_factura:"",fecha_cobro_factura:"",fecha_factura:"",id_caja_factura:"",id_factura:"",monto_total_factura:"",nombre_cliente:"",nombre_moneda:"",nombre_user:"",nro_factura:"",obs_factura:"",ruc_cliente:"",tipo_factura:"",valor_moneda:"",descuento_factura:""}),U=Object(r.a)(q,2),B=U[0],V=U[1],H=Object(c.useState)([]),G=Object(r.a)(H,2),J=G[0],Y=G[1],K=Object(c.useState)(""),X=Object(r.a)(K,2),Q=X[0],Z=X[1],$=function(){var e=Object(d.a)(l.a.mark((function e(t){var a,r,n,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return F(!0),"0"===t.tipo_factura?x(Object(Te.a)(Object(Te.a)({},O),{},{imprimirRecibo:!0})):x(Object(Te.a)(Object(Te.a)({},O),{},{imprimirFactura:!0})),e.next=4,k.get({table:"facturas_items",include:"productos,impuestos",on:"id_producto,id_producto_factura,id_impuesto,id_impuesto_factura",where:"id_items_factura,=,".concat(t.id_factura)});case 4:if("ok"===(a=e.sent).response?Y(a.results):console.log(a),"0"===t.tipo_factura){e.next=13;break}return e.next=9,k.get({table:"empresa_facturas",where:"id_caja_empresa,=,".concat(t.id_caja_factura)});case 9:"ok"===(r=e.sent).response?(n=r.results[0],(o=Object(Te.a)({},t)).timbrado_factura=n.timbrado_factura,o.fin_timbrado=n.fin_timbrado,o.inicio_timbrado=n.inicio_timbrado,o.nro_datos_factura=n.nro_datos_factura,V(o)):console.log(r),e.next=14;break;case 13:V(t);case 14:F(!1);case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ee=Object(c.useCallback)(Object(d.a)(l.a.mark((function e(){var t,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return v(!0),e.next=3,k.get({table:"facturas",include:"clientes,monedas,users",on:"id_cliente_factura,id_cliente,id_moneda,id_moneda_factura,id_user,id_user_factura",fields:"nro_factura,abreviatura_moneda,nombre_moneda,abreviatura_moneda,valor_moneda,estado_factura,fecha_factura,fecha_cobro_factura,ruc_cliente,nombre_cliente,direccion_cliente,monto_total_factura,tipo_factura,id_factura,nombre_user,obs_factura,descuento_factura",filtersField:"nro_factura",filtersSearch:Q,pagenumber:0,pagesize:10});case 3:"ok"===(t=e.sent).response?(i(t.results),a=0,t.results.forEach((function(e){a+=parseFloat(e.monto_total_factura)})),b(a)):console.log(t),v(!1);case 6:case"end":return e.stop()}}),e)}))),[Q]),te=Object(c.useCallback)(Object(d.a)(l.a.mark((function e(){var t,a,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return v(!0),t="","0"===W?t=",and,tipo_factura,=,0":"1"===W?t=",and,tipo_factura,=,1":"2"===W?t=",and,tipo_factura,=,2":"3"===W?t=",and,estado_factura,=,1":"4"===W&&(t=",and,estado_factura,=,2"),e.next=5,k.get({table:"facturas",include:"clientes,monedas,users",on:"id_cliente_factura,id_cliente,id_moneda,id_moneda_factura,id_user,id_user_factura",fields:"nro_factura,abreviatura_moneda,nombre_moneda,abreviatura_moneda,valor_moneda,estado_factura,fecha_factura,fecha_cobro_factura,ruc_cliente,nombre_cliente,direccion_cliente,monto_total_factura,tipo_factura,id_factura,nombre_user,id_caja_factura,obs_factura,descuento_factura",where:"fecha_factura,between,'".concat(A," 00:00:00',and,'").concat(T," 23:59:59' ").concat(t),sort:"fecha_factura"});case 5:"ok"===(a=e.sent).response?(i(a.results),r=0,a.results.forEach((function(e){r+=parseFloat(e.monto_total_factura)})),b(r)):console.log(a),v(!1);case 8:case"end":return e.stop()}}),e)}))),[A,T,W]);return Object(c.useEffect)((function(){var e=new AbortController,t=!0;return t&&te(),function(){t=!1,e.abort()}}),[te]),Object(w.jsx)(xt.Provider,{value:{lista:o,setLista:i,desdeFecha:A,setDesdeFecha:D,hastaFecha:T,setHastaFecha:R,cargando:_,setCargando:v,cargandoFactura:y,total:j,setTotal:b,dialogs:O,setDialogs:x,formulario:B,setFormulario:V,fecha:h,filtro:W,setFiltro:z,inputSearch:Q,setInputSearch:Z,getBuscarFactura:ee,consultarParaImprimir:$,itemsFactura:J,setItemsFactura:Y},children:t})},gt=Object(c.createContext)(),_t=function(){var e=Object(c.useContext)(gt);return{MONEDA_PRINCIPAL:e.MONEDA_PRINCIPAL,SET_MONEDA_PRINCIPAL:e.SET_MONEDA_PRINCIPAL,EMPRESA:e.EMPRESA}},vt=function(e){var t=e.children,a=JSON.parse(localStorage.getItem("dataEmpresa")),n=JSON.parse(localStorage.getItem("dataMonedas")),o=n?n.filter((function(e){return"1"===e.activo_moneda})):{},i=Object(c.useState)(o[0]),s=Object(r.a)(i,2),u=s[0],j=s[1],b=Object(c.useState)(a||{}),p=Object(r.a)(b,2),m=p[0],O=p[1],x=I().logueado,h=Object(c.useCallback)(Object(d.a)(l.a.mark((function e(){var t,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!x){e.next=10;break}if(null!==a&&null!==n){e.next=10;break}return e.next=4,k.get({table:"monedas",where:"activo_moneda,=,1"});case 4:return"ok"===(t=e.sent).response?j(t.results[0]):console.log(t),e.next=8,k.get({table:"empresas"});case 8:"ok"===(r=e.sent).response?O(r.results[0]):console.log(r);case 10:case"end":return e.stop()}}),e)}))),[x,a,n]);return Object(c.useEffect)((function(){var e=new AbortController,t=!0;return t&&h(),function(){t=!1,e.abort()}}),[h]),Object(w.jsx)(gt.Provider,{value:{MONEDA_PRINCIPAL:u,SET_MONEDA_PRINCIPAL:j,EMPRESA:m},children:t})},Ct=function(){var e=ht(),t=e.lista,a=e.setDesdeFecha,n=e.setHastaFecha,o=e.cargando,i=e.total,s=e.setDialogs,l=e.dialogs,d=e.setFormulario,u=e.fecha,j=e.setFiltro,b=e.inputSearch,p=e.setInputSearch,m=e.getBuscarFactura,O=e.consultarParaImprimir,x=_t().MONEDA_PRINCIPAL,h=Object(c.useState)(u),f=Object(r.a)(h,2),g=f[0],_=f[1],v=Object(c.useState)(u),C=Object(r.a)(v,2),k=C[0],S=C[1],y=Object(c.useState)(""),F=Object(r.a)(y,2),I=F[0],P=F[1],A=t.filter((function(e){return e.nro_factura.toLowerCase().includes(b.toLowerCase())||e.nombre_cliente.toLowerCase().includes(b.toLowerCase())})),D=[{field:"nro_factura",title:"NRO"},{field:"fecha_factura",title:"FECHA",isDate:!0},{field:"nombre_cliente",title:"CLIENTE"},{field:"estado_factura",title:"ESTADO",items:{0:"Anulado",1:"Cobrado",2:"Cobranza pendiente"},comparaItem:"estado_factura"},{field:"tipo_factura",title:"TIPO",items:{1:"Contado",2:"Cr\xe9dito",0:"Recibo"},comparaItem:"tipo_factura"},{field:"monto_total_factura",title:"MONTO",isNumber:!0,extraitem:x.abreviatura_moneda}],E=Object(w.jsxs)(Z.a,{container:!0,spacing:3,children:[Object(w.jsx)(Z.a,{item:!0,xs:12,sm:12,children:Object(w.jsx)(ae.a,{variant:"contained",fullWidth:!0,color:"primary",size:"large",onClick:function(){return ue.goto("ventas")},children:"Nueva venta"})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(Fe.a,{fullWidth:!0,label:"Desde",variant:"outlined",type:"date",defaultValue:g,onChange:function(e){return _(e.target.value)},name:"desdeFecha"})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(Fe.a,{fullWidth:!0,label:"Hasta",variant:"outlined",type:"date",defaultValue:k,onChange:function(e){return S(e.target.value)},name:"hastaFecha"})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsxs)(Ve.a,{fullWidth:!0,children:[Object(w.jsx)(He.a,{variant:"outlined",children:"Seleccione opciones"}),Object(w.jsxs)(Ge.a,{name:"tipo_filtro",value:I,onChange:function(e){P(e.target.value)},variant:"outlined",children:[Object(w.jsx)(Je.a,{value:"",children:"Todos"}),Object(w.jsx)(Je.a,{value:"0",children:"Tipo recibo"}),Object(w.jsx)(Je.a,{value:"1",children:"Tipo contado"}),Object(w.jsx)(Je.a,{value:"2",children:"Tipo cr\xe9dito"}),Object(w.jsx)(Je.a,{value:"3",children:"Cobrados"}),Object(w.jsx)(Je.a,{value:"4",children:"No cobrados"})]})]})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:6,children:Object(w.jsx)(ae.a,{onClick:function(){n(k),a(g),j(I)},variant:"outlined",color:"primary",size:"large",startIcon:Object(w.jsx)(ee.a,{children:"filter_list"}),children:"Filtrar"})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsxs)("h3",{children:["Total: ",ue.numberSeparator(i)," ",x.abreviatura_moneda," "]})})]}),N=Object(w.jsx)(Z.a,{container:!0,spacing:1,children:Object(w.jsx)(Z.a,{item:!0,xs:12,sm:4,children:Object(w.jsx)(Fe.a,{InputProps:{endAdornment:Object(w.jsx)(Ie.a,{position:"end",children:Object(w.jsx)(Pe.a,{onClick:function(){m()},children:Object(w.jsx)(ee.a,{children:"search"})})})},onKeyPress:function(e){"Enter"===e.key&&m()},onChange:function(e){return p(e.target.value)},variant:"outlined",label:"Buscar por n\xfamero",fullWidth:!0})})});return Object(w.jsxs)(Z.a,{container:!0,spacing:3,children:[Object(w.jsx)(Z.a,{item:!0,xs:12,md:3,children:E}),Object(w.jsx)(Z.a,{item:!0,xs:12,md:9,children:Object(w.jsx)(ye,{print:!0,nombretabla:"Facturas",caption:"Total: ".concat(ue.numberSeparator(i)),subtitle:"Todos los movimientos de facturas filtradas por fecha y tipo",columnas:D,Acciones:function(e){var t=e.filaProps;return Object(w.jsxs)(we.a,{direction:"row",spacing:2,children:[Object(w.jsx)(Ae.a,{title:"Ver estado",arrow:!0,children:Object(w.jsx)(Pe.a,{onClick:function(){var e;e=t,s(Object(Te.a)(Object(Te.a)({},l),{},{estado:!0})),d(e)},children:Object(w.jsx)(ee.a,{children:"credit_score"})})}),Object(w.jsx)(Ae.a,{title:"Imprimir",arrow:!0,children:Object(w.jsx)(Pe.a,{onClick:function(){return O(t)},children:Object(w.jsx)(ee.a,{children:"print"})})})]})},bgicono:"#3f51b5",icono:"assignment",filas:A,namecolumnID:"id_factura",cargando:o,search:N,exportCSV:!0,exportExcel:!0,showOptions:!0})})]})},kt=Object(z.a)((function(e){return{titulodialog:{display:"flex",justifyContent:"space-between",alignItems:"center"},cargando:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%"},page:{display:"flex",justifyContent:"center",alignItems:"center","& > *":{margin:e.spacing(0,1)}},botones:{"& > *":{margin:e.spacing(0,1)}},inputs:{display:"flex",flexWrap:"wrap",alignItems:"center","& > *":{margin:"10px 10px 10px 0"}},textfield:{marginTop:e.spacing(1),marginBottom:e.spacing(1)},textfieldHidden:{display:"none"},loaderSend:{margin:e.spacing(1,0,2,0)},selects:{minWidth:"100%",marginTop:e.spacing(1),marginBottom:e.spacing(1)},centrar:{display:"flex",width:"100%",justifyContent:"center",alignItems:"center",height:"80vh",flexDirection:"column","& > *":{marginTop:"25px"}},iconWarning:{fontSize:120,color:"orange"},labelSelect:{marginTop:"3px",marginLeft:"5px"},SelectForm:{minWidth:300,marginTop:e.spacing(2),marginRight:e.spacing(2)},linearProgress:{marginBottom:e.spacing(1)}}})),St=function(){var e=ht(),t=e.dialogs,a=e.setDialogs,r=e.formulario,n=kt(),o=function(){a(Object(Te.a)(Object(Te.a)({},t),{},{estado:!1}))};return Object(w.jsxs)(ze.a,{fullWidth:!0,open:t.estado,onClose:o,children:[Object(w.jsx)(qe.a,{children:Object(w.jsxs)("div",{className:n.titulodialog,children:[Object(w.jsx)("div",{children:"Estado "}),Object(w.jsx)(Pe.a,{onClick:function(){return o()},children:Object(w.jsx)(ee.a,{children:"close"})})]})}),Object(w.jsx)(Ue.a,{children:Object(w.jsxs)(Z.a,{container:!0,children:[Object(w.jsxs)(Z.a,{item:!0,xs:12,children:[Object(w.jsxs)("h3",{children:["Fecha de venta: ",null===r||void 0===r?void 0:r.fecha_factura]}),Object(w.jsxs)("h3",{children:["Tipo: ","0"===(null===r||void 0===r?void 0:r.tipo_factura)?"Recibo":"Factura"," NRO: ",null===r||void 0===r?void 0:r.nro_factura]}),Object(w.jsxs)("h3",{children:["Cliente: ",null===r||void 0===r?void 0:r.nombre_cliente," ",r.apellido_cliente," ",null===r||void 0===r?void 0:r.ruc_cliente," "]}),Object(w.jsxs)("h3",{children:["Vendedor: ",null===r||void 0===r?void 0:r.nombre_user]}),Object(w.jsxs)("h3",{children:["Total: ",ue.numberSeparator(null===r||void 0===r?void 0:r.monto_total_factura)," ",null===r||void 0===r?void 0:r.abreviatura_moneda]}),Object(w.jsxs)("h3",{children:["Descuento: ",ue.numberSeparator(null===r||void 0===r?void 0:r.descuento_factura)," ",null===r||void 0===r?void 0:r.abreviatura_moneda]}),Object(w.jsxs)("h3",{children:["Observaci\xf3n: ",null===r||void 0===r?void 0:r.obs_factura]})]}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:"1"===r.estado_factura?Object(w.jsx)(de.a,{variant:"outlined",severity:"warning",icon:Object(w.jsx)(ee.a,{color:"warning",children:"savings"}),children:"Cobrado"}):Object(w.jsx)(de.a,{variant:"outlined",severity:"error",icon:Object(w.jsx)(ee.a,{children:"thumb_down"}),children:"Cobranza pendiente"})})]})})]})},yt=a(817),wt=a(884),Ft=a(874),It=Object(wt.a)({root:{padding:"15px",fontSize:"0.9rem",boxShadow:"8px 7px 4px -2px rgb(0 0 0 / 20%), 0px 2px 2px 0px rgb(0 0 0 / 14%), 0px 1px 5px 0px rgb(0 0 0 / 12%)",borderRadius:"10px"},label:{}})(ae.a),Pt=Object(wt.a)({root:{"& .MuiInputBase-input":{fontSize:20},"& .MuiOutlinedInput-root":{borderRadius:15},marginTop:10,marginBottom:10}})(Fe.a);Object(wt.a)({root:{background:"linear-gradient(31deg, #28a0ffdb 30%, #ffffff 90%)"}})(Ft.a),Object(wt.a)({root:{background:"linear-gradient(45deg, #f7670087 30%, #ffffffb3 90%)"}})(Ft.a);function At(e){var t=Object.assign({},e);return Object(w.jsx)(Pt,Object(Te.a)({},t))}function Dt(e){var t=Object.assign({},e);return Object(w.jsx)(It,Object(Te.a)({},t))}var Et=ue,Nt=function(){var e=ht(),t=e.dialogs,a=e.setDialogs,r=e.formulario,n=e.itemsFactura,o=e.cargandoFactura,i=Object(c.useRef)(null),s=JSON.parse(localStorage.getItem("dataEmpresa")),l=Object(Te.a)({},r),d=0,u=0,j=0,b=0,p=0,m=0,O=0;n.forEach((function(e){var t=parseFloat(e.precio_producto_factura)*parseFloat(e.cantidad_producto);m+=t;var a=parseFloat(e.porcentaje_impuesto);"5"===a?(d+=t,j+=t*a/(100+a)):10===a?(u+=t,b+=t*a/(100+a)):0===a&&(O+=t),p+=j+b}));var x=function(){a(Object(Te.a)(Object(Te.a)({},t),{},{imprimirFactura:!1}))};return Object(w.jsxs)(ze.a,{open:t.imprimirFactura,fullWidth:!0,maxWidth:"md",onClose:x,TransitionComponent:yt.a,children:[o?Object(w.jsx)(we.a,{sx:{padding:"20px"},alignItems:"center",children:Object(w.jsx)(U.a,{})}):Object(w.jsxs)("div",{style:{display:"flex",justifyContent:"center",flexDirection:"column",margin:"25px auto",fontFamily:"monospace"},id:"print_factura",className:"maindiv",ref:i,children:[Object(w.jsx)("table",{width:"740px",style:{borderCollapse:"collapse"},className:"collapse",border:"1",children:Object(w.jsxs)("tbody",{children:[Object(w.jsxs)("tr",{children:[Object(w.jsxs)("td",{width:"65%",align:"left",colSpan:"3",style:{fontSize:"11px"},children:[Object(w.jsx)("h2",{children:s.nombre_empresa}),Object(w.jsxs)("p",{children:["De: ",s.propietario_empresa]}),Object(w.jsxs)("p",{children:[s.categoria_empresa," Tel:",s.telefono_empresa," - ",s.direccion_empresa]})]}),Object(w.jsxs)("td",{width:"35%",align:"left",valign:"top",className:"fontsize11",style:{fontSize:"12px"},children:[Object(w.jsxs)("p",{children:["RUC: ",null===s||void 0===s?void 0:s.ruc_empresa]}),Object(w.jsxs)("p",{children:["TIMBRADO NRO: ",null===l||void 0===l?void 0:l.timbrado_factura]}),Object(w.jsxs)("p",{children:["Inicio vigencia: ",null===l||void 0===l?void 0:l.inicio_timbrado]}),Object(w.jsxs)("p",{children:["Fin vigencia: ",null===l||void 0===l?void 0:l.fin_timbrado," "]}),Object(w.jsxs)("b",{children:["FACTURA NRO: ",null===l||void 0===l?void 0:l.nro_datos_factura," ",l.nro_factura]})]})]}),Object(w.jsxs)("tr",{children:[Object(w.jsxs)("td",{width:"65%",align:"left",colSpan:"3",style:{fontSize:"12px"},children:[Object(w.jsxs)("p",{children:["Fecha: ",Et.getFechaActualString()]}),Object(w.jsxs)("p",{children:["Nombre o Raz\xf3n Social: ",null===l||void 0===l?void 0:l.nombre_cliente]}),Object(w.jsxs)("p",{children:["Direcci\xf3n: ",null===l||void 0===l?void 0:l.direccion_cliente]})]}),Object(w.jsxs)("td",{width:"35%",align:"left",valign:"top",className:"fontsize11",style:{fontSize:"12px"},children:[Object(w.jsxs)("p",{children:["Condici\xf3n de venta:"," ","1"===l.tipo_factura?"Contado":"Cr\xe9dito"]}),Object(w.jsxs)("p",{children:["RUC/CI: ",null===l||void 0===l?void 0:l.ruc_cliente]})]})]})]})}),Object(w.jsx)("br",{}),Object(w.jsx)("div",{style:{minHeight:"600px"},children:Object(w.jsxs)("table",{width:"740px",style:{borderCollapse:"collapse"},className:"collapse",border:"1",children:[Object(w.jsx)("thead",{children:Object(w.jsxs)("tr",{align:"left",children:[Object(w.jsx)("th",{width:"10%",align:"center",children:"CANT."}),Object(w.jsx)("th",{width:"50%",align:"center",children:Object(w.jsx)("p",{children:"DESCRIPCION"})}),Object(w.jsx)("th",{width:"10%",align:"center",children:"PRECIO"}),Object(w.jsx)("th",{width:"10%",align:"center",children:"EXENTA"}),Object(w.jsx)("th",{width:"10%",align:"center",children:"5%"}),Object(w.jsx)("th",{width:"10%",align:"center",children:"10%"})]})}),Object(w.jsx)("tbody",{children:n.map((function(e,t){return Object(w.jsxs)("tr",{style:{fontSize:"10px"},children:[Object(w.jsx)("td",{width:"10%",align:"center",valign:"center",children:e.cantidad_producto}),Object(w.jsx)("td",{width:"50%",children:e.nombre_producto}),Object(w.jsx)("td",{width:"10%",align:"center",children:Object(w.jsx)("span",{children:Et.numberSeparator(e.precio_producto_factura)})}),Object(w.jsx)("td",{width:"10%",align:"center",children:"0"===e.porcentaje_impuesto?Et.numberSeparator(parseFloat(e.precio_producto_factura)*parseFloat(e.cantidad_producto)):"0"}),Object(w.jsx)("td",{width:"10%",align:"center",children:"5"===e.porcentaje_impuesto?Et.numberSeparator(parseFloat(e.precio_producto_factura)*parseFloat(e.cantidad_producto)):"0"}),Object(w.jsx)("td",{width:"10%",align:"center",children:"10"===e.porcentaje_impuesto?Et.numberSeparator(parseFloat(e.precio_producto_factura)*parseFloat(e.cantidad_producto)):"0"})]},t)}))})]})}),Object(w.jsx)("br",{}),Object(w.jsx)("table",{width:"740px",style:{borderCollapse:"collapse"},className:"collapse",border:"1",children:Object(w.jsx)("tbody",{children:Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{width:"70%",children:Object(w.jsx)("p",{children:"SUBTOTALES:"})}),Object(w.jsx)("td",{width:"10%",align:"center",children:Et.numberSeparator(O)}),Object(w.jsx)("td",{width:"10%",align:"center",children:Et.numberSeparator(d)}),Object(w.jsx)("td",{width:"10%",align:"center",children:Et.numberSeparator(u)})]})})}),Object(w.jsx)("br",{}),Object(w.jsx)("table",{width:"740px",style:{borderCollapse:"collapse"},className:"collapse",border:"1",children:Object(w.jsxs)("tbody",{children:[Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{width:"70%",colSpan:"3",children:Object(w.jsxs)("b",{children:["TOTAL A PAGAR: ",l.abreviatura_moneda," "," ",Et.NumeroALetras(m,"")]})}),Object(w.jsx)("td",{width:"30%",align:"right",children:Object(w.jsx)("b",{children:Et.numberSeparator(m)})})]}),Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{children:"LIQUIDACION IVA"}),Object(w.jsxs)("td",{children:["5%: ",Et.numberSeparator(parseInt(Et.redondeo2decimales(j)))]}),Object(w.jsxs)("td",{children:["10%: ",Et.numberSeparator(parseInt(Et.redondeo2decimales(b)))]}),Object(w.jsxs)("td",{align:"right",children:["TOTAL IVA:",Et.redondeo2decimales(p)]})]})]})})]}),Object(w.jsxs)(Ye.a,{children:[Object(w.jsx)(X.a,{targetRef:i,x:8,y:8,filename:"".concat(null===l||void 0===l?void 0:l.nro_datos_factura," ").concat(l.nro_factura,".pdf"),children:function(e){var t=e.toPdf;return Object(w.jsx)(Dt,{variant:"outlined",startIcon:Object(w.jsx)(ee.a,{children:"picture_as_pdf"}),onClick:t,children:"PDF"})}}),Object(w.jsx)(Dt,{size:"large",variant:"contained",color:"primary",startIcon:Object(w.jsx)(ee.a,{children:"print"}),onClick:function(){Y()({type:"html",printable:"print_factura",style:" .border1 {border:none} \n      .maindiv{margin:20px auto; font-family:monospace;  max-width:198mm;display:flex;flex-direction:column;}\n      .maindiv td{ padding-left:5px;}\n      .collapse{border-collapse:collapse; border-color:silver}\n      .fontsize11{font-size:10px}\n      "})},children:"Imprimir"}),Object(w.jsx)(Dt,{size:"large",variant:"outlined",color:"primary",onClick:x,children:"Cerrar"})]})]})},Tt=function(){var e=ht(),t=e.dialogs,a=e.setDialogs,r=e.formulario,n=e.itemsFactura,o=e.cargandoFactura,c=JSON.parse(localStorage.getItem("dataEmpresa")),i=c.dimension_ticket+"mm",s=Object(Te.a)({},r),l=function(){a(Object(Te.a)(Object(Te.a)({},t),{},{imprimirRecibo:!1}))};return Object(w.jsxs)(ze.a,{open:t.imprimirRecibo,fullWidth:!0,maxWidth:"xs",onClose:l,TransitionComponent:yt.a,children:[o?Object(w.jsxs)(we.a,{sx:{padding:"20px"},alignItems:"center",children:[" ",Object(w.jsx)(U.a,{})," "]}):Object(w.jsx)("div",{style:{display:"flex",justifyContent:"center",padding:"25px",margin:"0 auto"},id:"print",className:"textMono",children:Object(w.jsxs)("table",{border:"0",style:{width:i,borderCollapse:"collapse"},children:[Object(w.jsxs)("thead",{style:{fontSize:"11px"},children:[Object(w.jsx)("tr",{children:Object(w.jsx)("td",{align:"center",style:{fontSize:"15px"},children:c.nombre_empresa})}),Object(w.jsx)("tr",{children:Object(w.jsx)("td",{align:"center",children:c.direccion_empresa})}),Object(w.jsx)("tr",{children:Object(w.jsxs)("td",{align:"center",children:["Tel: ",c.telefono_empresa]})}),Object(w.jsx)("tr",{children:Object(w.jsx)("td",{align:"center",children:Object(w.jsxs)("strong",{children:[" RECIBO NRO: ",s.nro_factura]})})}),Object(w.jsx)("tr",{children:Object(w.jsxs)("td",{align:"center",children:["Moneda: ",s.nombre_moneda]})})]}),Object(w.jsxs)("tbody",{children:[Object(w.jsx)("tr",{children:Object(w.jsx)("td",{children:Object(w.jsx)("hr",{})})}),Object(w.jsx)("tr",{children:Object(w.jsx)("td",{children:Object(w.jsx)("table",{width:"100%",children:Object(w.jsxs)("tbody",{children:[Object(w.jsxs)("tr",{style:{fontSize:"11px"},children:[Object(w.jsx)("td",{children:"CA"}),Object(w.jsx)("td",{children:"DESC"}),Object(w.jsx)("td",{children:"PRE"}),Object(w.jsx)("td",{children:"SUBT"})]}),n.map((function(e,t){return Object(w.jsxs)("tr",{style:{fontSize:"10px",textTransform:"lowercase"},children:[Object(w.jsx)("td",{valign:"top",children:e.cantidad_producto}),Object(w.jsx)("td",{valign:"top",children:e.nombre_producto}),Object(w.jsx)("td",{valign:"top",children:Et.numberFormat(e.precio_producto_factura)}),Object(w.jsx)("td",{valign:"top",children:Et.numberFormat(parseFloat(e.precio_producto_factura)*parseFloat(e.cantidad_producto))})]},t)}))]})})})}),Object(w.jsx)("tr",{children:Object(w.jsx)("td",{align:"center",children:"-------------------------------------------"})}),Object(w.jsx)("tr",{children:Object(w.jsx)("td",{children:Object(w.jsx)("table",{width:"100%",style:{fontSize:"12px"},children:Object(w.jsxs)("tbody",{children:[Object(w.jsx)("tr",{children:Object(w.jsxs)("th",{children:["SUBTOTAL: ",Et.numberSeparator(s.monto_total_factura)]})}),parseInt(s.descuento_factura)>0&&Object(w.jsx)("tr",{children:Object(w.jsxs)("th",{children:[" DESCUENTO: -",s.descuento_factura," "]})}),Object(w.jsx)("tr",{children:Object(w.jsxs)("th",{children:["TOTAL: ",Et.numberSeparator(parseFloat(s.monto_total_factura)-parseInt(s.descuento_factura))," ",s.abreviatura_moneda]})}),Object(w.jsx)("tr",{children:Object(w.jsxs)("th",{children:[Et.NumeroALetras(parseFloat(s.monto_total_factura)-parseFloat(s.descuento_factura),s.abreviatura_moneda)," "]})})]})})})}),Object(w.jsx)("tr",{children:Object(w.jsx)("td",{align:"center",children:"-------------------------------------------"})})]}),Object(w.jsxs)("tfoot",{style:{fontSize:"11px"},children:[Object(w.jsx)("tr",{children:Object(w.jsxs)("td",{align:"left",children:["CLIENTE: ",s.nombre_cliente]})}),Object(w.jsx)("tr",{children:Object(w.jsxs)("td",{align:"left",children:["DOC: ",s.ruc_cliente]})}),Object(w.jsx)("tr",{children:Object(w.jsxs)("td",{align:"left",children:["FECHA EMISION: ",s.fecha_factura]})}),Object(w.jsx)("tr",{children:Object(w.jsx)("td",{children:Object(w.jsx)("hr",{})})}),Object(w.jsx)("tr",{children:Object(w.jsx)("td",{align:"center",children:"Los datos impresos requieren un cuidado especial. Para ello evite exponer al calor y humedad en exceso, luz solar o l\xe1mparas"})}),Object(w.jsx)("tr",{children:Object(w.jsxs)("td",{align:"center",children:[" ","*",c.nombre_empresa," agradece su compra *"]})})]})]})}),Object(w.jsxs)(Ye.a,{children:[Object(w.jsx)(Dt,{size:"large",variant:"contained",color:"primary",startIcon:Object(w.jsx)(ee.a,{children:"print"}),onClick:function(){Y()({type:"html",printable:"print",style:".textMono{font-family:monospace}"})},children:"Imprimir"}),Object(w.jsx)(Dt,{size:"large",variant:"outlined",color:"primary",onClick:l,children:"Cerrar"})]})]})},Rt=function(){var e=ht().dialogs;return e.imprimirFactura?Object(w.jsx)(Nt,{}):e.imprimirRecibo?Object(w.jsx)(Tt,{}):Object(w.jsx)(w.Fragment,{})},Mt=function(){return Object(w.jsxs)(ft,{children:[Object(w.jsx)(St,{}),Object(w.jsx)(Rt,{}),Object(w.jsx)(Ct,{})]})},Lt=a(828),Wt=a(875),zt=a(876),qt=a(384),Ut=a(862),Bt=a(836),Vt=a(818),Ht=a(819),Gt=function(){var e=Object(c.useState)(null),t=Object(r.a)(e,2),a=t[0],n=t[1],o=function(){n(null)};return Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(Pe.a,{onClick:function(e){n(e.currentTarget)},children:Object(w.jsx)(ee.a,{color:"inherit",children:"more_vert"})}),Object(w.jsx)(qt.a,{id:"simple-menu",anchorEl:a,keepMounted:!0,open:Boolean(a),onClose:o,children:Object(w.jsxs)(Ut.a,{children:[Object(w.jsxs)(Bt.a,{button:!0,onClick:function(){o(),Et.goto("cajas")},children:[Object(w.jsx)(Vt.a,{children:Object(w.jsx)(ee.a,{children:"point_of_sale"})}),Object(w.jsx)(Ht.a,{primary:"Arqueo"})]}),Object(w.jsxs)(Bt.a,{button:!0,onClick:function(){y()({text:"Desea cerrar el sistema?",icon:"warning",buttons:["Cancelar","OK"]}).then((function(e){e?p.push("/salir"):o()}))},children:[Object(w.jsx)(Vt.a,{children:Object(w.jsx)(ee.a,{children:"logout"})}),Object(w.jsx)(Ht.a,{primary:"Salir"})]})]})})]})},Jt=a(837),Yt=function(){var e=function(){var e=Object(c.useContext)(L);return{cantidad:e.cantidad,setCantidad:e.setCantidad,lista:e.lista,setLista:e.setLista}}(),t=e.cantidad,a=e.lista,n=Object(c.useState)(null),o=Object(r.a)(n,2),i=o[0],s=o[1],l=function(){s(null)};return Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(Pe.a,{onClick:function(e){s(e.currentTarget)},children:Object(w.jsx)(Jt.a,{color:"error",badgeContent:t,children:Object(w.jsx)(ee.a,{children:"notifications"})})}),Object(w.jsx)(qt.a,{anchorEl:i,keepMounted:!0,open:Boolean(i),onClose:l,children:Object(w.jsx)(Ut.a,{children:a.length>0?a.map((function(e,t){return Object(w.jsx)(Bt.a,{button:!0,onClick:function(){Et.goto("compras?code=".concat(e.codigo_producto)),l()},children:Object(w.jsx)(Ht.a,{secondary:"Producto en falta: ".concat(e.nombre_producto)})},t)})):Object(w.jsxs)(Bt.a,{children:[Object(w.jsx)(Vt.a,{children:Object(w.jsx)(ee.a,{children:"notifications_off"})}),Object(w.jsx)(Ht.a,{secondary:"No hay notificaciones"})]})})})]})},Kt=function(){var e=bt().changeLang,t=Object(c.useState)(null),a=Object(r.a)(t,2),n=a[0],o=a[1],i=function(){o(null)},s=function(t){i(),e(t)};return Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(Pe.a,{onClick:function(e){o(e.currentTarget)},children:Object(w.jsx)(ee.a,{children:"language"})}),Object(w.jsx)(qt.a,{anchorEl:n,keepMounted:!0,open:Boolean(n),onClose:i,children:Object(w.jsxs)(Ut.a,{children:[Object(w.jsx)(Bt.a,{button:!0,onClick:function(){s("es")},children:Object(w.jsx)(Ht.a,{secondary:"Espa\xf1ol"})}),Object(w.jsx)(Bt.a,{button:!0,onClick:function(){s("en")},children:Object(w.jsx)(Ht.a,{secondary:"English"})}),Object(w.jsx)(Bt.a,{button:!0,onClick:function(){s("pt")},children:Object(w.jsx)(Ht.a,{secondary:"Portugues"})})]})})]})};function Xt(e){var t=e.AbrirMenu,a=e.AbrirMenuGrande,r=e.open,n=e.openPhone,o=R(),c=o.themeMode,i=o.changeTheme,s=o.drawerWidth,l=Object(z.a)((function(e){var t,a;return{appBar:(t={},Object(G.a)(t,e.breakpoints.up("md"),{width:"100%"}),Object(G.a)(t,"transition",e.transitions.create(["margin","width"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen})),Object(G.a)(t,"backgroundColor",e.palette.background.default),t),appBarShift:(a={},Object(G.a)(a,e.breakpoints.down("md"),{width:"100%"}),Object(G.a)(a,"width","calc(100% - ".concat(s,"px)")),Object(G.a)(a,"marginLeft",s),Object(G.a)(a,"transition",e.transitions.create(["margin","width"],{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen})),Object(G.a)(a,"backgroundColor",e.palette.background.default),a),menuButton:Object(G.a)({marginRight:e.spacing(2)},e.breakpoints.up("lg"),{}),titulos:{display:"flex",width:"100%",justifyContent:"flex-end",alignItems:"center"},nombreUsuario:Object(G.a)({},e.breakpoints.down("md"),{display:"none"})}}))();return Object(w.jsx)(Wt.a,{position:"fixed",color:"inherit",className:r?l.appBarShift:l.appBar,children:Object(w.jsxs)(zt.a,{children:[Object(w.jsx)(Lt.a,{mdDown:!0,children:Object(w.jsx)(Pe.a,{className:l.menuButton,onClick:function(){a(!r)},children:Object(w.jsxs)(ee.a,{color:"primary",children:[" ",r?"menu_open":"menu"," "]})})}),Object(w.jsx)(Lt.a,{mdUp:!0,children:Object(w.jsx)(Pe.a,{className:l.menuButton,onClick:function(){t(!n)},children:Object(w.jsx)(ee.a,{color:"secondary",children:"menu"})})}),Object(w.jsx)("div",{className:l.titulos,children:Object(w.jsxs)("div",{children:[Object(w.jsx)(Kt,{}),Object(w.jsx)(Yt,{}),Object(w.jsx)(Ae.a,{title:"Cambiar de tema",children:Object(w.jsx)(Pe.a,{onClick:i,children:Object(w.jsx)(ee.a,{color:"warning",children:"dark"===c?"nights_stay":"tungsten"})})}),Object(w.jsx)(Gt,{})]})})]})})}var Qt=a(829),Zt=a(877),$t=[{id:59,texto:"Inicio",icono:"apps",color:"#a0aec0",url:"".concat(m,"/dashboard"),id_permiso:59},{id:44,texto:"Informes",icono:"trending_up",color:"#a0aec0",url:"".concat(m,"/informes"),id_permiso:44},{id:62,texto:"Control",open:!1,icono:"sports_esports",url:"url",id_permiso:62,submenu:[{id:69,texto:"Alumnos",icono:"group",color:"#a0aec0",url:"".concat(m,"/alumnos"),id_permiso:69},{id:63,texto:"Asistencias",icono:"fact_check",color:"#a0aec0",url:"".concat(m,"/asistencias"),id_permiso:63},{id:65,texto:"Abonos",icono:"paid",color:"#a0aec0",url:"".concat(m,"/abonos"),id_permiso:65},{id:67,texto:"Cuotas",icono:"account_balance_wallet",color:"#a0aec0",url:"".concat(m,"/cuotas"),id_permiso:67}]},{id:58,texto:"Agendas",open:!1,icono:"calendar_month",url:"url",id_permiso:58,submenu:[{id:49,texto:"Turnos",icono:"login",color:"#a0aec0",url:"".concat(m,"/turnos"),id_permiso:49},{id:51,texto:"Agenda",icono:"date_range",color:"#a0aec0",url:"".concat(m,"/agenda"),id_permiso:51}]},{id:53,texto:"Ventas",icono:"sell",color:"#a0aec0",url:"url",open:!1,id_permiso:53,submenu:[{id:1,texto:"Nueva venta",url:"".concat(m,"/ventas"),icono:"point_of_sale",color:"#a0aec0",id_permiso:1},{id:6,texto:"Notas",url:"".concat(m,"/notas"),icono:"receipt",color:"#a0aec0",id_permiso:6},{id:4,texto:"Lista Facturas",url:"".concat(m,"/facturas"),icono:"assignment",color:"#a0aec0",id_permiso:4},{id:16,texto:"Entregas",url:"".concat(m,"/entregas"),icono:"delivery_dining",color:"#a0aec0",id_permiso:16}]},{id:54,texto:"Productos",icono:"inventory_2",color:"#a0aec0",open:!1,id_permiso:54,submenu:[{id:91,texto:"Agregar",icono:"diamond",color:"#a0aec0",url:"".concat(m,"/productos/new"),id_permiso:9},{id:8,texto:"Lista de productos",icono:"content_paste",color:"#a0aec0",url:"".concat(m,"/productos"),id_permiso:8},{id:10,texto:"Categor\xedas",icono:"category",color:"#a0aec0",url:"".concat(m,"/categorias"),id_permiso:10},{id:14,texto:"Proveedores",url:"".concat(m,"/proveedores"),icono:"local_shipping",color:"#a0aec0",id_permiso:14},{id:12,texto:"Marcas",url:"".concat(m,"/marcas"),icono:"branding_watermark",color:"#a0aec0",id_permiso:12},{id:18,texto:"Apartados",icono:"save",color:"#a0aec0",url:"".concat(m,"/apartados"),id_permiso:18},{id:39,texto:"Depositos",url:"".concat(m,"/depositos"),icono:"local_convenience_store",color:"#a0aec0",id_permiso:39},{id:60,texto:"Transferencias",url:"".concat(m,"/transferencias"),icono:"sync_alt",color:"#a0aec0",id_permiso:60},{id:43,texto:"Inventario",icono:"handyman",color:"#a0aec0",url:"".concat(m,"/inventario"),id_permiso:43}]},{id:20,texto:"Compras",icono:"shopping_basket",color:"#a0aec0",url:"".concat(m,"/compras"),id_permiso:20},{id:55,texto:"Arqueos",icono:"savings",color:"#a0aec0",open:!1,id_permiso:55,submenu:[{id:22,texto:"Cajas",url:"".concat(m,"/cajas"),icono:"point_of_sale",color:"#a0aec0",id_permiso:22},{id:24,texto:"Mov. de cajas",url:"".concat(m,"/movimientos"),icono:"leaderboard",color:"#a0aec0",id_permiso:24},{id:26,texto:"Registro de mov.",url:"".concat(m,"/registromovimientos"),icono:"app_registration",color:"#a0aec0",id_permiso:26}]},{id:47,texto:"Cuentas",icono:"payments",color:"#a0aec0",url:"".concat(m,"/cuentas"),id_permiso:47},{id:56,texto:"Mantenimiento",icono:"engineering",color:"#a0aec0",open:!1,id_permiso:56,submenu:[{id:28,texto:"Clientes",url:"".concat(m,"/clientes"),icono:"people",color:"#a0aec0",id_permiso:28},{id:41,texto:"Empleados",url:"".concat(m,"/empleados"),icono:"badge",color:"#a0aec0",id_permiso:41},{id:30,texto:"Monedas",url:"".concat(m,"/monedas"),icono:"monetization_on",color:"#a0aec0",id_permiso:30},{id:32,texto:"Unidad de medida",icono:"square_foot",color:"#a0aec0",url:"".concat(m,"/medidas"),id_permiso:32},{id:45,texto:"Impuestos",icono:"account_balance",color:"#a0aec0",url:"".concat(m,"/impuestos"),id_permiso:45},{id:34,texto:"Usuarios",icono:"manage_accounts",color:"#a0aec0",url:"".concat(m,"/usuarios"),id_permiso:34}]},{id:57,texto:"Ajustes",icono:"settings",color:"#a0aec0",id_permiso:57,open:!1,submenu:[{id:36,texto:"Datos de Empresa",icono:"admin_panel_settings",color:"#a0aec0",url:"".concat(m,"/settings"),id_permiso:36},{id:38,texto:"Registro de facturas",icono:"app_registration",color:"#a0aec0",url:"".concat(m,"/registrofacturas"),id_permiso:38},{id:59,texto:"Info y ayuda",icono:"help",color:"#a0aec0",url:"".concat(m,"/info"),id_permiso:59}]}],ea=function(e){var t=e.onClose,a=Object(H.f)(),n=Object(c.useState)($t),o=Object(r.a)(n,2),i=o[0],s=o[1],l=I().permisos,d=bt().lang,u=R().drawerWidth,j=function(){t()},b=Object(z.a)((function(e){return{links:{textDecoration:"none",color:"inherit",fontWeight:"bold"},selected:{color:e.palette.primary.main},expanded:{paddingLeft:e.spacing(1)},root:{width:"100%",maxWidth:u,backgroundColor:e.palette.background.default},submenues:{paddingLeft:e.spacing(2)},oculto:{display:"none",visibility:"hidden"},iconItem:{minWidth:"30px"}}}))();return Object(w.jsx)(Ut.a,{component:"nav",className:b.root,children:i.map((function(e){return Object(w.jsx)("div",{children:e.submenu?l.some((function(t){return parseInt(t.id_permiso_permiso)===parseInt(e.id_permiso)}))&&Object(w.jsxs)("div",{children:[Object(w.jsxs)(Bt.a,{button:!0,onClick:function(){return function(e,t){var a=Object(Qe.a)($t),r=a.findIndex((function(e){return e.id===t}));a[r].open=!e,s(a)}(e.open,e.id)},classes:{selected:b.selected},children:[Object(w.jsx)(Vt.a,{className:b.iconItem,children:Object(w.jsx)(ee.a,{color:"inherit",children:e.icono})}),Object(w.jsx)(Ht.a,{primary:(null===d||void 0===d?void 0:d[e.texto])?null===d||void 0===d?void 0:d[e.texto]:e.texto}),Object(w.jsx)(ee.a,{color:"inherit",children:e.open?"expand_less":"expand_more"})]}),Object(w.jsx)(Zt.a,{in:e.open,timeout:"auto",unmountOnExit:!0,children:Object(w.jsx)(Ut.a,{component:"div",disablePadding:!0,className:b.submenues,children:e.submenu.map((function(e,t){return l.some((function(t){return parseInt(t.id_permiso_permiso)===parseInt(e.id_permiso)}))&&Object(w.jsx)("div",{children:Object(w.jsxs)(Bt.a,{component:lt.a,to:e.url,button:!0,onClick:j,classes:{selected:b.selected},selected:e.url===a.pathname,children:[Object(w.jsx)(Vt.a,{className:b.iconItem,children:Object(w.jsx)(ee.a,{color:e.url===a.pathname?"primary":"inherit",children:e.icono})}),Object(w.jsx)(Ht.a,{primary:(null===d||void 0===d?void 0:d[e.texto])?null===d||void 0===d?void 0:d[e.texto]:e.texto})]})},t)}))})})]}):Object(w.jsx)("div",{className:l.some((function(t){return parseInt(t.id_permiso_permiso)===parseInt(e.id_permiso)}))?"":b.oculto,children:Object(w.jsxs)(Bt.a,{component:lt.a,to:e.url,button:!0,onClick:j,classes:{selected:b.selected},selected:e.url===a.pathname,children:[Object(w.jsx)(Vt.a,{className:b.iconItem,children:Object(w.jsx)(ee.a,{color:e.url===a.pathname?"primary":"inherit",children:e.icono})}),Object(w.jsx)(Ht.a,{primary:(null===d||void 0===d?void 0:d[e.texto])?null===d||void 0===d?void 0:d[e.texto]:e.texto})]})})},e.id)}))})};function ta(e){var t=e.variant,a=e.onClose,r=e.open,n=e.onOpen,o=R().drawerWidth,c=Object(z.a)((function(e){return{drawer:{width:o,flexShrink:0,transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen})},drawerPaper:{width:o,backgroundColor:e.palette.background.default},toolbar:e.mixins.toolbar,appname:{display:"flex",height:"100%",justifyContent:"center",alignItems:"center",transition:"all 0.2s linear"},linkHome:{textDecoration:"none",color:e.palette.neutral.main}}}))();return Object(w.jsxs)(Qt.a,{variant:t,className:c.drawer,classes:{paper:c.drawerPaper},open:r,onOpen:function(){n(!0)},onClose:function(){a(!1)},anchor:"left",children:[Object(w.jsx)("div",{className:c.toolbar,children:Object(w.jsx)(lt.a,{to:"/",className:c.linkHome,children:Object(w.jsxs)(te.a,{className:c.appname,variant:"button",children:[h,Object(w.jsx)(ee.a,{color:"primary",children:O})]})})}),Object(w.jsx)(ea,{onClose:"temporary"===t?function(){a(!1)}:function(){}})]})}function aa(e){var t=e.children,a=Object(c.useState)(!1),n=Object(r.a)(a,2),o=n[0],i=n[1],s=Object(c.useState)(!0),l=Object(r.a)(s,2),d=l[0],u=l[1],j=R().drawerWidth,b=function(e){return u(e)},p=function(e){return i(e)},m=Object(z.a)((function(e){return{root:{display:"flex"},container:{margin:"0",padding:"10px",borderRadius:"8px"},toolbar:e.mixins.toolbar,content:Object(G.a)({flexGrow:1,padding:e.spacing(1),minHeight:"calc(99vh - "+e.mixins.toolbar.minHeight+"px)",transition:e.transitions.create("margin",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen})},e.breakpoints.up("md"),{marginLeft:-j}),contentExpand:{flexGrow:1,padding:e.spacing(1),transition:e.transitions.create("margin",{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen}),marginLeft:0,minHeight:"calc(99vh - "+e.mixins.toolbar.minHeight+"px)"}}}))();return Object(w.jsxs)("div",{className:m.root,children:[Object(w.jsx)(Xt,{AbrirMenu:p,AbrirMenuGrande:b,open:d,openPhone:o}),Object(w.jsx)(Lt.a,{mdDown:!0,children:Object(w.jsx)(ta,{variant:"persistent",open:d,onOpen:b,onClose:b})}),Object(w.jsx)(Lt.a,{mdUp:!0,children:Object(w.jsx)(ta,{variant:"temporary",open:o,onOpen:p,onClose:p})}),Object(w.jsxs)("div",{className:d?m.contentExpand:m.content,children:[Object(w.jsx)("div",{className:m.toolbar}),Object(w.jsx)("div",{className:m.container,children:t})]})]})}var ra=function(){return Object(w.jsxs)(we.a,{direction:"column",spacing:2,justifyContent:"center",alignItems:"center",children:[Object(w.jsx)(ee.a,{color:"warning",sx:{fontSize:"8rem"},children:"power_off"}),Object(w.jsx)(te.a,{variant:"body1",children:"A donde quieres llegar, porque no vuelves a casa?"}),Object(w.jsxs)(De.a,{variant:"extended",onClick:function(){ue.goto("")},children:[Object(w.jsx)(ee.a,{children:"home"}),"VOLVER A CASA"]})]})},na=Object(c.createContext)(),oa=function(){var e=Object(c.useContext)(na);return{cargando:e.cargando,setCargando:e.setCargando,showOptions:e.showOptions,inputSearch:e.inputSearch,setInputSearch:e.setInputSearch,lista:e.lista,setLista:e.setLista,page:e.page,setPage:e.setPage,limite:e.limite,setLimite:e.setLimite,buscarRegistro:e.buscarRegistro,borrarRegistro:e.borrarRegistro,listaCategorias:e.listaCategorias,setListaCategorias:e.setListaCategorias,countTotal:e.countTotal,setCountTotal:e.setCountTotal,dialogs:e.dialogs,setDialogs:e.setDialogs,getStock:e.getStock,formStock:e.formStock,formDetalles:e.formDetalles,setFormDetalles:e.setFormDetalles}},ca=function(e){var t=e.children,a=I(),n=a.token_user,o=a.permisos,i=Object(H.f)(),s=i.search?new URLSearchParams(i.search):0,u=Object(c.useState)(s&&s.get("p")&&!isNaN(s.get("p"))?parseInt(s.get("p")):0),j=Object(r.a)(u,2),b=j[0],p=j[1],m=Object(c.useState)(!1),O=Object(r.a)(m,2),x=O[0],h=O[1],f=Object(c.useState)({codigo_producto:"",nombre_producto:"",listaStock:[],medida:""}),g=Object(r.a)(f,2),_=g[0],v=g[1],C=Object(c.useState)({detalles:!1,code:!1,imagen:!1,stock:!1}),S=Object(r.a)(C,2),F=S[0],P=S[1],A=Object(c.useState)({}),D=Object(r.a)(A,2),E=D[0],N=D[1],T=Object(c.useState)(60),R=Object(r.a)(T,2),M=R[0],L=R[1],W=Object(c.useState)(0),z=Object(r.a)(W,2),q=z[0],U=z[1],B=Object(c.useState)({lista:!0,stock:!0}),V=Object(r.a)(B,2),G=V[0],J=V[1],Y=Object(c.useState)([]),K=Object(r.a)(Y,2),X=K[0],Q=K[1],Z=Object(c.useState)(""),$=Object(r.a)(Z,2),ee=$[0],te=$[1],ae=Object(c.useState)([]),re=Object(r.a)(ae,2),ne=re[0],oe=re[1],ce=function(){var e=Object(d.a)(l.a.mark((function e(t,a){var r,o,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y()({icon:"warning",title:"Borrar?",text:"Estas seguro de borrar ".concat(a,"?"),buttons:["Cancelar","Ok"],dangerMode:!0});case 2:if(!e.sent){e.next=8;break}return e.next=6,k.delete({table:"productos",id:t,token:n});case 6:"ok"===(r=e.sent).response?(Promise.all([k.delete({table:"productos_images",namecolumns:"id_image_producto",ids:t,token:n}),k.delete({table:"productos_depositos",namecolumns:"id_producto_deposito",ids:t,token:n})]),y()({icon:"success",text:"Borrado correctamente",timer:1200}),o=Object(Qe.a)(ne),c=o.findIndex((function(e){return e.id_producto===t})),o.splice(c,1),oe(o)):console.log(r);case 8:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),ie=function(){var e=Object(d.a)(l.a.mark((function e(t){var a,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return J(Object(Te.a)(Object(Te.a)({},G),{},{stock:!0})),a=t.id_producto,e.next=4,k.get({table:"productos_depositos",include:"depositos",on:"id_deposito,id_deposito_deposito",where:"id_producto_deposito,=,".concat(a)});case 4:"ok"===(r=e.sent).response&&v({medida:t.descripcion_medida,codigo_producto:t.codigo_producto,nombre_producto:t.nombre_producto,listaStock:r.results}),J(Object(Te.a)(Object(Te.a)({},G),{},{stock:!1}));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),se=Object(c.useCallback)((function(){o.some((function(e){return"9"===e.id_permiso_permiso}))?h(!0):h(!1)}),[o]),le=function(){var e=Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return J({lista:!0,stock:!0}),e.next=3,k.get({table:"productos",include:"categorias,unidad_medidas",on:"id_categoria_producto,id_categoria,id_unidad_medida_producto,id_unidad_medida",fields:"id_producto,nombre_producto,nombre_categoria,codigo_producto,precio_producto,costo_producto,preciom_producto,descripcion_medida",filtersField:"nombre_producto,codigo_producto",filtersSearch:"".concat(ee),pagenumber:"0",pagesize:M,sort:"-nombre_producto"});case 3:t=e.sent,console.log(t),t.found>0&&"ok"===t.response?(oe(t.results),Et.goto("productos")):console.log(t),J({lista:!1,stock:!0});case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),de=Object(c.useCallback)(Object(d.a)(l.a.mark((function e(){var t,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return J({lista:!0,stock:!0}),t={table:"productos",include:"categorias,unidad_medidas",on:"id_categoria_producto,id_categoria,id_unidad_medida_producto,id_unidad_medida",fields:"id_producto,nombre_producto,nombre_categoria,codigo_producto,precio_producto,costo_producto,preciom_producto,descripcion_medida",pagenumber:b,pagesize:M,sort:"-id_producto"},e.next=4,k.get(t);case 4:"ok"===(a=e.sent).response?(U(a.total),a.found>0&&(oe(a.results),0===b?Et.goto("productos"):Et.goto("productos?p=".concat(b)))):console.log(a),J({lista:!1,stock:!0});case 7:case"end":return e.stop()}}),e)}))),[M,b]);return Object(c.useEffect)((function(){var e=!0,t=new AbortController;return e&&(de(),se()),function(){e=!1,t.abort()}}),[de,se]),Object(w.jsx)(na.Provider,{value:{cargando:G,setCargando:J,showOptions:x,inputSearch:ee,setInputSearch:te,lista:ne,setLista:oe,page:b,setPage:p,limite:M,setLimite:L,buscarRegistro:le,borrarRegistro:ce,listaCategorias:X,setListaCategorias:Q,countTotal:q,setCountTotal:U,dialogs:F,setDialogs:P,getStock:ie,formStock:_,formDetalles:E,setFormDetalles:N},children:t})},ia=function(){var e=oa(),t=e.dialogs,a=e.setDialogs,r=e.cargando,n=e.formStock,o=function(){a(Object(Te.a)(Object(Te.a)({},t),{},{stock:!1}))};return Object(w.jsxs)(ze.a,{fullWidth:!0,open:t.stock,onClose:o,children:[Object(w.jsx)(qe.a,{children:n.nombre_producto}),Object(w.jsx)(Ue.a,{dividers:!0,children:Object(w.jsxs)(Z.a,{container:!0,spacing:2,children:[Object(w.jsx)(Z.a,{item:!0,xs:12,children:r.stock&&Object(w.jsx)(Be.a,{})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(Ut.a,{sx:{width:"100%",maxWidth:360,bgcolor:"background.paper"},children:n.listaStock.map((function(e,t){return Object(w.jsx)(Bt.a,{secondaryAction:Object(w.jsxs)(te.a,{variant:"button",children:[e.stock_producto_deposito," ",n.medida]}),children:Object(w.jsx)(Ht.a,{primary:e.nombre_deposito})},t)}))})})]})}),Object(w.jsx)(Ye.a,{children:Object(w.jsx)(ae.a,{variant:"outlined",onClick:o,children:"Cerrar"})})]})},sa=Object(z.a)((function(e){return{modal:{width:"100%",height:"100vh",position:"fixed",top:0,left:0,display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"#00000087",transform:"scale(1)",visibility:"visible",overflow:"hidden",zIndex:"10000",opacity:"1",transition:"opacity .2s ease, visibility .2s ease,transform .2s ease-in-out"},closeModal:{visibility:"hidden",transform:"scale(0)",opacity:"0"},imagen:{maxWidth:"100%",lineHeight:0,height:"auto",margin:"0 auto",width:"40vh",display:"block",padding:"20px 0 20px",boxSizing:"border-box",objectFit:"cover"}}})),la=function(e){var t=e.open,a=e.isClose,r=e.imgSrc,n=sa();return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)("div",{className:t?n.modal:n.closeModal,children:t&&Object(w.jsxs)("div",{children:[Object(w.jsx)("img",{className:n.imagen,src:r,alt:"..."}),Object(w.jsxs)(Pe.a,{onClick:function(){a()},children:["Cerrar ",Object(w.jsx)(ee.a,{sx:{color:"white"},children:"close"})]})]})})})},da=Object(wt.a)({root:{padding:"15px",fontSize:"0.9rem",boxShadow:"8px 7px 4px -2px rgb(0 0 0 / 20%), 0px 2px 2px 0px rgb(0 0 0 / 14%), 0px 1px 5px 0px rgb(0 0 0 / 12%)"},label:{}})(ae.a);Object(wt.a)({root:{"& .MuiInputBase-input":{fontSize:20},marginTop:10,marginBottom:10}})(Fe.a),Object(wt.a)({root:{background:"linear-gradient(31deg, #28a0ffdb 30%, #ffffff 90%)"}})(Ft.a),Object(wt.a)({root:{background:"linear-gradient(45deg, #f7670087 30%, #ffffffb3 90%)"}})(Ft.a);function ua(e){var t=Object.assign({},e);return Object(w.jsx)(da,Object(Te.a)({},t))}var ja=Object(z.a)((function(e){return{backdrop:{zIndex:e.zIndex.drawer+1,color:"#fff",backdropFilter:"blur(2px)"}}})),ba=function(){var e=ja();return Object(w.jsx)(q.a,{className:e.backdrop,open:!0,children:Object(w.jsx)(U.a,{color:"inherit"})})},pa=function(e){e.columnas;return Object(w.jsx)(re.a,{sx:{display:"flex",width:"100%",alignItems:"center",justifyContent:"center"},children:Object(w.jsx)(U.a,{})})},ma=ge.a.ExcelFile,Oa=ge.a.ExcelFile.ExcelSheet,xa=ge.a.ExcelFile.ExcelColumn,ha=function(e){var t=e.element,a=e.data,r=e.columns,n=e.sheetname,o=void 0===n?"Archivo":n,c=e.filename;e.obs;return Object(w.jsx)(ma,{filename:c,element:t||Object(w.jsx)("button",{children:"Download"}),children:Object(w.jsx)(Oa,{data:a,name:o,children:r.map((function(e,t){return Object(w.jsx)(xa,{label:e.title,value:e.field},t)}))})})},fa=Object(z.a)((function(e){var t,a;return{tableContainer:{position:"relative",overflowX:"unset",marginBottom:25,padding:5,backgroundColor:e.palette.background.paper,transition:"all 0.1s linear"},tableheader:(t={},Object(G.a)(t,e.breakpoints.down("md"),{display:"none"}),Object(G.a)(t,"position","sticky"),Object(G.a)(t,"top","63px"),Object(G.a)(t,"zIndex",10),Object(G.a)(t,"transition","all 0.2s linear"),Object(G.a)(t,"backgroundColor",e.palette.background.default),t),head:{marginBottom:"15px"},tablecell:{},tablelist:(a={},Object(G.a)(a,e.breakpoints.down("md"),{display:"flex",flexDirection:"column",margin:"0 0 10px 0",borderBottom:"1px solid silver"}),Object(G.a)(a,"borderRadius","8px"),a),tableitem:Object(G.a)({},e.breakpoints.down("md"),{display:"flex",justifyContent:"space-between"}),columname:Object(G.a)({display:"none",textTransform:"uppercase"},e.breakpoints.down("md"),{display:"block"}),bold:{fontWeight:"bold"},avatar:{backgroundColor:e.palette.primary.main,padding:25},ButtonAcciones:{margin:"0 5px"}}})),ga=function(e){var t=e.nombretabla,a=e.subtitle,n=e.columnas,o=e.filas,i=e.icono,s=e.Acciones,l=e.extraprops,d=e.namecolumnID,u=e.extra,j=e.search,b=e.cargando,p=e.showOptions,m=e.option,O=void 0===m?"opciones":m,x=e.print,h=e.exportCSV,f=e.exportPDF,g=e.exportExcel,_=e.caption,v=Object(c.useState)({src:"",open:!1}),C=Object(r.a)(v,2),k=C[0],S=C[1],y=fa(),F=Object(c.useRef)(null);if(!n)return Object(w.jsx)("h1",{children:'Falta el props "columnas"'});if(!s)return Object(w.jsx)("h1",{children:'Falta el props "Acciones"'});if(!o)return Object(w.jsx)("h1",{children:'Falta el props "Filas"'});var I=[],P=[];n.forEach((function(e){!0===e.NoPrint||(I.push({field:e.field,displayName:e.title}),P.push({label:e.title,key:e.field}))}));return Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(la,{open:k.open,isClose:function(){return S(Object(Te.a)(Object(Te.a)({},k),{},{open:!1}))},imgSrc:k.src}),Object(w.jsxs)(Z.a,{container:!0,spacing:1,justify:"space-evenly",className:y.head,children:[i&&Object(w.jsx)(Z.a,{item:!0,xs:12,md:1,zeroMinWidth:!0,children:Object(w.jsx)($.a,{variant:"rounded",className:y.avatar,children:Object(w.jsx)(ee.a,{fontSize:"large",children:i})})}),Object(w.jsxs)(Z.a,{item:!0,xs:12,sm:12,md:11,zeroMinWidth:!0,children:[Object(w.jsx)(te.a,{variant:"button",children:t}),Object(w.jsx)("br",{}),Object(w.jsx)(te.a,{variant:"caption",children:a})]}),Object(w.jsx)(Z.a,{xs:12,item:!0,sm:12,md:6,children:u&&u}),Object(w.jsx)(Z.a,{xs:12,item:!0,children:j&&j}),Object(w.jsxs)(Z.a,{xs:12,item:!0,children:[x&&Object(w.jsx)(ae.a,{className:y.ButtonAcciones,variant:"outlined",onClick:function(){Y()({printable:o,properties:I,type:"json",gridHeaderStyle:"color: red;  border: 2px solid #3971A5;",gridStyle:"border: 2px solid #3971A5;",header:'<h3 class="custom-h3">'.concat(t,"</h3>"),style:".custom-h3 { color: red; }"})},startIcon:Object(w.jsx)(ee.a,{children:"print"}),children:"Imprimir"}),h&&Object(w.jsx)(Q.CSVLink,{data:o,style:{textDecoration:"none"},headers:P,filename:ue.fechaActualDMY(),children:Object(w.jsx)(ae.a,{className:y.ButtonAcciones,startIcon:Object(w.jsx)(ee.a,{children:"text_snippet"}),variant:"outlined",children:"csv"})}),f&&Object(w.jsx)(X.a,{targetRef:F,filename:ue.fechaActualDMY(),children:function(e){var t=e.toPdf;return Object(w.jsx)(ae.a,{className:y.ButtonAcciones,variant:"outlined",startIcon:Object(w.jsx)(ee.a,{children:"picture_as_pdf"}),onClick:t,children:"PDF"})}}),g&&Object(w.jsx)(ha,{columns:n,data:o,sheetname:t,filename:t+ue.fechaActualDMY(),element:Object(w.jsx)(ae.a,{variant:"outlined",startIcon:Object(w.jsx)(ee.a,{children:"file_download"}),children:"Excel"})})]})]}),b?Object(w.jsx)(pa,{columnas:n}):o.length>0?Object(w.jsx)(re.a,{boxShadow:2,borderRadius:3,children:Object(w.jsx)(ne.a,{id:"table_print",ref:F,className:y.tableContainer,children:Object(w.jsxs)(oe.a,{children:[Object(w.jsx)("caption",{children:Object(w.jsxs)("b",{children:[" ",_||t," "]})}),Object(w.jsx)(ce.a,{className:y.tableheader,children:Object(w.jsxs)(ie.a,{children:[n.map((function(e,t){return Object(w.jsx)(se.a,{className:y.tablecell,align:"center",children:Object(w.jsx)(te.a,{variant:"overline",className:y.bold,children:e.title})},t)})),Object(w.jsx)(se.a,{align:"center",className:y.tablecell,children:Object(w.jsx)(te.a,{variant:"overline",className:y.bold,children:O})})]})}),Object(w.jsx)(le.a,{children:o.map((function(e,t){return Object(w.jsxs)(ie.a,{role:"checkbox",hover:!0,className:y.tablelist,children:[n.map((function(t,a){return Object(w.jsxs)(se.a,{className:y.tableitem,align:t.align?t.align:"center",children:[Object(w.jsxs)("span",{className:y.columname,children:[t.title,":"," "]}),Object(w.jsxs)("span",{style:t.style?t.style:t.styleCondicion?t.styleCondicion[e[t.comparaItem]]:null,children:[t.isNumber?ue.numberSeparator(e[t.field]):t.extra?t.extra:t.items?t.items[e[t.comparaItem]]:t.isDate?ue.fechaActualDMY(e[t.field]):t.img?Object(w.jsx)($.a,{sx:{width:56,height:56,cursor:"pointer"},onClick:function(){var a;a=e[t.field],S({open:!0,src:a})},src:e[t.field],alt:"img"}):e[t.field],t.extraitem&&t.extraitem]})]},a)})),Object(w.jsx)(se.a,{align:"center",children:p&&Object(w.jsx)(s,{filaProps:e,id:e[d],extraprops:e[l]})})]},e[d]?e[d]:t)}))})]})})}):Object(w.jsx)(de.a,{icon:Object(w.jsx)(ee.a,{children:"block"}),severity:"warning",children:Object(w.jsx)(te.a,{variant:"body1",children:"No hay registros"})})]})},_a=function(){var e=oa(),t=e.dialogs,a=e.setDialogs,n=e.formDetalles,o=Object(c.useState)(!1),i=Object(r.a)(o,2),s=i[0],u=i[1],j=Object(c.useState)({url_imagen:""}),b=Object(r.a)(j,2),p=b[0],m=b[1],O=Object(c.useCallback)(Object(d.a)(l.a.mark((function e(){var r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u(!0),!t.imagen){e.next=6;break}return e.next=4,k.get({table:"productos_images",where:"id_image_producto,=,".concat(n.id_producto,",and,portada_imagen_producto,=,1")});case 4:(r=e.sent).found>0&&"ok"===r.response?m(r.results[0]):(a({detalles:!1,code:!1,imagen:!1,stock:!1}),y()({text:"Producto sin imagen",icon:"warning",timer:1300}));case 6:u(!1);case 7:case"end":return e.stop()}}),e)}))),[t,n,a]);Object(c.useEffect)((function(){O()}),[O]);return s?Object(w.jsx)(ba,{}):t.imagen&&Object(w.jsx)(la,{open:t.imagen,isClose:function(){a(Object(Te.a)(Object(Te.a)({},t),{},{imagen:!1}))},imgSrc:p.url_imagen})},va=function(){var e=oa(),t=e.page,a=e.setPage,r=e.limite,n=e.countTotal;return e.cargando?Object(w.jsx)(w.Fragment,{}):Object(w.jsxs)(we.a,{direction:"row",justifyContent:"center",spacing:2,children:[t>0&&Object(w.jsx)(ae.a,{onClick:function(){if(t>0){var e=parseInt(t)-parseInt(r);a(e)}},variant:"outlined",children:"Atr\xe1s"}),n>t&&t+r<n&&Object(w.jsx)(ae.a,{variant:"outlined",onClick:function(){var e=parseInt(t)+parseInt(r);a(e)},children:"Siguiente"})]})};function Ca(e){e.borrar,e.abrir;var t=e.filaProps,a=Object(c.useRef)(null),n=Object(c.useState)(!1),o=Object(r.a)(n,2),i=o[0],s=o[1],l=oa(),d=l.borrarRegistro,u=l.page,j=l.getStock,b=l.dialogs,p=l.setDialogs,O=Object(H.g)(),x=t.id_producto,h=function(){s(!1)};return Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(De.a,{size:"small",ref:a,onClick:function(){return s(!0)},children:Object(w.jsx)(ee.a,{color:"info",children:"more_horiz"})}),Object(w.jsxs)(qt.a,{open:i,anchorEl:a.current,onClose:h,PaperProps:{sx:{width:200,maxWidth:"100%"}},anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},children:[Object(w.jsxs)(Je.a,{onClick:function(){p(Object(Te.a)(Object(Te.a)({},b),{},{stock:!0})),j(t),h()},children:[Object(w.jsx)(Vt.a,{children:Object(w.jsx)(ee.a,{color:"success",children:"inventory"})}),Object(w.jsx)(Ht.a,{primary:"Stock",primaryTypographyProps:{variant:"body2"}})]}),Object(w.jsxs)(Je.a,{onClick:function(){return O("".concat(m,"/productos/new/").concat(x),{state:{page:u}})},sx:{color:"text.secondary"},children:[Object(w.jsx)(Vt.a,{children:Object(w.jsx)(ee.a,{color:"primary",children:"mode_edit"})}),Object(w.jsx)(Ht.a,{primary:"Editar",primaryTypographyProps:{variant:"body2"}})]}),Object(w.jsxs)(Je.a,{onClick:function(){Et.goto("productos/bc?code=".concat(t.codigo_producto))},sx:{color:"text.secondary"},children:[Object(w.jsx)(Vt.a,{children:Object(w.jsx)(ee.a,{color:"secondary",children:"qr_code"})}),Object(w.jsx)(Ht.a,{primary:"C\xf3digo de barras",primaryTypographyProps:{variant:"body2"}})]}),Object(w.jsxs)(Je.a,{onClick:function(){d(t.id_producto,t.nombre_producto)},sx:{color:"text.secondary"},children:[Object(w.jsx)(Vt.a,{children:Object(w.jsx)(ee.a,{color:"error",children:"delete_sweep"})}),Object(w.jsx)(Ht.a,{primary:"Borrar",primaryTypographyProps:{variant:"body2"}})]})]})]})}var ka=function(){var e=bt().lang,t=oa(),a=t.inputSearch,r=t.showOptions,n=t.setInputSearch,o=t.cargando,c=t.lista,i=t.buscarRegistro,s=t.dialogs,l=t.setDialogs,d=t.setFormDetalles,u=[{field:"codigo_producto",title:"Codigo"},{field:"nombre_producto",title:"Nombre"},{field:"nombre_categoria",title:e.Categor\u00eda,style:{backgroundColor:"#3f51b591",padding:"2px",borderRadius:"5px",cursor:"pointer"},styleCondicion:"",NoPrint:!0},{field:"precio_producto",title:"Precio",isNumber:!0}],j=function(e){l(Object(Te.a)(Object(Te.a)({},s),{},{imagen:!0})),d(e)},b=Object(w.jsxs)(we.a,{direction:"row",spacing:2,children:[Object(w.jsx)(Fe.a,{InputProps:{endAdornment:Object(w.jsx)(Ie.a,{position:"end",children:Object(w.jsx)(Pe.a,{onClick:function(){i()},children:Object(w.jsx)(ee.a,{children:"search"})})})},onKeyPress:function(e){"Enter"===e.key&&i()},onChange:function(e){return n(e.target.value)},variant:"outlined",label:"Buscar"}),Object(w.jsx)(Ae.a,{title:"AGREGAR NUEVO",arrow:!0,children:Object(w.jsx)(ae.a,{color:"primary",variant:"outlined",size:"large",onClick:function(){return ue.goto("productos/new")},children:"AGREGAR"})})]}),p=c.filter((function(e){return e.nombre_producto.toLowerCase().includes(a.toLowerCase())||e.codigo_producto.toLowerCase().includes(a.toLowerCase())}));return Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(ga,{nombretabla:"Productos - Servicios",subtitle:"En el m\xf3dulo PRODUCTOS podr\xe1 agregar nuevos productos al sistema, actualizar datos de los productos, eliminar o actualizar la imagen de los productos, imprimir c\xf3digos de barras de cada producto, buscar productos en el sistema, ver todos los productos en almac\xe9n, ver los productos m\xe1s vendido y filtrar productos por categor\xeda.",icono:"inventory",bgicono:"#3f51b5",namecolumnID:"id_producto",columnas:u,filas:p,Acciones:function(e){var t=e.filaProps;return Object(w.jsxs)(we.a,{direction:"row",spacing:1,justifyContent:"center",children:[Object(w.jsx)(De.a,{onClick:function(){j(t)},size:"small",children:Object(w.jsx)(ee.a,{color:"error",children:"image"})}),Object(w.jsx)(Ca,{openPhoto:j,filaProps:t})]})},extraprops:"nombre_producto",search:b,cargando:o.lista,option:e.Opciones,showOptions:r,print:!0,exportExcel:!0}),Object(w.jsx)(va,{})]})},Sa=function(){return Object(w.jsxs)(ca,{children:[Object(w.jsx)(ka,{}),Object(w.jsx)(_a,{}),Object(w.jsx)(ia,{})]})},ya=Object(c.createContext)();var wa=function(){var e=Object(c.useContext)(ya),t=e.token_user,a=e.cargas,r=e.listas,n=e.setearListas,o=e.tabValue,i=e.setTabValue,s=e.formulario,l=e.setFormulario,d=e.change,u=e.sendForm,j=e.inputCodigo,b=e.inputNombre,p=e.setImagesURL,m=e.imagesURL,O=e.generateCode;return{token_user:t,cargas:a,listas:r,setearListas:n,tabValue:o,setTabValue:i,formulario:s,setFormulario:l,change:d,sendForm:u,inputCodigo:j,inputNombre:b,snack:e.snack,setImagesURL:p,imagesURL:m,generateCode:O,setSnack:e.setSnack,verificarProducto:e.verificarProducto,changeCheck:e.changeCheck,reiniciarTodo:e.reiniciarTodo,images:e.images,setImages:e.setImages,dialogs:e.dialogs,setDialogs:e.setDialogs,enviado:e.enviado,stock:e.stock,setStock:e.setStock,cargarStock:e.cargarStock,borrarStock:e.borrarStock}},Fa=function(e){var t=function(){var e=Object(H.f)().search;return i.a.useMemo((function(){return new URLSearchParams(e)}),[e])}().get("codigo")||"",a=JSON.parse(localStorage.getItem("dataProductos")),n=Object(c.useState)({categorias:!1,proveedores:!1,marcas:!1,depositos:!1,unidades:!1}),o=Object(r.a)(n,2),s=o[0],u=o[1],j=I().token_user,b=Object(c.useState)(0),p=Object(r.a)(b,2),m=p[0],O=p[1],x=Object(c.useState)({main:!0,imagen:!1,guardar:!1}),h=Object(r.a)(x,2),f=h[0],g=h[1],_=Object(c.useState)({open:!1,mensaje:"",severity:"success",id:""}),v=Object(r.a)(_,2),C=v[0],S=v[1],y=Object(c.useState)(!1),F=Object(r.a)(y,2),P=F[0],A=F[1],D=Object(c.useRef)(null),E=Object(c.useRef)(null),N=Object(c.useRef)(null),T={id_categoria_producto:"",id_proveedor_producto:"",id_marca_producto:"",id_impuesto_producto:"",id_unidad_medida_producto:"",id_deposito_producto:"",codigo_producto:t,nombre_producto:"",descripcion_producto:"",costo_producto:"0",precio_producto:"0",preciom_producto:"0",minimo_producto:"0",porcentaje_comision:"0",stock_producto:"0",notificar_producto:"0",tipo_producto:"1",disponible_producto:"1"},R=Object(c.useState)([]),M=Object(r.a)(R,2),L=M[0],W=M[1],z=Object(c.useState)(T),q=Object(r.a)(z,2),U=q[0],B=q[1],V=Object(c.useState)([]),J=Object(r.a)(V,2),Y=J[0],K=J[1],X=Object(c.useState)([]),Q=Object(r.a)(X,2),Z=Q[0],$=Q[1],ee={medidas:(null===a||void 0===a?void 0:a.medidas)||[],categorias:(null===a||void 0===a?void 0:a.categorias)||[],marcas:(null===a||void 0===a?void 0:a.marcas)||[],proveedores:(null===a||void 0===a?void 0:a.proveedores)||[],impuestos:(null===a||void 0===a?void 0:a.impuestos)||[],depositos:(null===a||void 0===a?void 0:a.depositos)||[]},te=Object(c.useState)(ee),ae=Object(r.a)(te,2),re=ae[0],ne=ae[1],oe=function(){var e=Object(d.a)(l.a.mark((function e(t){var a,r,n,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(A(!0),t.preventDefault(),""!==(a=Object(Te.a)({},U)).codigo_producto){e.next=7;break}return O(0),S({open:!0,severity:"warning",mensaje:"Rellene el c\xf3digo",id:"codigo_producto"}),e.abrupt("return",!1);case 7:if(""!==a.nombre_producto){e.next=12;break}return O(0),S({open:!0,severity:"warning",mensaje:"Rellene el nombre del producto",id:"nombre_producto"}),null===N||void 0===N||null===(r=N.current)||void 0===r||r.focus(),e.abrupt("return",!1);case 12:if(""!==a.id_categoria_producto&&""!==a.id_impuesto_producto&&""!==a.id_marca_producto&&""!==a.id_proveedor_producto&&""!==a.id_unidad_medida_producto){e.next=16;break}return O(0),S({open:!0,severity:"warning",mensaje:"Rellene todos los campos",id:"3"}),e.abrupt("return",!1);case 16:return g(Object(Te.a)(Object(Te.a)({},f),{},{guardar:!0})),delete a.stock_producto,delete a.id_deposito_producto,e.next=21,k.insert({table:"productos",data:a,token:j});case 21:"ok"===(n=e.sent).response?(Y.length>0&&(o="1",Y.forEach((function(e){var t={id_image_producto:n.last_id,image_name:e.name,portada_imagen_producto:o};k.uploadImage({table:"productos_images",file:e,data:t,token:j,path:n.last_id}),o="0"}))),"1"===a.tipo_producto&&L.forEach((function(e){var t={id_producto_deposito:n.last_id,id_deposito_deposito:e.id_deposito_deposito,stock_producto_deposito:e.stock_producto_deposito};k.insert({table:"productos_depositos",token:j,data:t})})),S({open:!0,mensaje:"Guardado correctamente",severity:"success"}),ce()):console.log(n);case 23:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ce=function(){var e;O(0),W([]),B(T),K([]),$([]),g(Object(Te.a)(Object(Te.a)({},f),{},{guardar:!1})),null===D||void 0===D||null===(e=D.current)||void 0===e||e.focus()},ie=function(){var e=Object(d.a)(l.a.mark((function e(t){var a,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.target.value,S({open:!1,mensaje:"",severity:"error"}),""===a){e.next=7;break}return e.next=5,k.get({table:"productos",where:"codigo_producto,=,'".concat(a,"'")});case 5:e.sent.found>0?(S({open:!0,mensaje:"Ese c\xf3digo de producto o servicio ya existe.",severity:"error",id:"codigo_producto"}),O(0),null===(r=D.current)||void 0===r||r.focus()):S({open:!1,mensaje:"",severity:"error"});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),se=function(e){ne(e),localStorage.setItem("dataProductos",JSON.stringify(e))},le=Object(c.useCallback)(Object(d.a)(l.a.mark((function e(){var t,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==localStorage.getItem("dataProductos")){e.next=7;break}return e.next=4,Promise.all([k.getPromise({table:"categorias",fields:"id_categoria,nombre_categoria,id_padre_categoria",sort:"-nombre_categoria"}),k.getPromise({table:"proveedors",fields:"id_proveedor,nombre_proveedor"}),k.getPromise({table:"marcas",fields:"id_marca,nombre_marca"}),k.getPromise({table:"unidad_medidas"}),k.getPromise({table:"impuestos"}),k.getPromise({table:"depositos",sort:"-id_deposito",where:"tipo_deposito,=,1"})]);case 4:t=e.sent,a={categorias:t[0].results,proveedores:t[1].results,marcas:t[2].results,medidas:t[3].results,impuestos:t[4].results,depositos:t[5].results},se(a);case 7:g({main:!1,imagen:!1,guardar:!1});case 8:case"end":return e.stop()}}),e)}))),[]);return Object(c.useEffect)((function(){var e=!0,t=new AbortController;return e&&le(),function(){e=!1,t.abort()}}),[le]),Object(w.jsx)(ya.Provider,{value:{token_user:j,cargas:f,listas:re,setearListas:se,tabValue:m,setTabValue:O,formulario:U,setFormulario:B,change:function(e){var t=e.target,a=t.name,r=t.value;B(Object(Te.a)(Object(Te.a)({},U),{},Object(G.a)({},a,r)))},sendForm:oe,inputCodigo:D,inputNombre:N,setImagesURL:$,imagesURL:Z,generateCode:function(){var e=Math.random().toString(36).slice(2);B(Object(Te.a)(Object(Te.a)({},U),{},{codigo_producto:e})),N.current.focus()},snack:C,setSnack:S,verificarProducto:ie,changeCheck:function(e){var t=e.target,a=t.checked,r=t.name;B(Object(Te.a)(Object(Te.a)({},U),{},Object(G.a)({},r,a?"1":"0")))},reiniciarTodo:ce,images:Y,setImages:K,dialogs:s,setDialogs:u,enviado:P,stock:L,setStock:W,cargarStock:function(){var e,t=Object(Te.a)({},U),a=Object(Qe.a)(L);if(""===t.id_deposito_producto)return S({open:!0,mensaje:"Elija correctamente el deposito",severity:"error"}),!1;var r,n=a.findIndex((function(e){return e.id_deposito_deposito===t.id_deposito_producto}));if(n>=0)r=parseFloat(a[n].stock_producto_deposito)+parseFloat(t.stock_producto),a[n].stock_producto_deposito=r;else{r=parseFloat(t.stock_producto);var o=t.id_deposito_producto,c=re.depositos.findIndex((function(e){return e.id_deposito===o})),i=re.depositos[c].nombre_deposito;a.push({id_deposito_deposito:o,stock_producto_deposito:r,nombre:i})}t.id_deposito_producto="",t.stock_producto="0",B(t),W(a),null===(e=E.current)||void 0===e||e.focus()},borrarStock:function(e){var t,a=Object(Qe.a)(L);a.splice(e,1),W(a),null===E||void 0===E||null===(t=E.current)||void 0===t||t.focus()}},children:e.children})},Ia=function(){var e=wa(),t=e.dialogs,a=e.setDialogs,n=e.listas,o=e.setearListas,c=e.token_user,s=e.formulario,u=e.setFormulario,j=i.a.useRef(null),b=i.a.useState(!1),p=Object(r.a)(b,2),m=p[0],O=p[1],x=function(){return a(Object(Te.a)(Object(Te.a)({},t),{},{categorias:!1}))},h=function(){var e=Object(d.a)(l.a.mark((function e(){var t,a,r,i,d;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(O(!0),t=Object(Te.a)({},n),a=Object(Te.a)({},s),""===(r=j.current.value)){e.next=9;break}return e.next=7,k.insert({table:"categorias",data:{nombre_categoria:r},token:c});case 7:"ok"===(i=e.sent).response&&(d={id_categoria:i.last_id,nombre_categoria:r},t.categorias.push(d),a.id_categoria_producto=i.last_id,o(t),u(a));case 9:x(),O(!1);case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(w.jsxs)(ze.a,{open:t.categorias,fullWidth:!0,onClose:x,children:[Object(w.jsx)(qe.a,{children:"Nueva categor\xeda"}),Object(w.jsx)(Ue.a,{children:Object(w.jsxs)(Z.a,{container:!0,spacing:2,children:[Object(w.jsxs)(Z.a,{item:!0,xs:12,children:[" ",m&&Object(w.jsx)(Be.a,{})]}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(Fe.a,{required:!0,autoFocus:!0,autoComplete:"off",inputRef:j,fullWidth:!0,label:"Nombre de categoria"})})]})}),Object(w.jsxs)(Ye.a,{children:[Object(w.jsx)(ae.a,{variant:"outlined",onClick:h,children:"Guardar"}),Object(w.jsx)(ae.a,{variant:"outlined",onClick:x,children:"Cerrar"})]})]})};var Pa=function(){var e=wa(),t=e.dialogs,a=e.setDialogs,n=e.listas,o=e.setearListas,c=e.token_user,s=e.formulario,u=e.setFormulario,j=i.a.useRef(null),b=i.a.useState(!1),p=Object(r.a)(b,2),m=p[0],O=p[1],x=function(){return a(Object(Te.a)(Object(Te.a)({},t),{},{depositos:!1}))},h=function(){var e=Object(d.a)(l.a.mark((function e(){var t,a,r,i,d;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(O(!0),t=Object(Te.a)({},n),a=Object(Te.a)({},s),""===(r=j.current.value)){e.next=9;break}return e.next=7,k.insert({table:"depositos",data:{nombre_deposito:r},token:c});case 7:"ok"===(i=e.sent).response&&(d={id_deposito:i.last_id,nombre_deposito:r},t.depositos.push(d),a.id_deposito_producto=i.last_id,o(t),u(a));case 9:x(),O(!1);case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(w.jsxs)(ze.a,{open:t.depositos,fullWidth:!0,onClose:x,children:[Object(w.jsx)(qe.a,{children:"Nuevo dep\xf3sito"}),Object(w.jsx)(Ue.a,{children:Object(w.jsxs)(Z.a,{container:!0,spacing:2,children:[Object(w.jsxs)(Z.a,{item:!0,xs:12,children:[" ",m&&Object(w.jsx)(Be.a,{})]}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(Fe.a,{required:!0,autoFocus:!0,autoComplete:"off",inputRef:j,fullWidth:!0,label:"Nombre de marca"})})]})}),Object(w.jsxs)(Ye.a,{children:[Object(w.jsx)(ae.a,{variant:"outlined",onClick:h,children:"Guardar"}),Object(w.jsx)(ae.a,{variant:"outlined",onClick:x,children:"Cerrar"})]})]})},Aa=function(){var e=wa(),t=e.dialogs,a=e.setDialogs,n=e.listas,o=e.setearListas,c=e.token_user,s=e.formulario,u=e.setFormulario,j=i.a.useRef(null),b=i.a.useState(!1),p=Object(r.a)(b,2),m=p[0],O=p[1],x=function(){return a(Object(Te.a)(Object(Te.a)({},t),{},{marcas:!1}))},h=function(){var e=Object(d.a)(l.a.mark((function e(){var t,a,r,i,d;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(O(!0),t=Object(Te.a)({},n),a=Object(Te.a)({},s),""===(r=j.current.value)||null===r){e.next=9;break}return e.next=7,k.insert({table:"marcas",data:{nombre_marca:r},token:c});case 7:"ok"===(i=e.sent).response?(d={id_marca:i.last_id,nombre_marca:r},t.marcas.push(d),a.id_marca_producto=i.last_id,o(t),u(a)):console.log(i);case 9:x(),O(!1);case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(w.jsxs)(ze.a,{open:t.marcas,fullWidth:!0,onClose:x,children:[Object(w.jsx)(qe.a,{children:"Nueva Marca"}),Object(w.jsx)(Ue.a,{children:Object(w.jsxs)(Z.a,{container:!0,spacing:2,children:[Object(w.jsxs)(Z.a,{item:!0,xs:12,children:[" ",m&&Object(w.jsx)(Be.a,{})]}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(Fe.a,{required:!0,autoFocus:!0,autoComplete:"off",inputRef:j,fullWidth:!0,label:"Nombre de marca"})})]})}),Object(w.jsxs)(Ye.a,{children:[Object(w.jsx)(ae.a,{variant:"outlined",onClick:h,children:"Guardar"}),Object(w.jsx)(ae.a,{variant:"outlined",onClick:x,children:"Cerrar"})]})]})},Da=function(){var e=wa(),t=e.dialogs,a=e.setDialogs,n=e.listas,o=e.setearListas,c=e.token_user,s=e.formulario,u=e.setFormulario,j=i.a.useRef(null),b=i.a.useRef(null),p=i.a.useState(!1),m=Object(r.a)(p,2),O=m[0],x=m[1],h=function(){return a(Object(Te.a)(Object(Te.a)({},t),{},{proveedores:!1}))},f=function(){var e=Object(d.a)(l.a.mark((function e(){var t,a,r,i,d,p;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(x(!0),t=Object(Te.a)({},n),a=Object(Te.a)({},s),r=j.current.value,i=b.current.value,""===r||""===i||null===i||null===r){e.next=10;break}return e.next=8,k.insert({table:"proveedors",data:{nombre_proveedor:r,ruc_proveedor:i,telefono_proveedor:"0"},token:c});case 8:"ok"===(d=e.sent).response?(p={id_proveedor:d.last_id,nombre_proveedor:r},t.proveedores.push(p),a.id_proveedor_producto=d.last_id,o(t),u(a)):console.log(d);case 10:h(),x(!1);case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(w.jsxs)(ze.a,{open:t.proveedores,fullWidth:!0,onClose:h,children:[Object(w.jsx)(qe.a,{children:"Nuevo Proveedor"}),Object(w.jsx)(Ue.a,{children:Object(w.jsxs)(Z.a,{container:!0,spacing:2,children:[Object(w.jsxs)(Z.a,{item:!0,xs:12,children:[" ",O&&Object(w.jsx)(Be.a,{})]}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(Fe.a,{required:!0,autoFocus:!0,autoComplete:"off",inputRef:j,fullWidth:!0,label:"Nombre de proveedor"})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(Fe.a,{required:!0,autoComplete:"off",inputRef:b,fullWidth:!0,label:"Doc de proveedor"})})]})}),Object(w.jsxs)(Ye.a,{children:[Object(w.jsx)(ae.a,{variant:"outlined",onClick:f,children:"Guardar"}),Object(w.jsx)(ae.a,{variant:"outlined",onClick:h,children:"Cerrar"})]})]})},Ea=a(833),Na=a(825),Ta=a(879),Ra=a(820),Ma=function(){var e=wa(),t=e.listas,a=e.dialogs,r=e.setDialogs,n=e.formulario,o=e.change,c=e.inputCodigo,i=e.verificarProducto,s=e.cargas,l=e.snack,d=e.inputNombre,u=e.generateCode;return Object(w.jsxs)(Z.a,{container:!0,spacing:2,alignItems:"center",children:[Object(w.jsx)(Z.a,{item:!0,xs:12,sm:12,md:6,children:Object(w.jsx)(Fe.a,{required:!0,autoFocus:!0,error:"codigo_producto"===l.id,disabled:s.guardar,inputRef:c,onChange:o,value:n.codigo_producto,onBlur:i,label:"C\xf3digo",autoComplete:"off",name:"codigo_producto",InputProps:{startAdornment:Object(w.jsx)(Ie.a,{position:"start",children:Object(w.jsx)(ee.a,{color:"primary",children:"qr_code"})})},fullWidth:!0,variant:"outlined"})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:12,md:3,children:Object(w.jsx)(ae.a,{variant:"outlined",size:"large",onClick:u,children:"Generar c\xf3digo"})}),Object(w.jsxs)(Z.a,{item:!0,xs:12,sm:12,md:3,children:[Object(w.jsx)(rt.a,{component:"legend",children:"Tipo:"}),Object(w.jsx)(ot.a,{value:"1",control:Object(w.jsx)(ct.a,{name:"tipo_producto",checked:"1"===n.tipo_producto,onChange:o,color:"primary"}),label:"Art\xedculo",labelPlacement:"end"}),Object(w.jsx)(ot.a,{value:"2",control:Object(w.jsx)(ct.a,{name:"tipo_producto",checked:"2"===n.tipo_producto,onChange:o,color:"primary"}),label:"Servicio",labelPlacement:"end"})]}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(te.a,{variant:"button",children:"INFORMACION DE PRODUCTO"})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:12,md:4,children:Object(w.jsx)(Fe.a,{required:!0,error:"nombre_producto"===l.id,disabled:s.guardar,onChange:o,inputRef:d,label:"Nombre",autoComplete:"off",name:"nombre_producto",value:n.nombre_producto,InputProps:{startAdornment:Object(w.jsx)(Ie.a,{position:"start",children:Object(w.jsx)(ee.a,{color:"action",children:"inventory_2"})})},fullWidth:!0})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:12,md:8,children:Object(w.jsx)(Fe.a,{onChange:o,autoComplete:"off",name:"descripcion_producto",value:n.descripcion_producto,label:"Descripci\xf3n detallada",fullWidth:!0})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:12,md:4,children:Object(w.jsxs)(Ve.a,{fullWidth:!0,children:[Object(w.jsx)(He.a,{variant:"outlined",children:"Impuesto"}),Object(w.jsx)(Ge.a,{required:!0,name:"id_impuesto_producto",value:n.id_impuesto_producto,onChange:o,variant:"outlined",children:t.impuestos.map((function(e){return Object(w.jsx)(Je.a,{value:e.id_impuesto,children:e.nombre_impuesto},e.id_impuesto)}))})]})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:12,md:4,children:Object(w.jsxs)(Ve.a,{fullWidth:!0,children:[Object(w.jsx)(He.a,{variant:"outlined",children:"Seleccionar proveedor"}),Object(w.jsxs)(Ge.a,{name:"id_proveedor_producto",value:n.id_proveedor_producto,onChange:o,variant:"outlined",required:!0,children:[t.proveedores.map((function(e){return Object(w.jsx)(Je.a,{value:e.id_proveedor,children:e.nombre_proveedor},e.id_proveedor)})),Object(w.jsx)(Ut.a,{children:Object(w.jsxs)(Ra.a,{onClick:function(){return r(Object(Te.a)(Object(Te.a)({},a),{},{proveedores:!0}))},children:[Object(w.jsx)(Vt.a,{children:Object(w.jsx)(ee.a,{children:"add"})}),Object(w.jsx)(Ht.a,{primary:"Agregar proveedor"})]})})]})]})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:12,md:4,children:Object(w.jsxs)(Ve.a,{fullWidth:!0,children:[Object(w.jsx)(He.a,{variant:"outlined",children:"Selecccionar categor\xeda"}),Object(w.jsxs)(Ge.a,{required:!0,name:"id_categoria_producto",value:n.id_categoria_producto,onChange:o,variant:"outlined",children:[t.categorias.map((function(e){return Object(w.jsx)(Je.a,{value:e.id_categoria,children:e.nombre_categoria},e.id_categoria)})),Object(w.jsx)(Ut.a,{children:Object(w.jsxs)(Ra.a,{onClick:function(){return r(Object(Te.a)(Object(Te.a)({},a),{},{categorias:!0}))},children:[Object(w.jsx)(Vt.a,{children:Object(w.jsx)(ee.a,{children:"add"})}),Object(w.jsx)(Ht.a,{primary:"Agregar nueva categor\xeda"})]})})]})]})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:12,md:4,children:Object(w.jsxs)(Ve.a,{fullWidth:!0,children:[Object(w.jsx)(He.a,{variant:"outlined",children:"Marca"}),Object(w.jsxs)(Ge.a,{required:!0,name:"id_marca_producto",value:n.id_marca_producto,onChange:o,variant:"outlined",fullWidth:!0,children:[t.marcas.map((function(e){return Object(w.jsx)(Je.a,{value:e.id_marca,children:e.nombre_marca},e.id_marca)})),Object(w.jsx)(Ut.a,{children:Object(w.jsxs)(Ra.a,{onClick:function(){return r(Object(Te.a)(Object(Te.a)({},a),{},{marcas:!0}))},children:[Object(w.jsx)(Vt.a,{children:Object(w.jsx)(ee.a,{children:"add"})}),Object(w.jsx)(Ht.a,{primary:"Agregar nueva marca"})]})})]})]})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:12,md:4,children:Object(w.jsxs)(Ve.a,{fullWidth:!0,children:[Object(w.jsx)(He.a,{variant:"outlined",children:"Unidad de medida"}),Object(w.jsxs)(Ge.a,{name:"id_unidad_medida_producto",value:n.id_unidad_medida_producto,onChange:o,variant:"outlined",required:!0,children:[t.medidas.map((function(e){return Object(w.jsx)(Je.a,{value:e.id_unidad_medida,children:e.descripcion_medida},e.id_unidad_medida)})),Object(w.jsx)(Ut.a,{children:Object(w.jsxs)(Ra.a,{children:[Object(w.jsx)(Vt.a,{children:Object(w.jsx)(ee.a,{children:"add"})}),Object(w.jsx)(Ht.a,{primary:"Agregar nueva medida"})]})})]})]})})]})},La=function(){var e=wa(),t=e.setImages,a=e.imagesURL,r=e.setImagesURL,n=e.images;return Object(w.jsxs)(Z.a,{container:!0,spacing:2,children:[Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)("div",{children:Object(w.jsxs)("label",{htmlFor:"btn-upload",children:[Object(w.jsx)("input",{id:"btn-upload",name:"btn-upload",style:{display:"none"},type:"file",onChange:function(e){var o=[],c=Object(Qe.a)(n),i=Object(Qe.a)(a);o.push(e.target.files);for(var s=0;s<o[0].length;s++)i.push(URL.createObjectURL(o[0][s])),c.push(o[0][s]);t(c),r(i)},multiple:!0,accept:"image/jpeg, image/png"}),Object(w.jsx)(ae.a,{startIcon:Object(w.jsx)(ee.a,{children:"image"}),variant:"outlined",component:"span",children:"Agregar imagen"})]})})}),Object(w.jsx)(Z.a,{item:!0,children:Object(w.jsx)("div",{style:{display:"flex",flexWrap:"wrap",flexDirection:"row",gap:"10px",justifyContent:"center"},children:(a||[]).map((function(e,o){return Object(w.jsxs)(we.a,{direction:"column",sx:{padding:"5px",border:"1px solid whitesmoke",borderRadius:"3px"},children:[Object(w.jsx)($.a,{variant:"square",alt:"...",src:e,sx:{width:256,height:256}}),Object(w.jsx)(Ae.a,{title:"Borrar imagen",children:Object(w.jsx)(Pe.a,{onClick:function(){return function(e){var o=Object(Qe.a)(n),c=Object(Qe.a)(a);o.splice(e,1),c.splice(e,1),t(o),r(c)}(o)},children:Object(w.jsx)(ee.a,{children:"delete"})})})]},o)}))})})]})},Wa=a(878),za=a(832),qa=a(389),Ua=a(379),Ba=["onChange"],Va=i.a.forwardRef((function(e,t){var a=e.onChange,r=Object(qa.a)(e,Ba);return Object(w.jsx)(Ua.a,Object(Te.a)(Object(Te.a)({},r),{},{getInputRef:t,onValueChange:function(t){a({target:{name:e.name,value:t.value}})},thousandSeparator:".",decimalSeparator:",",isNumericString:!0}))})),Ha=function(){var e=wa(),t=e.change,a=e.formulario,r=e.changeCheck,n=e.listas,o=e.dialogs,c=e.setDialogs,i=e.cargarStock,s=e.cantidadRef,l=e.stock,d=e.borrarStock;return Object(w.jsxs)(Z.a,{container:!0,spacing:2,alignItems:"center",children:[Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(te.a,{variant:"button",children:"PRECIOS"})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:12,md:3,children:Object(w.jsx)(Fe.a,{onChange:t,fullWidth:!0,autoFocus:!0,label:"Costo",disabled:"2"===a.tipo_producto,autoComplete:"off",name:"costo_producto",value:a.costo_producto,InputProps:{startAdornment:Object(w.jsx)(Ie.a,{position:"start",children:Object(w.jsx)(ee.a,{style:{color:"#ffa501"},children:"attach_money"})}),inputProps:{min:0},inputComponent:Va},variant:"outlined",error:!1,helperText:"Costo del producto"})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:12,md:3,children:Object(w.jsx)(Fe.a,{fullWidth:!0,onChange:t,label:"Precio",autoComplete:"off",name:"precio_producto",value:a.precio_producto,InputProps:{startAdornment:Object(w.jsx)(Ie.a,{position:"start",children:Object(w.jsx)(ee.a,{color:"primary",children:"point_of_sale"})}),inputProps:{min:0},inputComponent:Va},variant:"outlined",error:!1,helperText:"Precio del producto"})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:12,md:3,children:Object(w.jsx)(Fe.a,{fullWidth:!0,onChange:t,label:"Precio Mayorista",autoComplete:"off",name:"preciom_producto",value:a.preciom_producto,InputProps:{startAdornment:Object(w.jsx)(Ie.a,{position:"start",children:Object(w.jsx)(ee.a,{color:"primary",children:"point_of_sale"})}),inputProps:{min:0},inputComponent:Va},variant:"outlined",error:!1,helperText:"Precio margen descuento"})}),"1"===a.tipo_producto&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(te.a,{variant:"button",children:"STOCK"})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:12,md:4,children:Object(w.jsx)(Fe.a,{fullWidth:!0,inputRef:s,onChange:t,label:"Cantidad actual",autoComplete:"off",name:"stock_producto",value:a.stock_producto,InputProps:{startAdornment:Object(w.jsx)(Ie.a,{position:"start",children:Object(w.jsx)(ee.a,{color:"secondary",children:"inventory_2"})}),inputProps:{min:0},inputComponent:Va},variant:"outlined"})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:12,md:4,children:Object(w.jsxs)(Ve.a,{fullWidth:!0,children:[Object(w.jsx)(He.a,{variant:"outlined",children:"Almacenado en dep\xf3sito"}),Object(w.jsxs)(Ge.a,{name:"id_deposito_producto",value:a.id_deposito_producto,onChange:t,children:[n.depositos.map((function(e){return Object(w.jsx)(Je.a,{value:e.id_deposito,children:e.nombre_deposito},e.id_deposito)})),Object(w.jsx)(Ut.a,{children:Object(w.jsxs)(Ra.a,{onClick:function(){return c(Object(Te.a)(Object(Te.a)({},o),{},{depositos:!0}))},children:[Object(w.jsx)(Vt.a,{children:Object(w.jsx)(ee.a,{children:"add"})}),Object(w.jsx)(Ht.a,{primary:"Agregar deposito"})]})})]})]})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:12,md:4,children:Object(w.jsx)(ae.a,{variant:"outlined",size:"large",onClick:i,children:"Agregar stock"})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(Ut.a,{children:l.map((function(e,t){return Object(w.jsxs)(Bt.a,{children:[Object(w.jsx)(Wa.a,{children:Object(w.jsx)(Pe.a,{onClick:function(){d(t)},children:Object(w.jsx)(ee.a,{children:"close"})})}),Object(w.jsx)(Ht.a,{secondary:"Cantidad: ".concat(e.stock_producto_deposito),primary:"".concat(e.nombre)})]},t)}))})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(te.a,{variant:"button",children:"NOTIFICACION"})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:12,md:4,children:Object(w.jsx)(Fe.a,{fullWidth:!0,onChange:t,label:"Stock m\xednimo",autoComplete:"off",name:"minimo_producto",disabled:"2"===a.tipo_producto||"0"===a.notificar_producto,value:a.minimo_producto,InputProps:{startAdornment:Object(w.jsx)(Ie.a,{position:"start",children:Object(w.jsx)(ee.a,{color:"primary",children:"inventory_2"})}),inputProps:{min:0},inputComponent:Va},variant:"outlined",error:!1,helperText:"Cantidad m\xednima para notificar"})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:12,md:4,children:Object(w.jsx)(Ae.a,{placement:"top",title:"Al activar, el sistema le notificara que existe un m\xednimo del producto en stock",children:Object(w.jsx)(ot.a,{control:Object(w.jsx)(za.a,{checked:"1"===a.notificar_producto,onChange:r,name:"notificar_producto",color:"primary"}),label:"Notificar stock m\xednimo"})})})]}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(te.a,{variant:"button",children:"COMISI\xd3N"})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:12,md:3,children:Object(w.jsx)(Fe.a,{fullWidth:!0,onChange:t,label:"Comisi\xf3n en %",autoComplete:"off",name:"porcentaje_comision",value:a.porcentaje_comision,InputProps:{startAdornment:Object(w.jsx)(Ie.a,{position:"start",children:Object(w.jsx)(ee.a,{color:"secondary",children:"money"})}),inputProps:{min:0,max:100,maxLength:2},inputComponent:Va},variant:"outlined"})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:12,md:3,children:Object(w.jsxs)(Ve.a,{fullWidth:!0,children:[Object(w.jsx)(He.a,{variant:"outlined",children:"Estado de stock"}),Object(w.jsxs)(Ge.a,{required:!0,name:"disponible_producto",value:a.disponible_producto,onChange:t,variant:"outlined",children:[Object(w.jsx)(Je.a,{value:1,children:"Disponible"}),Object(w.jsx)(Je.a,{value:0,children:"No Disponible"})]})]})})]})},Ga=function(){var e=wa(),t=e.cargas,a=e.stock,r="1"===e.formulario.tipo_producto&&0===a.length||t.guardar;return Object(w.jsxs)(Z.a,{container:!0,direction:"row",justifyContent:"space-between",alignItems:"center",children:[Object(w.jsx)(Z.a,{item:!0,children:Object(w.jsx)(te.a,{variant:"h5",children:"NUEVO"})}),Object(w.jsx)(Z.a,{item:!0,children:Object(w.jsxs)(Z.a,{container:!0,direction:"row",spacing:2,justifyContent:"flex-end",alignItems:"flex-start",children:[Object(w.jsx)(Z.a,{item:!0,children:Object(w.jsx)(ua,{onClick:function(){},color:"primary",type:"submit",variant:"outlined",disabled:r,children:"GUARDAR"})}),Object(w.jsx)(Z.a,{item:!0,children:Object(w.jsx)(ua,{color:"error",onClick:function(){Et.goto("productos")},variant:"outlined",disabled:t.guardar,children:"Cerrar"})})]})})]})},Ja=function(){var e=wa(),t=e.tabValue,a=e.setTabValue,r=e.sendForm,n=e.snack,o=e.setSnack,i=e.cargas,s=Object(c.useCallback)((function(e){var a=e.children,r=e.index;return t===r&&Object(w.jsx)("div",{style:{marginTop:"25px"},children:a})}),[t]);return Object(w.jsxs)("form",{onSubmit:r,children:[Object(w.jsx)(Ea.a,{open:n.open,onClose:function(){return o(Object(Te.a)(Object(Te.a)({},n),{},{open:!1}))},anchorOrigin:{vertical:"top",horizontal:"center"},autoHideDuration:3e3,children:Object(w.jsx)(de.a,{severity:n.severity,variant:"filled",children:n.mensaje})}),Object(w.jsxs)(re.a,{sx:{borderBottom:1,borderColor:"divider"},children:[Object(w.jsx)(Ga,{}),Object(w.jsxs)(we.a,{sx:{width:"100%",marginTop:"8px"},spacing:2,children:[i.guardar&&Object(w.jsx)(Be.a,{}),i.main&&Object(w.jsx)(Be.a,{})]}),Object(w.jsxs)(Na.a,{indicatorColor:"primary",textColor:"primary",value:t,onChange:function(e,t){a(t)},children:[Object(w.jsx)(Ta.a,{label:"DATOS"}),Object(w.jsx)(Ta.a,{label:"VALORES Y STOCK"}),Object(w.jsx)(Ta.a,{label:"IMAGENES"})]})]}),Object(w.jsx)(s,{value:t,index:0,children:Object(w.jsx)(Ma,{})}),Object(w.jsx)(s,{value:t,index:1,children:Object(w.jsx)(Ha,{})}),Object(w.jsx)(s,{value:t,index:2,children:Object(w.jsx)(La,{})})]})},Ya=function(){return Object(w.jsxs)(Fa,{children:[Object(w.jsx)(Aa,{}),Object(w.jsx)(Pa,{}),Object(w.jsx)(Da,{}),Object(w.jsx)(Ia,{}),Object(w.jsx)(Ja,{})]})},Ka=Object(c.createContext)(),Xa=function(){var e=Object(c.useContext)(Ka);return{eliminarImagen:e.eliminarImagen,change:e.change,sendForm:e.sendForm,changeCheck:e.changeCheck,verificarProducto:e.verificarProducto,images:e.images,setImages:e.setImages,imagesURL:e.imagesURL,setImagesURL:e.setImagesURL,cargas:e.cargas,inputCodigo:e.inputCodigo,inputNombre:e.inputNombre,listas:e.listas,listaImagenes:e.listaImagenes,formulario:e.formulario,setFormulario:e.setFormulario,tabValue:e.tabValue,setTabValue:e.setTabValue,snack:e.snack,setSnack:e.setSnack}},Qa=function(e){var t=Object(H.h)().id,a=Object(H.f)().state,n=(null===a||void 0===a?void 0:a.page)||0,o=Object(H.g)(),i=I().token_user,s=Object(c.useState)(0),u=Object(r.a)(s,2),j=u[0],b=u[1],p=Object(c.useState)({open:!1,severity:"success",mensaje:"",id_code:"",send:!1}),m=Object(r.a)(p,2),O=m[0],x=m[1],h=Object(c.useState)({main:!0,guardar:!1}),f=Object(r.a)(h,2),g=f[0],_=f[1],v=Object(c.useRef)(null),C=Object(c.useRef)(null),S=JSON.parse(localStorage.getItem("dataProductos")),F={medidas:(null===S||void 0===S?void 0:S.medidas)||[],categorias:(null===S||void 0===S?void 0:S.categorias)||[],marcas:(null===S||void 0===S?void 0:S.marcas)||[],proveedores:(null===S||void 0===S?void 0:S.proveedores)||[],impuestos:(null===S||void 0===S?void 0:S.impuestos)||[],depositos:(null===S||void 0===S?void 0:S.depositos)||[]},P=Object(c.useState)(F),A=Object(r.a)(P,2),D=A[0],E=A[1],N=Object(c.useState)([]),T=Object(r.a)(N,2),R=T[0],M=T[1],L=Object(c.useState)({id_categoria_producto:"",id_proveedor_producto:"",id_marca_producto:"",id_impuesto_producto:"",id_unidad_medida_producto:"",id_deposito_producto:"",codigo_producto:"",nombre_producto:"",descripcion_producto:"",costo_producto:"0",precio_producto:"0",preciom_producto:"0",minimo_producto:"0",porcentaje_comision:"0",stock_producto:"0",notificar_producto:"",tipo_producto:"1",disponible_producto:"1"}),W=Object(r.a)(L,2),z=W[0],q=W[1],U=Object(c.useState)(null),B=Object(r.a)(U,2),V=B[0],J=B[1],Y=Object(c.useState)([]),K=Object(r.a)(Y,2),X=K[0],Q=K[1],Z=Object(c.useState)([]),$=Object(r.a)(Z,2),ee=$[0],te=$[1],ae=Object(c.useCallback)(Object(d.a)(l.a.mark((function e(){var a,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(x({open:!1,id_code:"",mensaje:"",severity:"success",send:!0}),V!==z.codigo_producto){e.next=3;break}return e.abrupt("return",!1);case 3:return e.next=5,k.get({table:"productos",where:"codigo_producto,=,'".concat(z.codigo_producto,"'"),fields:"id_producto"});case 5:if("ok"!==(a=e.sent).response){e.next=20;break}if(!(a.found>0)){e.next=17;break}if(a.results[0].id_producto!==t){e.next=12;break}x({open:!1,id_code:"",mensaje:"",severity:"success",send:!0}),e.next=15;break;case 12:return x({open:!0,mensaje:"Ese c\xf3digo del producto ya existe.",severity:"warning",id_code:"codigo_producto",send:!1}),null===v||void 0===v||null===(r=v.current)||void 0===r||r.focus(),e.abrupt("return",!1);case 15:e.next=18;break;case 17:x({open:!1,id_code:"",mensaje:"",severity:"success",send:!0});case 18:e.next=21;break;case 20:console.log(a);case 21:case"end":return e.stop()}}),e)}))),[z,t,V]),re=function(){var e=Object(d.a)(l.a.mark((function e(a){var r,n,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y()({icon:"warning",text:"Desea borrar la imagen?",buttons:["Cancelar","Ok"],dangerMode:!0});case 2:if(!e.sent){e.next=13;break}return _({main:!1,guardar:!0}),e.next=7,k.deleteImage({table:"productos_images",path:t,token:i,idImage:a});case 7:"ok"===(r=e.sent).response?y()({text:"Eliminado correctamente",timer:1200,icon:"success"}):console.log(r),n=Object(Qe.a)(R),o=n.findIndex((function(e){return e.id_productos_image===t})),n.splice(o,1),M(n);case 13:_({main:!1,guardar:!1});case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ne=Object(c.useCallback)(function(){var e=Object(d.a)(l.a.mark((function e(a){var r,o,c,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.preventDefault(),""!==(r=Object(Te.a)({},z)).codigo_producto){e.next=6;break}return b(0),x({open:!0,severity:"warning",mensaje:"Rellene el c\xf3digo",id:"codigo_producto",send:!1}),e.abrupt("return",!1);case 6:if(""!==r.nombre_producto){e.next=11;break}return b(0),null===C||void 0===C||null===(o=C.current)||void 0===o||o.focus(),x({open:!0,severity:"warning",mensaje:"Rellene el nombre del producto",id:"nombre_producto",send:!1}),e.abrupt("return",!1);case 11:if(""!==r.id_categoria_producto&&""!==r.id_impuesto_producto&&""!==r.id_marca_producto&&""!==r.id_proveedor_producto&&""!==r.id_unidad_medida_producto){e.next=15;break}return b(0),x({open:!0,severity:"warning",mensaje:"Rellene todos los campos",id:"3",send:!1}),e.abrupt("return",!1);case 15:if(!1!==O.send){e.next=17;break}return e.abrupt("return",!1);case 17:return _({main:!1,guardar:!0}),e.next=20,k.update({table:"productos",data:z,id:t,token:i});case 20:c=e.sent,X.length>0&&(s="1",X.forEach(function(){var e=Object(d.a)(l.a.mark((function e(a){var r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r={id_image_producto:t,image_name:a.name,portada_imagen_producto:s},k.uploadImage({table:"productos_images",file:a,data:r,token:i,path:t}),s="0";case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())),"ok"===c.response&&(y()({text:"Actualizado correctamente",icon:"success",timer:2e3}).then((function(){Et.goto("productos?p=".concat(n))})),_({main:!1,guardar:!1}));case 23:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[i,z,t,X,O,n]),oe=Object(c.useCallback)(Object(d.a)(l.a.mark((function e(){var a,r,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([k.get({table:"productos_images",where:"id_image_producto,=,".concat(t)}),k.get({table:"productos",where:"id_producto,=,".concat(t),fields:"id_producto,id_unidad_medida_producto,codigo_producto,nombre_producto,descripcion_producto,id_categoria_producto,id_proveedor_producto,notificar_producto,\n      costo_producto,precio_producto,preciom_producto,id_impuesto_producto,tipo_producto,minimo_producto,id_marca_producto,porcentaje_comision,disponible_producto"})]);case 2:if("ok"!==(a=e.sent)[1].response){e.next=17;break}if(null!==localStorage.getItem("dataProductos")){e.next=11;break}return e.next=8,Promise.all([k.getPromise({table:"categorias",fields:"id_categoria,nombre_categoria,id_padre_categoria",sort:"-nombre_categoria"}),k.getPromise({table:"proveedors",fields:"id_proveedor,nombre_proveedor"}),k.getPromise({table:"marcas",fields:"id_marca,nombre_marca"}),k.getPromise({table:"unidad_medidas"}),k.getPromise({table:"impuestos"})]);case 8:r=e.sent,n={categorias:r[0].results,proveedores:r[1].results,marcas:r[2].results,medidas:r[3].results,impuestos:r[4].results},E(c=n),localStorage.setItem("dataProductos",JSON.stringify(c));case 11:M(a[0].results),q(a[1].results[0]),J(a[1].results[0].codigo_producto),_({main:!1,imagen:!1,guardar:!1}),e.next=18;break;case 17:o("/productos");case 18:case"end":return e.stop()}var c}),e)}))),[t,o]);return Object(c.useEffect)((function(){var e=!0,t=new AbortController;return e&&oe(),function(){e=!1,t.abort()}}),[oe]),Object(w.jsx)(Ka.Provider,{value:{eliminarImagen:re,change:function(e){var t=e.target,a=t.name,r=t.value;q(Object(Te.a)(Object(Te.a)({},z),{},Object(G.a)({},a,r)))},sendForm:ne,changeCheck:function(e){var t=e.target,a=t.checked,r=t.name;q(Object(Te.a)(Object(Te.a)({},z),{},Object(G.a)({},r,a?"1":"0")))},verificarProducto:ae,images:X,setImages:Q,imagesURL:ee,setImagesURL:te,cargas:g,inputCodigo:v,inputNombre:C,listas:D,listaImagenes:R,formulario:z,setFormulario:q,tabValue:j,setTabValue:b,snack:O,setSnack:x},children:e.children})},Za=function(){var e=Xa().cargas;return Object(w.jsxs)(Z.a,{container:!0,direction:"row",justifyContent:"space-between",alignItems:"center",children:[Object(w.jsx)(Z.a,{item:!0,children:Object(w.jsx)(te.a,{variant:"h5",children:" EDITAR "})}),Object(w.jsx)(Z.a,{item:!0,children:Object(w.jsxs)(Z.a,{container:!0,direction:"row",spacing:2,justifyContent:"flex-end",alignItems:"flex-start",children:[Object(w.jsx)(Z.a,{item:!0,children:Object(w.jsx)(ua,{onClick:function(){},color:"primary",type:"submit",variant:"outlined",disabled:e.guardar,children:"GUARDAR"})}),Object(w.jsx)(Z.a,{item:!0,children:Object(w.jsx)(ua,{color:"error",onClick:function(){Et.goto("productos")},variant:"outlined",disabled:e.guardar,children:"Volver"})})]})})]})},$a=function(){var e=Xa(),t=e.listas,a=e.formulario,r=e.change,n=e.inputCodigo,o=e.cargas,c=e.snack,i=e.inputNombre,s=e.verificarProducto;return Object(w.jsxs)(Z.a,{container:!0,spacing:2,children:[Object(w.jsx)(Z.a,{item:!0,xs:12,sm:12,md:6,children:Object(w.jsx)(Fe.a,{required:!0,autoFocus:!0,error:"codigo_producto"===c.id_code,disabled:o.guardar,inputRef:n,onChange:r,onBlur:s,value:a.codigo_producto,label:"C\xf3digo",autoComplete:"off",name:"codigo_producto",InputProps:{startAdornment:Object(w.jsx)(Ie.a,{position:"start",children:Object(w.jsx)(ee.a,{color:"primary",children:"qr_code"})})},fullWidth:!0,variant:"outlined",helperText:"C\xf3digo de \xfanico del producto"})}),Object(w.jsxs)(Z.a,{item:!0,xs:12,sm:12,md:6,children:[Object(w.jsx)(rt.a,{component:"legend",children:"Tipo:"}),Object(w.jsx)(ot.a,{value:"1",control:Object(w.jsx)(ct.a,{name:"tipo_producto",checked:"1"===a.tipo_producto,onChange:r,color:"primary"}),label:"Art\xedculo",labelPlacement:"end"}),Object(w.jsx)(ot.a,{value:"2",control:Object(w.jsx)(ct.a,{name:"tipo_producto",checked:"2"===a.tipo_producto,onChange:r,color:"primary"}),label:"Servicio",labelPlacement:"end"})]}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:12,md:4,children:Object(w.jsx)(Fe.a,{required:!0,error:"nombre_producto"===c.id,disabled:o.guardar,onChange:r,inputRef:i,label:"Nombre",autoComplete:"off",name:"nombre_producto",value:a.nombre_producto,InputProps:{startAdornment:Object(w.jsx)(Ie.a,{position:"start",children:Object(w.jsx)(ee.a,{color:"action",children:"inventory_2"})})},fullWidth:!0,variant:"outlined",helperText:"nombre del producto"})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:12,md:8,children:Object(w.jsx)(Fe.a,{disabled:o.guardar,onChange:r,autoComplete:"off",name:"descripcion_producto",value:a.descripcion_producto,label:"Descripci\xf3n detallada",fullWidth:!0})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:4,children:Object(w.jsxs)(Ve.a,{fullWidth:!0,children:[Object(w.jsx)(He.a,{variant:"outlined",children:"Impuesto"}),Object(w.jsx)(Ge.a,{required:!0,name:"id_impuesto_producto",value:a.id_impuesto_producto,onChange:r,variant:"outlined",children:t.impuestos.map((function(e){return Object(w.jsx)(Je.a,{value:e.id_impuesto,children:e.nombre_impuesto},e.id_impuesto)}))})]})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:12,md:4,children:Object(w.jsxs)(Ve.a,{fullWidth:!0,children:[Object(w.jsx)(He.a,{variant:"outlined",children:"Seleccionar proveedor"}),Object(w.jsx)(Ge.a,{name:"id_proveedor_producto",value:a.id_proveedor_producto,onChange:r,variant:"outlined",required:!0,children:t.proveedores.map((function(e){return Object(w.jsx)(Je.a,{value:e.id_proveedor,children:e.nombre_proveedor},e.id_proveedor)}))})]})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:12,md:4,children:Object(w.jsxs)(Ve.a,{fullWidth:!0,children:[Object(w.jsx)(He.a,{variant:"outlined",children:"Selecccionar categor\xeda"}),Object(w.jsx)(Ge.a,{required:!0,name:"id_categoria_producto",value:a.id_categoria_producto,onChange:r,variant:"outlined",children:t.categorias.map((function(e){return Object(w.jsx)(Je.a,{value:e.id_categoria,children:e.nombre_categoria},e.id_categoria)}))})]})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:12,md:4,children:Object(w.jsxs)(Ve.a,{fullWidth:!0,children:[Object(w.jsx)(He.a,{variant:"outlined",children:"Marca"}),Object(w.jsx)(Ge.a,{required:!0,name:"id_marca_producto",value:a.id_marca_producto,onChange:r,variant:"outlined",fullWidth:!0,children:t.marcas.map((function(e){return Object(w.jsx)(Je.a,{value:e.id_marca,children:e.nombre_marca},e.id_marca)}))})]})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:12,md:4,children:Object(w.jsxs)(Ve.a,{fullWidth:!0,children:[Object(w.jsx)(He.a,{variant:"outlined",children:"Unidad de medida"}),Object(w.jsx)(Ge.a,{name:"id_unidad_medida_producto",value:a.id_unidad_medida_producto,onChange:r,variant:"outlined",required:!0,children:t.medidas.map((function(e){return Object(w.jsx)(Je.a,{value:e.id_unidad_medida,children:e.descripcion_medida},e.id_unidad_medida)}))})]})})]})},er=function(){var e=Xa(),t=e.change,a=e.formulario,r=e.changeCheck;return Object(w.jsxs)(Z.a,{container:!0,spacing:2,children:[Object(w.jsx)(Z.a,{item:!0,xs:12,sm:4,md:4,children:Object(w.jsx)(Fe.a,{onChange:t,fullWidth:!0,label:"Costo",disabled:"2"===a.tipo_producto,autoComplete:"off",name:"costo_producto",value:a.costo_producto,InputProps:{startAdornment:Object(w.jsx)(Ie.a,{position:"start",children:Object(w.jsx)(ee.a,{style:{color:"#ffa501"},children:"attach_money"})}),inputProps:{min:0},inputComponent:Va},variant:"outlined",error:!1,helperText:"Costo del producto"})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:4,md:4,children:Object(w.jsx)(Fe.a,{fullWidth:!0,onChange:t,label:"Precio",autoComplete:"off",name:"precio_producto",value:a.precio_producto,InputProps:{startAdornment:Object(w.jsx)(Ie.a,{position:"start",children:Object(w.jsx)(ee.a,{color:"primary",children:"point_of_sale"})}),inputProps:{min:0},inputComponent:Va},variant:"outlined",error:!1,helperText:"Precio del producto"})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:4,md:4,children:Object(w.jsx)(Fe.a,{fullWidth:!0,onChange:t,label:"Precio Mayorista",autoComplete:"off",name:"preciom_producto",value:a.preciom_producto,InputProps:{startAdornment:Object(w.jsx)(Ie.a,{position:"start",children:Object(w.jsx)(ee.a,{color:"primary",children:"point_of_sale"})}),inputProps:{min:0},inputComponent:Va},variant:"outlined",error:!1,helperText:"Precio para mayoristas"})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:4,md:4,children:Object(w.jsx)(ot.a,{control:Object(w.jsx)(za.a,{checked:"1"===a.notificar_producto,onChange:r,name:"notificar_producto",color:"primary"}),label:"Notificar stock m\xednimo"})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:8,md:8,children:Object(w.jsx)(Fe.a,{fullWidth:!0,onChange:t,label:"Stock m\xednimo",disabled:"2"===a.tipo_producto||"0"===a.notificar_producto,autoComplete:"off",name:"minimo_producto",value:a.minimo_producto,InputProps:{startAdornment:Object(w.jsx)(Ie.a,{position:"start",children:Object(w.jsx)(ee.a,{color:"primary",children:"inventory_2"})}),inputProps:{min:0},inputComponent:Va},variant:"outlined",error:!1,helperText:"Cantidad m\xednima de existencia"})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:3,children:Object(w.jsx)(Fe.a,{fullWidth:!0,onChange:t,label:"Comisi\xf3n",autoComplete:"off",name:"porcentaje_comision",value:a.porcentaje_comision,InputProps:{startAdornment:Object(w.jsx)(Ie.a,{position:"start",children:Object(w.jsx)(ee.a,{color:"secondary",children:"money"})}),inputProps:{min:0,max:100},inputComponent:Va},variant:"outlined",helperText:"Si el producto tiene comisi\xf3n"})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:3,children:Object(w.jsxs)(Ve.a,{fullWidth:!0,children:[Object(w.jsx)(He.a,{variant:"outlined",children:"Estado de stock"}),Object(w.jsxs)(Ge.a,{required:!0,name:"disponible_producto",value:a.disponible_producto,onChange:t,variant:"outlined",children:[Object(w.jsx)(Je.a,{value:1,children:"Disponible"}),Object(w.jsx)(Je.a,{value:0,children:"No Disponible"})]})]})})]})},tr=function(){var e=Xa(),t=e.setImages,a=e.imagesURL,r=e.setImagesURL,n=e.images,o=e.listaImagenes,c=e.eliminarImagen;return Object(w.jsxs)(Z.a,{container:!0,spacing:2,children:[Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)("div",{children:Object(w.jsxs)("label",{htmlFor:"btn-upload",children:[Object(w.jsx)("input",{id:"btn-upload",name:"btn-upload",style:{display:"none"},type:"file",onChange:function(e){var o=[],c=Object(Qe.a)(n),i=Object(Qe.a)(a);o.push(e.target.files);for(var s=0;s<o[0].length;s++)i.push(URL.createObjectURL(o[0][s])),c.push(o[0][s]);t(c),r(i)},multiple:!0,accept:"image/jpeg, image/png"}),Object(w.jsx)(ae.a,{variant:"outlined",startIcon:Object(w.jsx)(ee.a,{children:"image"}),component:"span",children:"Agregar imagen"})]})})}),Object(w.jsx)(Z.a,{item:!0,children:Object(w.jsxs)(we.a,{direction:{xs:"column",sm:"row"},spacing:{xs:1,sm:2,md:4},children:[(a||[]).map((function(e,o){return Object(w.jsxs)(we.a,{direction:"column",children:[Object(w.jsx)($.a,{variant:"square",alt:"...",src:e,sx:{width:256,height:256}}),Object(w.jsx)(Ae.a,{title:"Borrar imagen",children:Object(w.jsx)(Pe.a,{onClick:function(){return function(e){var o=Object(Qe.a)(n),c=Object(Qe.a)(a);o.splice(e,1),c.splice(e,1),t(o),r(c)}(o)},children:Object(w.jsx)(ee.a,{children:"delete"})})})]},o)})),o.map((function(e){return Object(w.jsxs)(we.a,{direction:"column",children:[Object(w.jsx)($.a,{variant:"square",alt:"...",src:e.url_imagen,sx:{width:256,height:256}}),Object(w.jsx)(Ae.a,{title:"Borrar imagen",children:Object(w.jsx)(Pe.a,{onClick:function(){return c(e.id_productos_image)},children:Object(w.jsx)(ee.a,{children:"delete"})})})]},e.id_productos_image)}))]})})]})},ar=function(){var e=Xa(),t=e.tabValue,a=e.setTabValue,r=e.cargas,n=e.snack,o=e.setSnack,i=e.sendForm,s=Object(c.useCallback)((function(e){var a=e.children,r=e.index;return t===r&&Object(w.jsx)("div",{style:{marginTop:"25px"},children:a})}),[t]);return Object(w.jsxs)("form",{onSubmit:i,children:[r.main&&Object(w.jsx)(ba,{}),Object(w.jsx)(Ea.a,{open:n.open,onClose:function(){return o(Object(Te.a)(Object(Te.a)({},n),{},{open:!1}))},anchorOrigin:{vertical:"top",horizontal:"center"},autoHideDuration:3e3,children:Object(w.jsx)(de.a,{severity:n.severity,variant:"filled",children:n.mensaje})}),Object(w.jsxs)(re.a,{sx:{borderBottom:1,borderColor:"divider"},children:[Object(w.jsx)(Za,{}),Object(w.jsx)(we.a,{sx:{width:"100%",marginTop:"8px"},spacing:2,children:r.guardar&&Object(w.jsx)(Be.a,{})}),Object(w.jsxs)(Na.a,{indicatorColor:"primary",textColor:"primary",value:t,onChange:function(e,t){a(t)},children:[Object(w.jsx)(Ta.a,{label:"DATOS"}),Object(w.jsx)(Ta.a,{label:"VALORES"}),Object(w.jsx)(Ta.a,{label:"IMAGENES"})]})]}),Object(w.jsx)(s,{value:t,index:0,children:Object(w.jsx)($a,{})}),Object(w.jsx)(s,{value:t,index:1,children:Object(w.jsx)(er,{})}),Object(w.jsx)(s,{value:t,index:2,children:Object(w.jsx)(tr,{})})]})},rr=function(){return Object(w.jsx)(Qa,{children:Object(w.jsx)(ar,{})})},nr=Object(c.createContext)(),or=function(){var e=Object(c.useContext)(nr);return{listaDepositos:e.listaDepositos,cargando:e.cargando,setCargando:e.setCargando,lista:e.lista,setLista:e.setLista,setDialogs:e.setDialogs,dialogs:e.dialogs,apartar:e.apartar,devolver:e.devolver,datosCliente:e.datosCliente,setDatosCliente:e.setDatosCliente,errores:e.errores,setErrores:e.setErrores}},cr=function(e){var t=e.children,a=I(),n=a.token_user,o=a.id_user,i={apartar:!1,buscarProducto:!1,buscarCliente:!1},s=Object(c.useState)(i),u=Object(r.a)(s,2),j=u[0],b=u[1],p=Object(c.useState)({error:!1,color:"error",mensaje:"",id:""}),m=Object(r.a)(p,2),O=m[0],x=m[1],h=Object(c.useState)({lista:!0,apartar:!1,cliente:!1}),f=Object(r.a)(h,2),g=f[0],_=f[1],v=Object(c.useState)([]),C=Object(r.a)(v,2),S=C[0],F=C[1],P=Object(c.useState)([]),A=Object(r.a)(P,2),D=A[0],E=A[1],N=Object(c.useState)({id_cliente:"",nombre_cliente:""}),T=Object(r.a)(N,2),R=T[0],M=T[1],L=function(){var e=Object(d.a)(l.a.mark((function e(t,a,r){var c,s,d,u,j,p,m,h,f,v,C;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==(c=R.id_cliente)){e.next=4;break}return x(Object(Te.a)(Object(Te.a)({},O),{},{error:!0,color:"error",mensaje:"Cliente no registrado",id:"cliente"})),e.abrupt("return",!1);case 4:return _(Object(Te.a)(Object(Te.a)({},g),{},{apartar:!0})),e.next=7,k.get({table:"productos",where:"codigo_producto,=,'".concat(t,"'"),fields:"id_producto,codigo_producto"});case 7:if(!("ok"===(s=e.sent).response&&s.found>0)){e.next=33;break}return d=s.results[0],e.next=12,k.get({table:"productos_depositos",where:"id_producto_deposito,=,".concat(d.id_producto,",and,id_deposito_deposito,=").concat(r)});case 12:if(!((u=e.sent).found>0)){e.next=30;break}if(j=u.results[0],p=parseFloat(j.stock_producto_deposito),m=d.id_producto,h=j.id_productos_deposito,!((f=p-parseFloat(a))<0)){e.next=23;break}x(Object(Te.a)(Object(Te.a)({},O),{},{error:!0,color:"error",mensaje:"No hay sufiente stock para apartar",id:"cantidad"})),e.next=28;break;case 23:return v={id_producto_apartado:m,id_deposito_apartado:r,id_deposito_producto_apartado:h,id_cliente_apartado:c,id_user_apartado:o,cantidad_apartado:a},e.next=26,Promise.all([k.update({table:"productos_depositos",token:n,data:{stock_producto_deposito:f},id:h}),k.insert({table:"productos_apartados",token:n,data:v})]);case 26:"ok"===(C=e.sent)[0].response&&"ok"===C[1].response?(x(Object(Te.a)(Object(Te.a)({},O),{},{error:!0,color:"success",mensaje:"Apartado correctamente",id:""})),b(i),z()):console.log(C);case 28:e.next=31;break;case 30:x(Object(Te.a)(Object(Te.a)({},O),{},{error:!0,color:"error",mensaje:"No existe productos en ese deposito",id:"notfound"}));case 31:e.next=34;break;case 33:console.log(s);case 34:_(Object(Te.a)(Object(Te.a)({},g),{},{apartar:!0}));case 35:case"end":return e.stop()}}),e)})));return function(t,a,r){return e.apply(this,arguments)}}(),W=function(){var e=Object(d.a)(l.a.mark((function e(t){var a,r,o,c,i,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y()({text:"Desea devolver ".concat(t.nombre_producto," ?"),icon:"warning",buttons:["NO","SI DEVOLVER"]});case 2:if(!e.sent){e.next=21;break}return a=t.id_deposito_producto_apartado,r=t.id_productos_apartado,o=parseFloat(t.cantidad_apartado),e.next=9,k.get({table:"productos_depositos",where:"id_productos_deposito,=,".concat(a)});case 9:if(!("ok"===(c=e.sent).response&&c.found>0)){e.next=14;break}i=parseFloat(c.results[0].stock_producto_deposito),e.next=16;break;case 14:return console.log(c),e.abrupt("return",!1);case 16:return s=o+i,e.next=19,Promise.all([k.update({table:"productos_depositos",id:a,token:n,data:{stock_producto_deposito:s}}),k.delete({table:"productos_apartados",id:r,token:n})]);case 19:"ok"===e.sent[0].response&&z();case 21:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),z=Object(c.useCallback)(Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return _({lista:!0,apartar:!1,cliente:!1}),e.next=3,Promise.all([k.get({table:"productos",include:"productos_apartados,clientes,users,depositos",on:"id_producto_apartado,id_producto,id_cliente,id_cliente_apartado,id_user,id_user_apartado,id_deposito_apartado,id_deposito",fields:"id_producto,id_producto_apartado,nombre_cliente,cantidad_apartado,codigo_producto,nombre_producto,nombre_user,id_productos_apartado,nombre_deposito,id_deposito,id_productos_apartado,id_deposito_producto_apartado"}),k.get({table:"depositos",where:"tipo_deposito,=,1",fields:"id_deposito,nombre_deposito"})]);case 3:"ok"===(t=e.sent)[0].response&&"ok"===t[1].response?(F(t[0].results),E(t[1].results)):console.log(t),_({lista:!1,apartar:!1});case 6:case"end":return e.stop()}}),e)}))),[]);return Object(c.useEffect)((function(){var e=!0,t=new AbortController;return e&&z(),function(){e=!1,t.abort()}}),[z]),Object(w.jsx)(nr.Provider,{value:{listaDepositos:D,cargando:g,setCargando:_,lista:S,setLista:F,setDialogs:b,dialogs:j,apartar:L,devolver:W,datosCliente:R,setDatosCliente:M,errores:O,setErrores:x},children:t})},ir=function(){var e=or(),t=e.dialogs,a=e.setDialogs,n=e.apartar,o=e.setDatosCliente,i=e.datosCliente,s=e.setErrores,u=e.errores,j=e.listaDepositos,b=Object(c.useState)(!1),p=Object(r.a)(b,2),m=p[0],O=p[1],x=function(){a(Object(Te.a)(Object(Te.a)({},t),{},{apartar:!1})),s({error:!1,mensaje:"",color:"success"})},h=Object(c.useRef)(null),f=Object(c.useRef)(null),g=Object(c.useRef)(null),_=Object(c.useState)(""),v=Object(r.a)(_,2),C=v[0],S=v[1],y=function(){var e=Object(d.a)(l.a.mark((function e(){var t,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==(t=g.current.value)){e.next=5;break}return s(Object(Te.a)(Object(Te.a)({},u),{},{error:!0,color:"error",mensaje:"Ingrese el nro de documento."})),g.current.focus(),e.abrupt("return",!1);case 5:return s(Object(Te.a)(Object(Te.a)({},u),{},{error:!1})),O(!0),e.next=9,k.get({table:"clientes",where:"ruc_cliente,=,'".concat(t,"'")});case 9:"ok"===(a=e.sent).response?a.found>0?o(a.results[0]):(s(Object(Te.a)(Object(Te.a)({},u),{},{error:!0,color:"error",mensaje:"No hay registros de ese documento.",id:"cliente"})),g.current.value="",g.current.focus()):console.log(a),O(!1);case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(w.jsxs)(ze.a,{fullWidth:!0,open:t.apartar,onClose:x,children:[Object(w.jsx)(qe.a,{children:"Apartar producto"}),Object(w.jsx)(Ue.a,{dividers:!0,children:Object(w.jsxs)(Z.a,{container:!0,spacing:2,alignItems:"center",children:[Object(w.jsx)(Z.a,{item:!0,xs:12,children:(m.apartar||m)&&Object(w.jsx)(Be.a,{})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:6,children:u.error&&Object(w.jsx)(de.a,{severity:u.color,children:u.mensaje})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:6,children:""!==i.id_cliente&&Object(w.jsxs)(de.a,{icon:!1,severity:"info",children:[" ",i.nombre_cliente," - ",i.ruc_cliente]})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:8,children:Object(w.jsx)(Fe.a,{InputProps:{startAdornment:Object(w.jsx)(Ie.a,{position:"start",children:Object(w.jsx)(Pe.a,{onClick:function(){return a(Object(Te.a)(Object(Te.a)({},t),{},{buscarCliente:!0}))},children:Object(w.jsx)(ee.a,{children:"search"})})})},inputRef:g,fullWidth:!0,autoFocus:!0,label:"Doc de cliente"})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:4,children:Object(w.jsx)(ae.a,{variant:"outlined",onClick:y,size:"large",children:"Consultar"})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:6,children:Object(w.jsx)(Fe.a,{inputRef:f,error:"notfound"===u.id,fullWidth:!0,label:"C\xf3digo de producto",InputProps:{startAdornment:Object(w.jsx)(Ie.a,{position:"start",children:Object(w.jsx)(Pe.a,{onClick:function(){return a(Object(Te.a)(Object(Te.a)({},t),{},{buscarProducto:!0}))},children:Object(w.jsx)(ee.a,{children:"search"})})})}})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:6,children:Object(w.jsx)(Fe.a,{inputRef:h,fullWidth:!0,label:"Cantidad",error:"cantidad"===u.id,InputProps:{inputComponent:Va,inputProps:{min:0}}})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:6,children:Object(w.jsxs)(Ve.a,{fullWidth:!0,children:[Object(w.jsx)(He.a,{variant:"outlined",children:"Dep\xf3sito"}),Object(w.jsxs)(Ge.a,{required:!0,error:"deposito"===u.id,name:"id_deposito",value:C,onChange:function(e){S(e.target.value)},variant:"outlined",children:[Object(w.jsx)(Je.a,{disabled:!0,value:"",children:"Seleccione dep\xf3sito"}),j.map((function(e){return Object(w.jsx)(Je.a,{value:e.id_deposito,children:e.nombre_deposito},e.id_deposito)}))]})]})})]})}),Object(w.jsxs)(Ye.a,{children:[Object(w.jsx)(ae.a,{variant:"outlined",onClick:function(){!function(){var e=h.current.value,t=f.current.value;""===e?(s(Object(Te.a)(Object(Te.a)({},u),{},{error:!0,color:"error",mensaje:"Ingrese una cantidad valida",id:"cantidad"})),h.current.focus()):""===t?(s(Object(Te.a)(Object(Te.a)({},u),{},{error:!0,color:"error",mensaje:"Ingrese un codigo valido",id:"codigo"})),f.current.focus()):""===C?s(Object(Te.a)(Object(Te.a)({},u),{},{error:!0,color:"error",mensaje:"Seleccione dep\xf3sito",id:"deposito"})):n(t,e,C)}()},children:"Apartar"}),Object(w.jsx)(ae.a,{variant:"outlined",onClick:x,children:"Cerrar"})]})]})},sr=a(834),lr=function(){var e=or(),t=e.dialogs,a=e.setDialogs,n=e.setDatosCliente,o=e.setErrores,s=e.errores,u=Object(c.useState)([]),j=Object(r.a)(u,2),b=j[0],p=j[1],m=Object(c.useState)(!1),O=Object(r.a)(m,2),x=O[0],h=O[1],f=Object(c.useRef)(null),g=function(){a(Object(Te.a)(Object(Te.a)({},t),{},{buscarCliente:!1})),p([])},_=Object(c.useCallback)(function(){var e=Object(d.a)(l.a.mark((function e(t){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:""!==(a=t.target.value)?(h(!0),setTimeout(Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.get({table:"clientes",filtersSearch:a,filtersField:"nombre_cliente,ruc_cliente",pagesize:"10"});case 2:"ok"===(t=e.sent).response?p(t.results):console.log(t);case 4:case"end":return e.stop()}}),e)}))),500)):p([]),h(!1);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[]);return Object(w.jsxs)(ze.a,{open:t.buscarCliente,fullWidth:!0,onClose:g,children:[Object(w.jsx)(qe.a,{children:"Buscar Cliente"}),Object(w.jsx)(Ue.a,{dividers:!0,children:Object(w.jsx)(sr.a,{loading:x,loadingText:"Cargando...",noOptionsText:"No hay clientes con ese nombre",onChange:function(e,t){n(t),o(Object(Te.a)(Object(Te.a)({},s),{},{error:!0,color:"success",mensaje:"Cliente: ".concat(t.nombre_cliente," - Doc: ").concat(t.ruc_cliente)})),g()},disableClearable:!0,options:b,getOptionLabel:function(e){return e.nombre_cliente+" "+e.ruc_cliente},fullWidth:!0,isOptionEqualToValue:function(e,t){return e.id_cliente===t.id_cliente},renderInput:function(e){return Object(w.jsx)(Fe.a,Object(Te.a)(Object(Te.a)({},e),{},{autoFocus:!0,label:"Buscar cliente",inputRef:f,onChange:_,InputProps:Object(Te.a)(Object(Te.a)({},e.InputProps),{},{endAdornment:Object(w.jsxs)(i.a.Fragment,{children:[x?Object(w.jsx)(U.a,{color:"inherit",size:20}):null,e.InputProps.endAdornment]})}),fullWidth:!0,placeholder:"Escriba el nombre del cliente",variant:"outlined"}))}})}),Object(w.jsx)(Ye.a,{children:Object(w.jsx)(ae.a,{onClick:g,variant:"outlined",children:"Cerrar"})})]})},dr=function(){var e=or(),t=e.dialogs,a=e.setDialogs;return Object(w.jsx)(ze.a,{open:t.buscarProducto,onClose:function(){return a(Object(Te.a)(Object(Te.a)({},t),{},{buscarProducto:!1}))}})},ur=function(){var e=or(),t=e.cargando,a=e.lista,r=e.dialogs,n=e.setDialogs,o=e.devolver,c=Object(Qe.a)(a),i=Object(w.jsx)("div",{children:Object(w.jsx)(ae.a,{variant:"outlined",onClick:function(){n(Object(Te.a)(Object(Te.a)({},r),{},{apartar:!0}))},color:"primary",children:"Apartar producto"})});return Object(w.jsx)(Ne,{children:Object(w.jsx)(ye,{nombretabla:"Productos Apartados",subtitle:"M\xf3dulo de apartado de stock de los d\xe9positos",icono:"save",bgicono:"#3f51b5",namecolumnID:"id_productos_apartado",columnas:[{field:"id_productos_apartado",title:"ID"},{field:"codigo_producto",title:"C\xf3digo"},{field:"nombre_producto",title:"Producto"},{field:"nombre_cliente",title:"Cliente"},{field:"nombre_user",title:"Apartado por"},{field:"cantidad_apartado",title:"Cantidad"},{field:"nombre_deposito",title:"Deposito"}],filas:c,Acciones:function(e){var t=e.filaProps;return Object(w.jsx)(we.a,{direction:"row",justifyContent:"center",children:Object(w.jsx)(Ae.a,{title:"Devolver al stock",arrow:!0,children:Object(w.jsx)(Pe.a,{onClick:function(){o(t)},children:Object(w.jsx)(ee.a,{color:"primary",children:"swap_horiz"})})})})},cargando:t.lista,search:i,showOptions:!0})})},jr=function(){return Object(w.jsxs)(cr,{children:[Object(w.jsx)(ir,{}),Object(w.jsx)(lr,{}),Object(w.jsx)(dr,{}),Object(w.jsx)(ur,{})]})},br=Object(c.createContext)(),pr=function(){var e=Object(c.useContext)(br);return{lista:e.lista,setLista:e.setLista,cargando:e.cargando,formulario:e.formulario,setFormulario:e.setFormulario,openDialog:e.openDialog,setOpenDialog:e.setOpenDialog,enviarFormulario:e.enviarFormulario,borrarRegistro:e.borrarRegistro}},mr=function(e){var t=e.children,a=JSON.parse(localStorage.getItem("dataProductos")),n=I().token_user,o=Object(c.useState)([]),i=Object(r.a)(o,2),s=i[0],u=i[1],j=Object(c.useState)(!0),b=Object(r.a)(j,2),p=b[0],m=b[1],O={id_proveedor:"",nombre_proveedor:"",telefono_proveedor:"",ruc_proveedor:""},x=Object(c.useState)(O),h=Object(r.a)(x,2),f=h[0],g=h[1],_=Object(c.useState)(!1),v=Object(r.a)(_,2),C=v[0],S=v[1],F=function(){var e=Object(d.a)(l.a.mark((function e(t){var r,o,c,i,s,d,u;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(m(!0),t.preventDefault(),r=""===f.id_proveedor?"Agregado":"Actualizado",o="proveedors",""!==f.id_proveedor){e.next=12;break}return delete f.id_proveedor,e.next=8,k.insert({table:o,data:f,token:n});case 8:"ok"===(c=e.sent).response&&a&&(i=Object(Te.a)({},a),s={id_proveedor:c.last_id,nombre_proveedor:f.nombre_proveedor},i.proveedores.push(s),localStorage.setItem("dataProductos",JSON.stringify(i))),e.next=16;break;case 12:return e.next=14,k.update({table:o,data:f,token:n,id:f.id_proveedor});case 14:c=e.sent,a&&(d=Object(Te.a)({},a),u=d.proveedores.findIndex((function(e){return e.id_proveedor===f.id_proveedor})),d.proveedores[u].nombre_proveedor=f.nombre_proveedor,localStorage.setItem("dataProductos",JSON.stringify(d)));case 16:"ok"===c.response?y()({icon:"success",text:"".concat(r," correctamente")}):console.log(c),A(),S(!1),g(O),m(!1);case 21:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),P=function(){var e=Object(d.a)(l.a.mark((function e(t){var r,o=arguments;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=o.length>1&&void 0!==o[1]?o[1]:"",y()({icon:"info",text:'Desear borrar "'.concat(r,'" ?'),title:"Borrar?",buttons:["Cancelar","OK"]}).then(function(){var e=Object(d.a)(l.a.mark((function e(r){var o,c,i,d;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r){e.next=19;break}return e.next=3,k.get({table:"productos",where:"id_proveedor_producto,=,".concat(t)});case 3:if("ok"!==(o=e.sent).response){e.next=18;break}if(!(o.found>0)){e.next=9;break}y()({icon:"error",text:"No se puede borrar porque hay productos que tiene este proveedor"}),e.next=16;break;case 9:return e.next=11,k.delete({table:"proveedors",id:t,token:n});case 11:c=Object(Qe.a)(s),i=c.findIndex((function(e){return e.id_proveedor===t})),c.splice(i,1),u(c),a&&((d=Object(Te.a)({},a)).proveedores.splice(i,1),localStorage.setItem("dataProductos",JSON.stringify(d)));case 16:e.next=19;break;case 18:console.log(o);case 19:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),A=Object(c.useCallback)(Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.get({table:"proveedors"});case 2:"ok"===(t=e.sent).response?u(t.results):console.log(t),m(!1);case 5:case"end":return e.stop()}}),e)}))),[]);return Object(c.useEffect)((function(){var e=!0,t=new AbortController;return e&&A(),function(){e=!1,t.abort()}}),[A]),Object(w.jsx)(br.Provider,{value:{lista:s,setLista:u,cargando:p,formulario:f,setFormulario:g,openDialog:C,setOpenDialog:S,enviarFormulario:F,borrarRegistro:P},children:t})},Or=function(){var e=pr(),t=e.openDialog,a=e.setOpenDialog,r=e.formulario,n=e.enviarFormulario,o=e.setFormulario,c=e.cargando,i=function(){a(!1),o({nombre_proveedor:"",telefono_proveedor:"",ruc_proveedor:""})},s=function(e){var t=e.target,a=t.name,n=t.value;o(Object(Te.a)(Object(Te.a)({},r),{},Object(G.a)({},a,n)))};return Object(w.jsx)(ze.a,{open:t,fullWidth:!0,onClose:i,children:Object(w.jsxs)("form",{onSubmit:n,children:[Object(w.jsx)(qe.a,{children:"Proveedor"}),Object(w.jsx)(Ue.a,{dividers:!0,children:Object(w.jsxs)(Z.a,{container:!0,spacing:2,children:[Object(w.jsx)(Z.a,{item:!0,xs:12,children:c&&Object(w.jsx)(Be.a,{})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(Fe.a,{autoFocus:!0,name:"nombre_proveedor",value:r.nombre_proveedor,onChange:s,fullWidth:!0,label:"Nombre de proveedor",variant:"outlined",required:!0,disabled:c})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(Fe.a,{name:"ruc_proveedor",value:r.ruc_proveedor,onChange:s,fullWidth:!0,label:"Documento del proveedor",variant:"outlined",required:!0,disabled:c})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(Fe.a,{name:"telefono_proveedor",value:r.telefono_proveedor,onChange:s,fullWidth:!0,label:"Tel\xe9fono de contacto",variant:"outlined",disabled:c})})]})}),Object(w.jsxs)(Ye.a,{children:[Object(w.jsxs)(ae.a,{disabled:c,variant:"outlined",onClick:n,children:[" ",r.id_proveedor?"EDITAR":"AGREGAR"]}),Object(w.jsx)(ae.a,{variant:"outlined",onClick:function(){return i()},children:"CERRAR"})]})]})})},xr=function(){var e=Object(c.useState)(""),t=Object(r.a)(e,2),a=t[0],n=t[1],o=pr(),i=o.lista,s=o.cargando,l=o.setFormulario,d=o.setOpenDialog,u=o.borrarRegistro,j=i.filter((function(e){return e.nombre_proveedor.toLowerCase().includes(a.toLowerCase())})),b=Object(w.jsxs)(we.a,{direction:"row",justifyContent:"center",spacing:2,children:[Object(w.jsx)(Fe.a,{InputProps:{endAdornment:Object(w.jsx)(Ie.a,{position:"end",children:Object(w.jsx)(Pe.a,{children:Object(w.jsx)(ee.a,{children:"search"})})})},onKeyPress:function(e){e.key},onChange:function(e){n(e.target.value)},variant:"outlined",label:"Buscar",value:a}),Object(w.jsx)(Ae.a,{title:"AGREGAR NUEVO",arrow:!0,children:Object(w.jsx)(ae.a,{color:"primary",variant:"outlined",size:"large",onClick:function(){d(!0)},children:"AGREGAR"})})]});return Object(w.jsxs)(Ne,{children:[Object(w.jsx)(ye,{nombretabla:"Proveedores",icono:"local_shipping",bgicono:"#3f51b5",namecolumnID:"id_proveedor",columnas:[{field:"id_proveedor",title:"ID"},{field:"ruc_proveedor",title:"Documento"},{field:"nombre_proveedor",title:"Nombre"},{field:"telefono_proveedor",title:"Contacto"}],filas:j,Acciones:function(e){var t=e.id,a=e.extraprops;return Object(w.jsxs)(we.a,{direction:"row",justifyContent:"center",spacing:1,children:[Object(w.jsx)(De.a,{variant:"round",color:"primary",size:"small",onClick:function(){var e=i.findIndex((function(e){return e.id_proveedor===t}));l(i[e]),d(!0)},children:Object(w.jsx)(ee.a,{children:"edit"})}),Object(w.jsx)(De.a,{variant:"round",color:"secondary",size:"small",onClick:function(){u(t,a)},children:Object(w.jsx)(ee.a,{children:"delete"})})]})},extraprops:"nombre_proveedor",search:b,cargando:s,showOptions:!0}),Object(w.jsx)("div",{})]})},hr=function(){return Object(w.jsxs)(mr,{children:[Object(w.jsx)(xr,{}),Object(w.jsx)(Or,{})]})},fr=function(){var e=I().DesLoguearse;return Object(c.useEffect)((function(){e()})),Object(w.jsx)(H.a,{to:"/"})},gr=Object(c.createContext)(),_r=function(e){var t=e.children,a=JSON.parse(localStorage.getItem("dataEmpresa")),n=I().token_user,o=Object(c.useState)(!0),i=Object(r.a)(o,2),s=i[0],u=i[1],j=Object(c.useState)(a||{id_empresa:"",nombre_empresa:"",propietario_empresa:"",ruc_empresa:"",telefono_empresa:"",direccion_empresa:"",licencia:"",categoria_empresa:""}),b=Object(r.a)(j,2),p=b[0],m=b[1],O=Object(c.useState)(!1),x=Object(r.a)(O,2),h=x[0],f=x[1],g=function(){var e=Object(d.a)(l.a.mark((function e(){var t,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u(!0),t={table:"empresas",data:p,token:n,id:p.id_empresa},localStorage.setItem("dataEmpresa",JSON.stringify(p)),e.next=5,k.update(t);case 5:"ok"===(a=e.sent).response?f(!0):console.log(a),u(!1);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),_=Object(c.useCallback)(Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==localStorage.getItem("dataEmpresa")){e.next=5;break}return e.next=3,k.get({table:"empresas"});case 3:"ok"===(t=e.sent).response&&t.found>0&&(m(t.results[0]),localStorage.setItem("dataEmpresa",JSON.stringify(t.results[0])));case 5:u(!1);case 6:case"end":return e.stop()}}),e)}))),[]);return Object(c.useEffect)((function(){var e=!0,t=new AbortController;return e&&_(),function(){e=!1,t.abort()}}),[_]),Object(w.jsx)(gr.Provider,{value:{cargando:s,setCargando:u,datosEmpresa:p,setDatosEmpresa:m,handleOnchange:function(e){var t=e.target,a=t.name,r=t.value;m(Object(Te.a)(Object(Te.a)({},p),{},Object(G.a)({},a,r)))},Guardar:g,snack:h,setSnack:f},children:t})},vr=function(){var e=function(){var e=Object(c.useContext)(gr);return{cargando:e.cargando,setCargando:e.setCargando,datosEmpresa:e.datosEmpresa,setDatosEmpresa:e.setDatosEmpresa,handleOnchange:e.handleOnchange,Guardar:e.Guardar,snack:e.snack,setSnack:e.setSnack}}(),t=e.datosEmpresa,a=e.snack,r=e.setSnack,n=e.Guardar,o=e.handleOnchange;return e.cargando?Object(w.jsx)(V,{}):Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(Ea.a,{anchorOrigin:{horizontal:"center",vertical:"top"},open:a,onClose:function(){r(!1)},autoHideDuration:3e3,children:Object(w.jsx)(de.a,{severity:"success",children:"Actualizado correctamente!"})}),Object(w.jsxs)(Z.a,{container:!0,spacing:2,children:[Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsxs)(de.a,{severity:"info",children:["Licencia v\xe1lida hasta: ",ue.fechaEsDMY(t.licencia)]})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:6,children:Object(w.jsx)(Fe.a,{autoFocus:!0,label:"Nombre de empresa",variant:"outlined",fullWidth:!0,helperText:"Fulanito de tal SRL",InputProps:{startAdornment:Object(w.jsx)(Ie.a,{position:"start",children:Object(w.jsx)(ee.a,{color:"primary",children:"info"})})},value:t.nombre_empresa,onChange:o,name:"nombre_empresa"})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:6,children:Object(w.jsx)(Fe.a,{label:"Propietario de empresa",variant:"outlined",fullWidth:!0,helperText:"Caso ser unipersonal, sino deje en blanco",InputProps:{startAdornment:Object(w.jsx)(Ie.a,{position:"start",children:Object(w.jsx)(ee.a,{color:"primary",children:"business_center"})})},value:t.propietario_empresa,onChange:o,name:"propietario_empresa"})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:6,children:Object(w.jsx)(Fe.a,{label:"Ruc de empresa",variant:"outlined",fullWidth:!0,InputProps:{startAdornment:Object(w.jsx)(Ie.a,{position:"start",children:Object(w.jsx)(ee.a,{color:"primary",children:"credit_card"})})},value:t.ruc_empresa,onChange:o,name:"ruc_empresa"})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:6,children:Object(w.jsx)(Fe.a,{label:"Direcci\xf3n de empresa",variant:"outlined",fullWidth:!0,InputProps:{startAdornment:Object(w.jsx)(Ie.a,{position:"start",children:Object(w.jsx)(ee.a,{color:"primary",children:"push_pin"})})},value:t.direccion_empresa,onChange:o,name:"direccion_empresa"})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:6,children:Object(w.jsx)(Fe.a,{label:"Tel\xe9fono de empresa",variant:"outlined",fullWidth:!0,InputProps:{startAdornment:Object(w.jsx)(Ie.a,{position:"start",children:Object(w.jsx)(ee.a,{color:"secondary",children:"phone"})})},value:t.telefono_empresa,onChange:o,name:"telefono_empresa"})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:6,children:Object(w.jsx)(Fe.a,{label:"Categoria",variant:"outlined",fullWidth:!0,InputProps:{startAdornment:Object(w.jsx)(Ie.a,{position:"start",children:Object(w.jsx)(ee.a,{color:"action",children:"category"})})},value:t.categoria_empresa,onChange:o,name:"categoria_empresa"})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:6,children:Object(w.jsx)(Fe.a,{label:"Dimension de ticket",variant:"outlined",helperText:"En mm",fullWidth:!0,type:"number",InputProps:{startAdornment:Object(w.jsx)(Ie.a,{position:"start",children:Object(w.jsx)(ee.a,{color:"secondary",children:"print"})})},value:t.dimension_ticket,onChange:o,name:"dimension_ticket"})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(ae.a,{size:"large",onClick:n,variant:"outlined",color:"primary",startIcon:Object(w.jsx)(ee.a,{color:"primary",children:"save"}),children:"Guardar"})})]})]})},Cr=function(){var e=Object(c.useState)(0),t=Object(r.a)(e,2),a=t[0],n=t[1],o=function(e){var t=e.children,r=e.index;return a===r&&Object(w.jsx)("div",{style:{marginTop:"25px"},children:t})};return Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(Na.a,{indicatorColor:"primary",textColor:"primary",value:a,onChange:function(e,t){n(t)},children:Object(w.jsx)(Ta.a,{label:"DATOS DE EMPRESA"})}),Object(w.jsx)(o,{value:a,index:0,children:Object(w.jsx)(vr,{})})]})},kr=function(){return Object(w.jsx)(_r,{children:Object(w.jsx)(Cr,{})})},Sr=Object(c.createContext)(),yr=function(){var e=Object(c.useContext)(Sr);return{id_user:e.id_user,token_user:e.token_user,cargas:e.cargas,setCargas:e.setCargas,dialogs:e.dialogs,setDialogs:e.setDialogs,datosFacturas:e.datosFacturas,indexFactura:e.indexFactura,inputCodigo:e.inputCodigo,inputCantidad:e.inputCantidad,cantidadRecibidaRef:e.cantidadRecibidaRef,verificarExisteEnTabla:e.verificarExisteEnTabla,errors:e.errors,setErrors:e.setErrors,initialErrors:e.initialErrors,Aguardar:e.Aguardar,Funciones:e.Funciones,setearIndexFactura:e.setearIndexFactura,setearFactura:e.setearFactura,CancelarFacturaActual:e.CancelarFacturaActual,borrarItem:e.borrarItem,cambiarPrecio:e.cambiarPrecio,openCambiarPrecio:e.openCambiarPrecio,openImagen:e.openImagen,indexPrecioCambiar:e.indexPrecioCambiar,setIndexPrecioCambiar:e.setIndexPrecioCambiar,AgregarCantidad:e.AgregarCantidad,consultarCliente:e.consultarCliente,changeInputsDatosFactura:e.changeInputsDatosFactura,verificarYEnviarFactura:e.verificarYEnviarFactura,cerrarDialogFactura:e.cerrarDialogFactura,insertarProductoTabla:e.insertarProductoTabla,restarCantidad:e.restarCantidad,sumarCantidad:e.sumarCantidad,AgregarCantidadMetodoPago:e.AgregarCantidadMetodoPago,borrarMetodoPago:e.borrarMetodoPago,changeMonedas:e.changeMonedas,Anotar:e.Anotar,CargarNota:e.CargarNota,permisos:e.permisos,cambiarDeposito:e.cambiarDeposito,MetodoDescuento:e.MetodoDescuento}},wr=function(e){var t=e.children,a=Object(c.useRef)(null),n=Object(c.useRef)(null),o=Object(c.useRef)(null),i=I(),s=i.token_user,u=i.id_user,j=i.permisos,b=JSON.parse(localStorage.getItem("facturasStorage")),p={error:!1,notFound:!1,notFoundMensaje:"",cambioPrecio:!1,cambioPrecioMensaje:"",cliente:!1,clienteMensaje:"",color:"error",mensaje:"",factura:{error:!1,errorMensaje:""}},m=Object(c.useState)(p),O=Object(r.a)(m,2),x=O[0],h=O[1],f={general:null===b,cargandoProducto:!1,items:!1,cargandoCliente:!1,finalizarVenta:null===b},g=Object(c.useState)(f),_=Object(r.a)(g,2),v=_[0],C=_[1],S=Object(c.useState)({main:!0,nota:!1,buscarProducto:!1,cambiarPrecio:!1,buscarCliente:!1,registrarCliente:!1,finalizarVenta:!1,imprimirTicket:!1,imprimirFactura:!1,imprimirPresupuesto:!1,ayuda:!1,cambioCliente:!1,abrirCaja:!1,imagen:!1}),F=Object(r.a)(S,2),P=F[0],A=F[1],D=Object(c.useState)(b?b.indexFactura:0),E=Object(r.a)(D,2),N=E[0],T=E[1],R={tipoCliente:"1",tipoFactura:"0",ordenCompra:"",id_caja:b&&1===b.listaCajas.length?b.listaCajas[0].id_caja:"",id_empleado:b&&1===b.listaVendedores.length?b.listaVendedores[0].id_empleado:"",obs_pago:"",id_formaPago:"1",formasPago:[],totalAbonado:0,cantidad_recibida:"",entregado_items:"1",retencion_iva_factura:"0",nro_factura:"0",fecha_factura:Et.getFechaActualString(),fecha_cobro_factura:Et.fechaActualYMD(),horario_factura:Et.getHorarioActualString(),valorMoneda:1},M={id_cliente:1,nombre_cliente:"SIN NOMBRE",direccion_cliente:"",ruc_cliente:"0"},L={facturas:[{itemsFactura:[],total:0,depositoActivo:b?b.facturas[N].depositoActivo:"",total_iva:0,descuento:0,guardado:!1,datosMoneda:{},datosFactura:R,datosCliente:M}],facturaActiva:!1,listaFacturas:[],indexFactura:N,listaFormasPago:[],listaMonedas:[],monedaActiva:{},depositoActivo:"",listaCajas:[],listaVendedores:[],listaDepositos:[]},W=Object(c.useState)(b||L),z=Object(r.a)(W,2),q=z[0],U=z[1],B=Object(c.useState)(-1),V=Object(r.a)(B,2),H=V[0],G=V[1],J=function(){var e=Object(d.a)(l.a.mark((function e(){var t,a,r,n,o,c,i,j,b,p,m,O,x,h,f,g,_,S,w,F,I;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=Object(Te.a)({},q),a=t.facturas[N],C(Object(Te.a)(Object(Te.a)({},v),{},{finalizarVenta:!0})),A(Object(Te.a)(Object(Te.a)({},P),{},{finalizarVenta:!1})),n=a.descuento,o=a.datosFactura.id_caja,"0"!==a.datosFactura.tipoFactura){e.next=13;break}return e.next=9,k.get({table:"empresa_recibos"});case 9:"ok"===(c=e.sent).response&&(r=c.results[0].last_nro_recibo,i=c.results[0].id_empresa_recibo,k.update({table:"empresa_recibos",token:s,id:i,data:{last_nro_recibo:parseInt(r)+1}})),e.next=27;break;case 13:return e.next=15,k.get({table:"empresa_facturas",where:"id_caja_empresa,=,".concat(o)});case 15:if("ok"!==(j=e.sent).response){e.next=27;break}if(r=parseInt(j.results[0].last_nro_factura),b=parseInt(j.results[0].nro_fin_factura),!(r>b)){e.next=25;break}return y()({text:"Talonario de facturas agotado"}),C(Object(Te.a)(Object(Te.a)({},v),{},{finalizarVenta:!1})),A(Object(Te.a)(Object(Te.a)({},P),{},{finalizarVenta:!0})),e.abrupt("return",!1);case 25:p=j.results[0].id_empresa_factura,k.update({table:"empresa_facturas",token:s,id:p,data:{last_nro_factura:parseInt(r)+1}});case 27:if(m=0,O=0,x="",0,f="0"===a.datosFactura.tipoFactura?"Venta recibo nro: ".concat(r,". "):"Venta contado factura: ".concat(r,". "),a.datosFactura.formasPago.forEach((function(e){"1"===e.id_forma_pago?(m+=e.cantidad,f+="Pago con efectivo ".concat(e.cantidad,". ")):(O+=e.cantidad,f+="Pago con ".concat(e.descripcion," ").concat(e.cantidad,". ")),x+=e.obs})),x+=n>0?" Descuento ".concat(n):"",h=m-a.total,m-=h,"1"!==a.datosFactura.tipoFactura&&"0"!==a.datosFactura.tipoFactura){e.next=44;break}if(g=[k.insert({table:"cajas_movimientos",token:s,data:{id_user_movimiento:u,id_caja_movimiento:a.datosFactura.id_caja,id_tipo_registro:1,monto_movimiento:m,monto_sin_efectivo:O,detalles_movimiento:f,fecha_movimiento:Et.getFechaHorarioString()}})],n>0&&g.push(k.insert({table:"cajas_movimientos",token:s,data:{id_user_movimiento:u,id_caja_movimiento:a.datosFactura.id_caja,id_tipo_registro:17,monto_movimiento:n,monto_sin_efectivo:0,detalles_movimiento:"Descuento de venta de ".concat(n),fecha_movimiento:Et.getFechaHorarioString()}})),Promise.all(g),"1"!==a.datosFactura.id_formaPago){e.next=44;break}return e.next=41,k.get({table:"cajas",fields:"monto_caja",where:"id_caja,=,".concat(a.datosFactura.id_caja)});case 41:_=e.sent,S=m+parseFloat(_.results[0].monto_caja)-n,k.update({table:"cajas",token:s,data:{monto_caja:S,ult_mov_caja:Et.getFechaHorarioString()},id:a.datosFactura.id_caja});case 44:return w={id_cliente_factura:a.datosCliente.id_cliente,id_user_factura:u,id_caja_factura:a.datosFactura.id_caja,id_empleado_factura:a.datosFactura.id_empleado,id_forma_pago_factura:a.datosFactura.id_formaPago,id_moneda_factura:a.datosMoneda.id_moneda,valor_moneda_factura:a.datosMoneda.valor_moneda,nro_factura:parseInt(r),fecha_factura:Et.fechaActualYMD()+" "+Et.getHorarioActualString(),fecha_cobro_factura:a.datosFactura.fecha_cobro_factura+" "+Et.getHorarioActualString(),estado_factura:"2"===a.datosFactura.tipoFactura?2:1,tipo_factura:a.datosFactura.tipoFactura,recibido_factura:"2"===a.datosFactura.tipoFactura?0:a.datosFactura.totalAbonado,monto_total_factura:a.total,iva_factura:a.total_iva,obs_factura:x,retencion_iva_factura:a.datosFactura.retencion_iva_factura,orden_compra:a.datosFactura.ordenCompra,descuento_factura:n},e.next=47,k.insert({table:"facturas",data:w,token:s});case 47:"ok"===(F=e.sent).response?(I=F.last_id,a.itemsFactura.forEach(function(){var e=Object(d.a)(l.a.mark((function e(t){var r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:k.insert({table:"facturas_items",token:s,data:{id_items_factura:I,id_impuesto_factura:t.id_impuesto,id_producto_factura:t.id_producto,cantidad_producto:t.cantidad_producto,precio_producto_factura:t.precio_guardado,porcentaje_comision_factura:t.porcentaje_comision,entregado_item:"2"===t.tipo_producto?"2":a.datosFactura.entregado_items}}),"1"===a.datosFactura.entregado_items&&1===t.tipo_producto&&(r=parseFloat(t.stock_producto)-parseFloat(t.cantidad_producto),k.update({table:"productos_depositos",data:{stock_producto_deposito:r},id:t.id_productos_deposito,token:s}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())):console.log(F),t.facturas[N].datosFactura.nro_factura=parseInt(r),ae(t),C(Object(Te.a)(Object(Te.a)({},v),{},{finalizarVenta:!1})),"0"===a.datosFactura.tipoFactura?A(Object(Te.a)(Object(Te.a)({},P),{},{imprimirTicket:!0,finalizarVenta:!1})):A(Object(Te.a)(Object(Te.a)({},P),{},{imprimirFactura:!0,finalizarVenta:!1}));case 53:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Y=function(){var e=Object(d.a)(l.a.mark((function e(t){var a,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(C(Object(Te.a)(Object(Te.a)({},v),{},{cargandoCliente:!0})),a={id_cliente:"1",nombre_cliente:"SIN NOMBRE",direccion_cliente:"",ruc_cliente:"0"},""!==t){e.next=6;break}K(a),e.next=10;break;case 6:return e.next=8,k.get({table:"clientes",where:"ruc_cliente,=,'".concat(t,"'"),fields:"id_cliente,nombre_cliente,ruc_cliente,direccion_cliente"});case 8:"ok"===(r=e.sent).response&&(r.found>0?K(r.results[0]):(K(a),h(Object(Te.a)(Object(Te.a)({},x),{},{error:!0,mensaje:"Cliente no registrado",cliente:!0,clienteMensaje:"Cliente no registrado"}))));case 10:C(Object(Te.a)(Object(Te.a)({},v),{},{cargandoCliente:!1}));case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),K=function(e){var t=Object(Te.a)({},q);t.facturas[N].datosCliente=e,ae(t),h(Object(Te.a)(Object(Te.a)({},x),{},{error:!1,mensaje:"",cliente:!1,clienteMensaje:""}))},X=function(){var e=Object(d.a)(l.a.mark((function e(t){var r,n,o,c,i,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Object(Te.a)({},q),C(Object(Te.a)(Object(Te.a)({},v),{},{items:!0})),A(Object(Te.a)(Object(Te.a)({},P),{},{nota:!1})),e.next=5,Promise.all([k.get({table:"notas_pedidos",include:"clientes",on:"id_cliente,id_cliente_pedido",where:"id_notas_pedido,=,".concat(t)}),k.get({table:"notas_items",include:"productos,impuestos",on:"id_producto,id_producto_item,id_impuesto_producto,id_impuesto",where:"id_notas_pedido_item,=,".concat(t)})]);case 5:o=e.sent,c=o[0],i=o[1],c.found>0&&"ok"===c.response&&i.found>0&&"ok"===i.response?(n.facturas[N].depositoActivo=c.results[0].id_deposito_pedido,i.results.forEach((function(e){$(e,parseFloat(e.cantidad_item))})),s=c.results[0],n.facturas[N].datosCliente={id_cliente:s.id_cliente,nombre_cliente:s.nombre_cliente,ruc_cliente:s.ruc_cliente,direccion_cliente:s.direccion_cliente},n.facturas[N].datosFactura.id_empleado=s.id_empleado_pedido,ae(n)):h(Object(Te.a)(Object(Te.a)({},x),{},{color:"error",mensaje:"No hay nota con ese n\xfamero.",error:!0})),C(Object(Te.a)(Object(Te.a)({},v),{},{items:!1})),null===(r=a.current)||void 0===r||r.focus();case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Q=function(){var e=Object(d.a)(l.a.mark((function e(){var t,a,r,n,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!((t=Object(Te.a)({},q.facturas[N])).itemsFactura.length>0)){e.next=7;break}return a={id_deposito_pedido:t.depositoActivo,id_cliente_pedido:t.datosCliente.id_cliente,id_empleado_pedido:t.datosFactura.id_empleado,fecha_pedido:Et.getFechaHorarioString()},e.next=5,k.insert({token:s,table:"notas_pedidos",data:a});case 5:"ok"===(r=e.sent).response?(n=r.last_id,o=[],t.itemsFactura.forEach(function(){var e=Object(d.a)(l.a.mark((function e(t){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a={id_notas_pedido_item:n,id_producto_item:t.id_producto,precio_guardado:t.precio_guardado,cantidad_item:t.cantidad_producto},o.push(k.insert({table:"notas_items",token:s,data:a}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),Promise.all(o),h(Object(Te.a)(Object(Te.a)({},x),{},{color:"success",mensaje:"Nota nro: "+r.last_id+" generada existosamente",error:!0}))):console.log(r);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Z=function(){var e=Object(d.a)(l.a.mark((function e(t){var a,r,n,o,c,i,s,d;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Object(Te.a)({},q.facturas[N]),C(Object(Te.a)(Object(Te.a)({},v),{},{cargandoProducto:!0})),e.next=4,Promise.all([k.get({table:"productos",include:"impuestos,productos_depositos",on:"id_impuesto_producto,id_impuesto,id_producto,id_producto_deposito",where:"codigo_producto,=,'".concat(t,"',and,id_deposito_deposito,=,").concat(a.depositoActivo)}),k.get({table:"productos",include:"impuestos,productos_images",on:"id_impuesto_producto,id_impuesto,id_producto,id_image_producto",where:"codigo_producto,=,'".concat(t,"'")}),k.get({table:"productos",include:"impuestos",on:"id_impuesto_producto,id_impuesto",where:"codigo_producto,=,'".concat(t,"',and,tipo_producto,=,2")})]);case 4:r=e.sent,n=r[0],o=r[1],c=r[2],"ok"===n.response?n.found>0||c.found>0?"1"===(null===(i=n.results[0])||void 0===i?void 0:i.tipo_producto)&&(null===(s=n.results[0])||void 0===s?void 0:s.stock_producto_deposito)<=0?h(Object(Te.a)(Object(Te.a)({},x),{},{error:!0,mensaje:"No hay stock de ".concat(n.results[0].nombre_producto," en el deposito")})):(d=o.found>0?o.results[0]:n.found>0?n.results[0]:c.results[0],$(d)):h(Object(Te.a)(Object(Te.a)({},x),{},{error:!0,mensaje:"Producto no registrado con ese c\xf3digo o sin stock"})):console.log(n),C(Object(Te.a)(Object(Te.a)({},v),{},{cargandoProducto:!1}));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),$=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=t||parseFloat(n.current.value),r=parseFloat(e.precio_producto)*a,o=parseFloat(e.porcentaje_impuesto),c=parseInt(e.porcentaje_comision),i={codigo_producto:e.codigo_producto,nombre_producto:e.nombre_producto,precio_producto:parseFloat(e.precio_producto),precio_guardado:parseFloat(e.precio_producto),cantidad_producto:a,id_productos_deposito:e.id_productos_deposito,iva_porcentaje:o,iva_total_producto:r*o/(100+o),subtotal_precio:r,stock_producto:parseFloat(e.stock_producto_deposito),costo_producto:parseFloat(e.costo_producto),preciom_producto:parseFloat(e.preciom_producto),precio_original:parseFloat(e.precio_producto),tipo_producto:parseInt(e.tipo_producto),porcentaje_comision:c,comision_producto:r*c/100,id_impuesto:e.id_impuesto,id_producto:e.id_producto,url_imagen:(null===e||void 0===e?void 0:e.url_imagen)?e.url_imagen:""},s=Object(Te.a)({},q);s.facturas[N].itemsFactura.push(i),ee(s),n.current.value="1"},ee=function(e){var t=0,a=0;e.facturas[N].itemsFactura.forEach((function(e){t+=e.subtotal_precio,a+=e.iva_total_producto})),e.facturas[N].total=t,e.facturas[N].total_iva=a,ae(e)},te=function(e,t){var a=Object(Te.a)({},q),r=a.facturas[N].itemsFactura[t].iva_porcentaje,n=a.facturas[N].itemsFactura[t].precio_guardado*parseFloat(e);a.facturas[N].itemsFactura[t].cantidad_producto=parseFloat(e),a.facturas[N].itemsFactura[t].subtotal_precio=n,a.facturas[N].itemsFactura[t].iva_total_producto=n*r/(100+r),ee(a)},ae=function(e){U(e);var t=JSON.stringify(e);localStorage.setItem("facturasStorage",t)},re=function(e){var t=e.deposito,r=void 0===t?"":t,n=Object(Te.a)({},q);n.facturas[N].guardado=!0,n.indexFactura=N+1;var o=r||n.facturas[N].depositoActivo;n.facturas.push({itemsFactura:[],depositoActivo:o,total:0,descuento:0,total_iva:0,fecha_factura:Et.getFechaActualString(),horario_factura:Et.getHorarioActualString(),guardado:!1,datosMoneda:n.monedaActiva,datosFactura:R,datosCliente:M}),T(N+1),G(-1),ae(n),a.current.focus()},ne=Object(c.useCallback)(Object(d.a)(l.a.mark((function e(){var t,a,r,n,o,c,i,s,d,j,b,p,m,O;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==localStorage.getItem("facturasStorage")){e.next=34;break}return e.next=3,Promise.all([k.get({table:"cajas",include:"cajas_users",on:"id_caja,id_caja_caja",where:"id_user_caja,=,".concat(u)}),k.get({table:"monedas"}),k.get({table:"facturas_formas_pagos"}),k.get({table:"empleados",fields:"id_empleado,nombre_empleado,apellido_empleado"}),k.get({table:"depositos",where:"tipo_deposito,=,1"})]);case 3:if(t=e.sent,a=t[4],r=t[3],n=t[2],o=t[1],c=t[0],i=!1,s=[],"ok"!==t[0].response){e.next=27;break}if(!(t[0].found<1)){e.next=17;break}return y()({text:"Debe habilitar una caja.",icon:"warning"}).then((function(){Et.goto("cajas?dialog=new")})),e.abrupt("return",!1);case 17:if(1!==parseInt(t[0].results[0].estado_caja)){e.next=25;break}return d=t[0].results[0].id_caja,e.next=21,k.get({table:"empresa_facturas",where:"id_caja_empresa,=,".concat(d)});case 21:(j=e.sent).found>0&&(i=!0,s=j.results),e.next=27;break;case 25:return y()({text:"Debe abrir caja.",icon:"warning"}).then((function(){Et.goto("cajas?dialog=open&id=".concat(t[0].results[0].id_caja))})),e.abrupt("return",!1);case 27:"ok"===o.response&&(b=o.results.filter((function(e){return"1"===e.activo_moneda}))),"ok"===a.response&&(p=a.results.length>0?a.results[0].id_deposito:"0"),m={facturas:[{itemsFactura:[],total:0,total_iva:0,descuento:0,guardado:!1,datosMoneda:b.length>0?b[0]:{},depositoActivo:p,datosFactura:{tipoCliente:"1",tipoFactura:"0",ordenCompra:"",id_caja:"ok"===c.response&&1===c.found?c.results[0].id_caja:"",id_empleado:"ok"===r.response&&1===r.found?r.results[0].id_empleado:"",obs_pago:"",id_formaPago:"1",cantidad_recibida:"",totalAbonado:0,formasPago:[],entregado_items:"1",retencion_iva_factura:"0",nro_factura:"0",fecha_factura:Et.getFechaActualString(),fecha_cobro_factura:Et.fechaActualYMD(),horario_factura:Et.getHorarioActualString(),valorMoneda:1},datosCliente:{id_cliente:1,nombre_cliente:"SIN NOMBRE",direccion_cliente:"",ruc_cliente:"0"}}],facturaActiva:i,indexFactura:0,listaFormasPago:"ok"===n.response?n.results:[],listaMonedas:"ok"===o.response?o.results:[],monedaActiva:b.length>0?b[0]:{},listaCajas:"ok"===c.response?c.results:[],listaFacturas:s,listaVendedores:"ok"===r.response?r.results:[],listaDepositos:"ok"===a.response?a.results:[]},U(m),O=JSON.stringify(m),localStorage.setItem("facturasStorage",O),C({general:!1,cargandoProducto:!1,cargandoCliente:!1,finalizarVenta:!1,cargandoItem:!1});case 34:case"end":return e.stop()}}),e)}))),[u]);return Object(c.useEffect)((function(){var e=!0,t=new AbortController;e&&ne();return function(){var e;0===q.facturas[N].itemsFactura.length&&(null===(e=a.current)||void 0===e||e.focus())}(),function(){e=!1,t.abort()}}),[ne,q,N]),Object(w.jsx)(Sr.Provider,{value:{id_user:u,token_user:s,cargas:v,setCargas:C,dialogs:P,setDialogs:A,datosFacturas:q,indexFactura:N,inputCodigo:a,inputCantidad:n,cantidadRecibidaRef:o,verificarExisteEnTabla:function(e){if(""!==e){var t=Object(Qe.a)(q.facturas[N].itemsFactura),r=t.findIndex((function(t){return t.codigo_producto.toLowerCase()===e.toLowerCase()}));if(t.filter((function(t){return t.codigo_producto.toLowerCase()===e.toLowerCase()})).length>0){var o=parseFloat(n.current.value)+t[r].cantidad_producto,c=t[r].stock_producto;c>=o?te(o,r):h(Object(Te.a)(Object(Te.a)({},x),{},{error:!0,mensaje:"Cantidad limitada de stock en ".concat(c),color:"error"})),n.current.value=1}else Z(e)}else h(Object(Te.a)(Object(Te.a)({},x),{},{error:!0,mensaje:"Ingrese el c\xf3digo del producto",color:"error"})),a.current.focus();a.current.value="",a.current.focus()},errors:x,setErrors:h,initialErrors:p,Aguardar:re,Funciones:Et,setearIndexFactura:function(e){var t,r=Object(Te.a)({},q);0===r.facturas[N].itemsFactura.length?(r.facturas.splice(N,1),1===r.facturas.length&&(e=0)):r.facturas[N].guardado=!0,r.indexFactura=e,T(e),ae(r),null===a||void 0===a||null===(t=a.current)||void 0===t||t.focus()},setearFactura:ae,CancelarFacturaActual:function(){var e=Object(Te.a)({},q);G(-1),h(p),n.current.value=1,e.facturas[N].itemsFactura=[],e.facturas[N].datosFactura=R,e.facturas[N].datosCliente=M,ee(e),a.current.focus()},borrarItem:function(e){var t=Object(Te.a)({},q);t.facturas[N].itemsFactura.splice(e,1),ee(t)},cambiarPrecio:function(e,t){var r=Object(Te.a)({},q),n=r.facturas[N].itemsFactura[e],o=t*n.cantidad_producto,c=n.iva_porcentaje;n.precio_guardado=t,n.subtotal_precio=o,n.iva_total_producto=o*c/(100+c),ee(r),a.current.focus()},openCambiarPrecio:function(e){G(e),A(Object(Te.a)(Object(Te.a)({},P),{},{cambiarPrecio:!0}))},openImagen:function(e){G(e),A(Object(Te.a)(Object(Te.a)({},P),{},{imagen:!0}))},indexPrecioCambiar:H,setIndexPrecioCambiar:G,AgregarCantidad:te,consultarCliente:Y,changeInputsDatosFactura:function(e){var t=e.target,a=t.name,r=t.value,n=Object(Te.a)({},q);n.facturas[N].datosFactura[a]=r,ae(n)},verificarYEnviarFactura:J,cerrarDialogFactura:function(){var e=Object(Te.a)({},q);N>0?(e.facturas.splice(N,1),T(N-1)):(T(0),G(-1),e.facturas[0]={itemsFactura:[],total:0,descuento:0,total_iva:0,fecha_factura:Et.getFechaActualString(),horario_factura:Et.getHorarioActualString(),guardado:!1,datosMoneda:e.monedaActiva,depositoActivo:e.facturas[0].depositoActivo,datosFactura:R,datosCliente:M}),ae(e),a.current.focus()},insertarProductoTabla:$,restarCantidad:function(e,t){var a=Object(Te.a)({},q),r=e-1;if(r>0){var n=a.facturas[N].itemsFactura[t],o=n.iva_porcentaje,c=n.precio_guardado*parseFloat(r);n.cantidad_producto=parseFloat(r),n.subtotal_precio=c,n.iva_total_producto=c*o/(100+o),ee(a)}},sumarCantidad:function(e,t){var a=Object(Te.a)({},q),r=e+1,n=a.facturas[N].itemsFactura[t];if(n.stock_producto>e||2===n.tipo_producto){var o=n.iva_porcentaje,c=n.precio_guardado*parseFloat(r);n.cantidad_producto=parseFloat(r),n.subtotal_precio=c,n.iva_total_producto=c*o/(100+o),ee(a)}else h(Object(Te.a)(Object(Te.a)({},x),{},{error:!0,color:"error",mensaje:"Cantidad m\xe1xima en stock",notFound:!0,notFoundMensaje:"Cantidad m\xe1xima en stock."}))},AgregarCantidadMetodoPago:function(){var e=parseFloat(Et.ComaPorPunto(Et.SacarPunto(o.current.value))),t=Object(Te.a)({},q),a=t.facturas[N].datosFactura,r=t.listaFormasPago,n=Object(Te.a)({},x);if(!isNaN(e)||e>0){var c=e*parseFloat(t.facturas[N].datosMoneda.valor_moneda);if(0===a.formasPago.filter((function(e){return e.id_forma_pago===a.id_formaPago})).length){var i=r.filter((function(e){return e.id_facturas_formas_pago===a.id_formaPago}));a.totalAbonado+=isNaN(c)?0:parseFloat(c),a.formasPago.push({id_forma_pago:a.id_formaPago,obs:a.obs_pago,cantidad:isNaN(c)?0:parseFloat(c),descripcion:i[0].descripcion_forma_pago||""}),n.factura.error=!1,n.factura.errorMensaje=""}else n.factura.error=!0,n.factura.errorMensaje="Ese m\xe9todo de pago ya esta en la lista. Elija otro o mofique el m\xe9todo."}else n.factura.error=!0,n.factura.errorMensaje="Ingrese la cantidad";h(n),a.obs_pago="",a.cantidad_recibida="",ae(t),o.current.focus()},borrarMetodoPago:function(e,t){var a=Object(Te.a)({},q),r=a.facturas[N].datosFactura;r.totalAbonado-=t,r.formasPago.splice(e,1),h(p),ae(a)},changeMonedas:function(e){var t=Object(Te.a)({},q);t.facturas[N].datosMoneda=e,ae(t)},Anotar:Q,CargarNota:X,permisos:j,cambiarDeposito:function(e){var t=Object(Te.a)({},q);t.facturas[N].itemsFactura.length>0?re({deposito:e}):(t.facturas[N].depositoActivo=e,ae(t))},MetodoDescuento:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=parseFloat(e),r=0,n=Object(Te.a)({},q),o=n.facturas[N].total;isNaN(a)||(r=t?o*a/100:e),n.facturas[N].descuento=r,ae(n)}},children:t})},Fr=function(){var e=yr(),t=e.dialogs,a=e.setDialogs,r=function(){a(Object(Te.a)(Object(Te.a)({},t),{},{ayuda:!1}))};return Object(w.jsxs)(ze.a,{open:t.ayuda,fullWidth:!0,onClose:r,children:[Object(w.jsx)(qe.a,{children:"Ayuda"}),Object(w.jsxs)(Ue.a,{children:[Object(w.jsx)("h3",{children:"General: "}),Object(w.jsxs)("p",{children:["Ingrese el c\xf3digo de barras del producto o solo el c\xf3digo asignado al producto. Si no conoce el c\xf3digo del producto presione ",Object(w.jsx)("i",{children:'"CTRL + B"'})," para buscarlo "]}),Object(w.jsxs)("p",{children:["Para salir al men\xfa principal presione el bot\xf3n superior izquierdo ",Object(w.jsx)(ee.a,{color:"secondary",children:"arrow_back_ios"})," "]}),Object(w.jsx)("h3",{children:"Atajos de teclado: "}),Object(w.jsxs)("p",{children:[Object(w.jsx)("b",{children:"CTRL + b"})," : ",Object(w.jsx)("i",{children:"Buscar producto"})]}),Object(w.jsxs)("p",{children:[Object(w.jsx)("b",{children:"CTRL + m"})," : ",Object(w.jsx)("i",{children:"Enfocar en campo de c\xf3digo"})]}),Object(w.jsxs)("p",{children:[Object(w.jsx)("b",{children:"CTRL + i"})," : ",Object(w.jsx)("i",{children:"Para finalizar la venta"})]}),Object(w.jsx)("h3",{children:"Para m\xe1s informaci\xf3n llame al; 0983 20 20 90"})]}),Object(w.jsx)(Ye.a,{children:Object(w.jsx)(ae.a,{variant:"outlined",onClick:r,children:"Ok"})})]})},Ir=function(){var e=yr(),t=e.dialogs,a=e.setDialogs,n=e.datosFacturas,o=e.indexFactura,s=e.setearFactura,u=e.setErrors,j=e.errors,b=Object(c.useState)([]),p=Object(r.a)(b,2),m=p[0],O=p[1],x=Object(c.useState)(!1),h=Object(r.a)(x,2),f=h[0],g=h[1],_=Object(c.useRef)(null),v=function(){return a(Object(Te.a)(Object(Te.a)({},t),{},{buscarCliente:!1}))},C=Object(c.useCallback)(function(){var e=Object(d.a)(l.a.mark((function e(t){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:""!==(a=t.target.value)?(g(!0),setTimeout(Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.get({table:"clientes",filtersSearch:a,filtersField:"nombre_cliente,ruc_cliente",pagesize:"10"});case 2:"ok"===(t=e.sent).response?O(t.results):console.log(t);case 4:case"end":return e.stop()}}),e)}))),500)):O([]),g(!1);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[]);return Object(w.jsxs)(ze.a,{fullWidth:!0,open:t.buscarCliente,onClose:v,children:[Object(w.jsx)(qe.a,{children:"Buscar cliente por nombre"}),Object(w.jsx)(Ue.a,{dividers:!0,children:Object(w.jsx)(sr.a,{loading:f,loadingText:"Cargando...",noOptionsText:"No hay clientes con ese nombre",onChange:function(e,t){var a=t,r=Object(Te.a)({},n);r.facturas[o].datosCliente.id_cliente=a.id_cliente,r.facturas[o].datosCliente.ruc_cliente=a.ruc_cliente,r.facturas[o].datosCliente.nombre_cliente=a.nombre_cliente,r.facturas[o].datosCliente.direccion_cliente=a.direccion_cliente,u(Object(Te.a)(Object(Te.a)({},j),{},{error:!1,mensaje:"",cliente:!1,clienteMensaje:""})),s(r),v()},disableClearable:!0,options:m,getOptionLabel:function(e){return e.nombre_cliente+" "+e.ruc_cliente},fullWidth:!0,renderInput:function(e){return Object(w.jsx)(Fe.a,Object(Te.a)(Object(Te.a)({},e),{},{autoFocus:!0,label:"Buscar cliente",inputRef:_,onChange:C,InputProps:Object(Te.a)(Object(Te.a)({},e.InputProps),{},{endAdornment:Object(w.jsxs)(i.a.Fragment,{children:[f?Object(w.jsx)(U.a,{color:"inherit",size:20}):null,e.InputProps.endAdornment]})}),fullWidth:!0,placeholder:"Escriba el nombre del cliente",variant:"outlined"}))}})}),Object(w.jsx)(Ye.a,{children:Object(w.jsx)(ae.a,{onClick:v,variant:"outlined",color:"primary",children:"Cerrar"})})]})},Pr=function(){var e=yr(),t=e.dialogs,a=e.setDialogs,n=e.datosFacturas,o=e.indexFactura,s=e.insertarProductoTabla,u=e.AgregarCantidad,j=e.inputCantidad,b=Object(c.useState)(!1),p=Object(r.a)(b,2),m=p[0],O=p[1],x=Object(c.useState)(!1),h=Object(r.a)(x,2),f=h[0],g=h[1],_=Object(c.useState)([]),v=Object(r.a)(_,2),C=v[0],S=v[1],F=Object(Te.a)({},n),I=function(){var e=Object(d.a)(l.a.mark((function e(t,a){var r,n,c,i,d,b,p,m,O,x;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=a.codigo_producto,n=parseInt(a.tipo_producto),c=F.facturas[o].depositoActivo,i=parseFloat(j.current.value),d=F.facturas[o].itemsFactura,b=d.findIndex((function(e){return e.codigo_producto.toLowerCase()===r.toLowerCase()})),!((p=d.filter((function(e){return e.codigo_producto.toLowerCase()===r.toLowerCase()}))).length>0)){e.next=12;break}i+=d[b].cantidad_producto,1===n?i<=p[0].stock_producto?u(i,b):y()({text:"No hay suficiente stock."}):u(i,b),e.next=23;break;case 12:if(g(!0),1!==n){e.next=22;break}return e.next=16,Promise.all([k.get({table:"productos",include:"impuestos,productos_images,productos_depositos",on:"id_impuesto_producto,id_impuesto,id_producto,id_image_producto,id_producto,id_producto_deposito",where:"codigo_producto,=,'".concat(r,"',and,id_deposito_deposito,=,").concat(c)}),k.get({table:"productos",include:"impuestos,productos_depositos",on:"id_impuesto_producto,id_impuesto,id_producto,id_producto_deposito",where:"id_deposito_deposito,=,".concat(c,",and,codigo_producto,='").concat(r,"'")})]);case 16:m=e.sent,O=m[0],x=m[1],"ok"===O.response&&O.found>0?i<=parseFloat(x.results[0].stock_producto_deposito)?s(O.results[0]):y()({text:"No hay ".concat(i," en stock")}):"ok"===x.response&&x.found>0?i<=parseFloat(x.results[0].stock_producto_deposito)?s(x.results[0]):y()({text:"No hay ".concat(i," en stock")}):y()({text:"Sin stock en el deposito."}),e.next=23;break;case 22:s(a);case 23:P();case 24:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),P=function(){a(Object(Te.a)(Object(Te.a)({},t),{},{buscarProducto:!1})),g(!1)},A=Object(c.useCallback)(function(){var e=Object(d.a)(l.a.mark((function e(t){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:""!==(a=t.target.value)&&a.length>0?(O(!0),setTimeout(Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([k.get({table:"productos",include:"impuestos",on:"id_impuesto_producto,id_impuesto",filtersField:"nombre_producto,codigo_producto",filtersSearch:a,pagesize:"20"})]);case 2:t=e.sent,S(t[0].results);case 4:case"end":return e.stop()}}),e)}))),500)):S([]),O(!1);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[]);return Object(w.jsxs)(ze.a,{fullWidth:!0,open:t.buscarProducto,onClose:P,children:[Object(w.jsx)(qe.a,{children:"Buscar producto"}),Object(w.jsx)(Ue.a,{dividers:!0,children:Object(w.jsx)(Z.a,{container:!0,spacing:2,children:Object(w.jsx)(Z.a,{item:!0,xs:12,children:f?Object(w.jsx)(U.a,{}):Object(w.jsx)(sr.a,{loadingText:"Cargando...",loading:m,noOptionsText:"Sin productos en lista...",onChange:I,disableClearable:!0,autoComplete:!0,autoHighlight:!0,autoSelect:!0,options:C,getOptionLabel:function(e){return e.nombre_producto+" - "+e.codigo_producto},fullWidth:!0,renderInput:function(e){return Object(w.jsx)(Fe.a,Object(Te.a)(Object(Te.a)({},e),{},{autoFocus:!0,label:"Buscar producto",InputProps:Object(Te.a)(Object(Te.a)({},e.InputProps),{},{endAdornment:Object(w.jsxs)(i.a.Fragment,{children:[m?Object(w.jsx)(U.a,{color:"inherit",size:20}):null,e.InputProps.endAdornment]})}),onChange:A,fullWidth:!0,placeholder:"Escriba el nombre del producto",variant:"outlined"}))}})})})}),Object(w.jsx)(Ye.a,{children:Object(w.jsx)(ae.a,{onClick:P,variant:"outlined",color:"primary",children:"Cerrar"})})]})},Ar=a(880),Dr=function(){var e=yr(),t=e.dialogs,a=e.setDialogs,r=e.datosFacturas,n=e.indexFactura,o=e.cargas,i=e.consultarCliente,s=e.errors,l=Object(c.useRef)(null),d=r.facturas[n],u=function(){a(Object(Te.a)(Object(Te.a)({},t),{},{cambioCliente:!1}))};return Object(w.jsxs)(ze.a,{open:t.cambioCliente,onClose:u,fullWidth:!0,children:[Object(w.jsx)(qe.a,{children:"Cliente"}),Object(w.jsx)(Ue.a,{dividers:!0,children:Object(w.jsxs)(Z.a,{container:!0,spacing:2,children:[Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(Fe.a,{onKeyPress:function(e){"Enter"===e.key&&i(l.current.value)},label:"Documento de cliente",placeholder:"Documento de cliente",fullWidth:!0,inputRef:l,variant:"outlined",autoFocus:!0,InputProps:{startAdornment:Object(w.jsx)(Ie.a,{position:"start",children:o.cargandoCliente?Object(w.jsx)(U.a,{size:24}):Object(w.jsx)(Ae.a,{TransitionComponent:yt.a,arrow:!0,title:Object(w.jsx)("h2",{children:"Buscar cliente"}),children:Object(w.jsx)(Pe.a,{onClick:function(){return a(Object(Te.a)(Object(Te.a)({},t),{},{buscarCliente:!0}))},children:Object(w.jsx)(ee.a,{children:"search"})})})}),endAdornment:Object(w.jsx)(Ae.a,{TransitionComponent:yt.a,arrow:!0,title:Object(w.jsx)("h2",{children:"Registrar cliente"}),children:Object(w.jsx)(Pe.a,{onClick:function(){a(Object(Te.a)(Object(Te.a)({},t),{},{registrarCliente:!0}))},children:Object(w.jsx)(ee.a,{color:"primary",children:"person_add_alt_1"})})})}})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsxs)(de.a,{severity:s.cliente?"error":"info",icon:!1,variant:"outlined",children:[Object(w.jsxs)(Ar.a,{children:["DOC: ",d.datosCliente.ruc_cliente," ",Object(w.jsx)("br",{}),"NOMBRE: ",d.datosCliente.nombre_cliente]}),Object(w.jsx)(Ar.a,{children:s.clienteMensaje})]})})]})}),Object(w.jsx)(Ye.a,{children:Object(w.jsx)(ae.a,{onClick:u,variant:"outlined",children:"Cerrar"})})]})},Er=function(){var e=yr(),t=e.dialogs,a=e.setDialogs,n=e.datosFacturas,o=e.indexFactura,i=e.indexPrecioCambiar,s=e.Funciones,l=e.errors,d=e.setErrors,u=e.cambiarPrecio,j=e.setIndexPrecioCambiar,b=function(){a(Object(Te.a)(Object(Te.a)({},t),{},{cambiarPrecio:!1})),d(Object(Te.a)(Object(Te.a)({},l),{},{cambioPrecio:!1,cambioPrecioMensaje:""})),j(-1)},p=Object(c.useRef)(null),m=Object(c.useState)(""),O=Object(r.a)(m,2),x=O[0],h=O[1],f=n.facturas[o],g=i<0?null:f.itemsFactura[i],_=function(){var e=parseFloat(x)*parseFloat(f.datosMoneda.valor_moneda);e<g.preciom_producto?(d(Object(Te.a)(Object(Te.a)({},l),{},{cambioPrecio:!0,cambioPrecioMensaje:"El precio no puede ser menor que el establecido"})),p.current.focus()):(u(i,e),b())};return Object(w.jsx)(w.Fragment,{children:i>=0&&Object(w.jsx)("form",{onSubmit:_,children:Object(w.jsxs)(ze.a,{fullWidth:!0,open:t.cambiarPrecio,onClose:b,TransitionComponent:yt.a,children:[Object(w.jsx)(qe.a,{children:"Cambiar de precio"}),Object(w.jsx)(Ue.a,{children:Object(w.jsxs)(Z.a,{container:!0,spacing:2,children:[Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsxs)(te.a,{variant:"body1",children:["Precio original: ",s.numberSeparator(g.precio_original)," ",f.datosMoneda.abreviatura_moneda]})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsxs)(te.a,{variant:"body1",children:["Precio mayorista: ",s.numberSeparator(g.preciom_producto)," ",f.datosMoneda.abreviatura_moneda]})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsxs)(te.a,{variant:"body1",children:["Precio actual: ",s.numberSeparator(g.precio_guardado)," ",f.datosMoneda.abreviatura_moneda]})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(At,{inputRef:p,onKeyPress:function(e){return"Enter"===e.key&&_()},onChange:function(e){h(e.target.value)},autoComplete:"off",InputProps:{startAdornment:Object(w.jsx)(Ie.a,{position:"start",children:f.datosMoneda.abreviatura_moneda}),inputComponent:Va,inputProps:{min:0}},fullWidth:!0,name:"precio_nuevo",error:l.cambioPrecio,helperText:l.cambioPrecioMensaje,label:"Nuevo precio de venta",autoFocus:!0})})]})}),Object(w.jsxs)(Ye.a,{children:[Object(w.jsx)(Dt,{variant:"outlined",color:"primary",onClick:_,children:"CAMBIAR"}),Object(w.jsx)(Dt,{variant:"outlined",color:"secondary",onClick:b,children:"Cancelar"})]})]})})})},Nr=function(){var e=yr(),t=e.MetodoDescuento,a=e.permisos,n=e.dialogs,o=e.setDialogs,i=e.datosFacturas,s=e.indexFactura,l=e.Funciones,d=e.errors,u=e.cargas,j=e.setCargas,b=e.consultarCliente,p=e.changeInputsDatosFactura,m=e.setErrors,O=e.initialErrors,x=e.verificarYEnviarFactura,h=e.AgregarCantidadMetodoPago,f=e.cantidadRecibidaRef,g=e.borrarMetodoPago,_=Object(c.useRef)(null),v=Object(c.useState)(0),C=Object(r.a)(v,2),k=C[0],S=C[1],y=Object(c.useState)(0),F=Object(r.a)(y,2),I=F[0],P=F[1],A=i,D=A.facturas[s],E=a.some((function(e){return 71===parseInt(e.id_permiso_permiso)})),N=function(){u.finalizarVenta||(o(Object(Te.a)(Object(Te.a)({},n),{},{finalizarVenta:!1})),m(O))},T=function(){var e,t,a=D.datosFactura,r=parseFloat(a.totalAbonado)+D.descuento,n=a.id_caja,o=a.id_empleado,c=Object(Te.a)({},d);return D.datosFactura.formasPago.length<1&&"2"!==D.datosFactura.tipoFactura?(c.factura.error=!0,c.factura.errorMensaje="Agregue al menos un m\xe9todo de pago",m(c),null===(e=f.current)||void 0===e||e.focus(),!1):(isNaN(r)||r<D.total)&&"2"!==D.datosFactura.tipoFactura?(c.factura.error=!0,c.factura.errorMensaje="La cantidad abonada no puede ser menor al total de la factura",m(c),null===(t=f.current)||void 0===t||t.focus(),!1):""===n?(c.factura.error=!0,c.factura.errorMensaje="Seleccione una caja por favor",m(c),!1):""===o?(c.factura.error=!0,c.factura.errorMensaje="Seleccione un vendedor por favor",m(c),!1):(m(O),j(Object(Te.a)(Object(Te.a)({},u),{},{finalizarVenta:!0})),void x())},R=function(e){var a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=parseFloat(e.target.value);isNaN(r)&&(r=0),a?(S(r>0?r:0),t(r,!0)):(P(r>0?r:0),t(r,!1))},M=100*D.descuento/D.total,L=D.total_iva*M/100,W=parseFloat(D.datosMoneda.valor_moneda),z=(D.total-D.descuento)/W,q=(D.total_iva-L)/W,B=null===D||void 0===D?void 0:D.datosMoneda.abreviatura_moneda,V=(isNaN(parseFloat(D.datosFactura.totalAbonado))?0:parseFloat(D.datosFactura.totalAbonado)/W)-z;return Object(w.jsxs)(ze.a,{open:n.finalizarVenta,fullScreen:!0,maxWidth:"lg",onClose:N,TransitionComponent:yt.a,children:[Object(w.jsxs)(qe.a,{children:[Object(w.jsx)(Ae.a,{title:Object(w.jsx)("h2",{children:"Volver a factura"}),TransitionComponent:yt.a,arrow:!0,placement:"right-start",children:Object(w.jsx)(Pe.a,{onClick:N,children:Object(w.jsx)(ee.a,{children:"arrow_back_ios_new"})})}),"FINALIZAR VENTA - TOTAL: ",l.numberSeparator(l.redondeo2decimales(z))," ",B]}),Object(w.jsx)(Ue.a,{children:Object(w.jsxs)(Z.a,{container:!0,spacing:2,justifyContent:"center",children:[Object(w.jsx)(Z.a,{item:!0,xs:12,children:d.factura.error&&Object(w.jsx)(de.a,{severity:"error",children:d.factura.errorMensaje})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:6,children:Object(w.jsxs)(Z.a,{container:!0,spacing:2,children:[Object(w.jsx)(Z.a,{item:!0,xs:12,sm:6,children:Object(w.jsx)(Fe.a,{onKeyPress:function(e){"Enter"===e.key&&b(_.current.value)},label:"Documento de cliente",placeholder:"Documento de cliente",fullWidth:!0,inputRef:_,variant:"outlined",InputProps:{startAdornment:Object(w.jsx)(Ie.a,{position:"start",children:u.cargandoCliente?Object(w.jsx)(U.a,{size:24}):Object(w.jsx)(Ae.a,{TransitionComponent:yt.a,arrow:!0,title:Object(w.jsx)("h2",{children:"Buscar cliente"}),children:Object(w.jsx)(Pe.a,{onClick:function(){return o(Object(Te.a)(Object(Te.a)({},n),{},{buscarCliente:!0}))},children:Object(w.jsx)(ee.a,{children:"search"})})})}),endAdornment:Object(w.jsx)(Ae.a,{TransitionComponent:yt.a,arrow:!0,title:Object(w.jsx)("h2",{children:"Registrar cliente"}),children:Object(w.jsx)(Pe.a,{onClick:function(){o(Object(Te.a)(Object(Te.a)({},n),{},{registrarCliente:!0}))},children:Object(w.jsx)(ee.a,{color:"primary",children:"person_add_alt_1"})})})}})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:6,children:Object(w.jsxs)(Ve.a,{fullWidth:!0,children:[Object(w.jsx)(He.a,{variant:"outlined",children:"Seleccione caja"}),Object(w.jsxs)(Ge.a,{error:"Seleccione una caja por favor"===d.factura.errorMensaje,value:D.datosFactura.id_caja,name:"id_caja",onChange:p,fullWidth:!0,children:[Object(w.jsx)(Je.a,{value:"",disabled:!0,children:Object(w.jsx)("em",{children:"Seleccione caja"})}),A.listaCajas.map((function(e,t){return Object(w.jsx)(Je.a,{value:e.id_caja,selected:!0,children:e.nombre_caja},t)}))]})]})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:6,children:Object(w.jsxs)(de.a,{severity:d.cliente?"error":"info",icon:!1,variant:"outlined",children:[Object(w.jsxs)(Ar.a,{children:[" DOC: ",D.datosCliente.ruc_cliente," ",Object(w.jsx)("br",{})," NOMBRE: ",D.datosCliente.nombre_cliente]}),Object(w.jsx)(Ar.a,{children:d.clienteMensaje})]})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:6,children:Object(w.jsxs)(Ve.a,{fullWidth:!0,children:[Object(w.jsx)(He.a,{variant:"outlined",children:"Seleccione vendedor"}),Object(w.jsxs)(Ge.a,{error:"Seleccione un vendedor por favor"===d.factura.errorMensaje,variant:"outlined",name:"id_empleado",onChange:p,fullWidth:!0,value:D.datosFactura.id_empleado,children:[Object(w.jsx)(Je.a,{value:"",selected:!0,disabled:!0,children:Object(w.jsx)("em",{children:"Seleccione vendedor"})}),A.listaVendedores.map((function(e,t){return Object(w.jsxs)(Je.a,{value:e.id_empleado,children:[e.nombre_empleado," ",e.apellido_empleado]},t)}))]})]})}),Object(w.jsxs)(Z.a,{item:!0,xs:12,sm:6,children:[Object(w.jsx)(te.a,{variant:"body1",children:"TIPO CLIENTE:"}),Object(w.jsx)(ot.a,{value:"1",name:"tipoCliente",onChange:p,control:Object(w.jsx)(ct.a,{color:"primary",checked:"1"===D.datosFactura.tipoCliente}),label:"Normal",labelPlacement:"end"}),Object(w.jsx)(ot.a,{value:"2",name:"tipoCliente",disabled:!A.facturaActiva||!0,onChange:p,control:Object(w.jsx)(ct.a,{color:"primary",checked:"2"===D.datosFactura.tipoCliente}),label:"Retentor",labelPlacement:"end"})]}),Object(w.jsxs)(Z.a,{item:!0,xs:12,sm:6,children:[Object(w.jsx)(te.a,{variant:"body1",children:"CONDICION DE VENTA:"}),Object(w.jsx)(ot.a,{value:"0",name:"tipoFactura",onChange:p,control:Object(w.jsx)(ct.a,{checked:"0"===D.datosFactura.tipoFactura||"0"===D.datosCliente.ruc_cliente}),label:"TICKET RECIBO",labelPlacement:"end"}),Object(w.jsx)(ot.a,{value:"1",disabled:!A.facturaActiva||"0"===D.datosCliente.ruc_cliente,name:"tipoFactura",onChange:p,control:Object(w.jsx)(ct.a,{checked:"1"===D.datosFactura.tipoFactura}),label:"CONTADO",labelPlacement:"end"}),Object(w.jsx)(ot.a,{value:"2",disabled:!A.facturaActiva||"0"===D.datosCliente.ruc_cliente,name:"tipoFactura",onChange:p,control:Object(w.jsx)(ct.a,{checked:"2"===D.datosFactura.tipoFactura&&"0"!==D.datosCliente.ruc_cliente}),label:"CR\xc9DITO",labelPlacement:"end"})]}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:6,children:"2"===D.datosFactura.tipoFactura&&Object(w.jsx)(Fe.a,{label:"Fecha de cobro",type:"date",onChange:p,value:D.datosFactura.fecha_cobro_factura,name:"fecha_cobro_factura"})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(ot.a,{control:Object(w.jsx)(za.a,{name:"entregado_items",value:"1"===D.datosFactura.entregado_items?"0":"1",checked:"1"===D.datosFactura.entregado_items,onChange:p}),label:"Items ya entregados"})}),Object(w.jsxs)(Z.a,{item:!0,xs:12,children:[Object(w.jsx)(de.a,{icon:!1,children:"Formas de pago"}),D.datosFactura.formasPago.map((function(e,t){return Object(w.jsxs)(we.a,{direction:"row",alignItems:"center",children:[Object(w.jsx)(Pe.a,{onClick:function(){return g(t,e.cantidad)},children:Object(w.jsx)(ee.a,{children:"clear"})}),Object(w.jsxs)(te.a,{variant:"body1",children:[e.descripcion,": ",l.numberSeparator(e.cantidad/W)," - ",e.obs]})]},t)}))]}),Object(w.jsx)(Z.a,{item:!0,xs:12,md:12,children:"2"===D.datosFactura.tipoFactura&&Object(w.jsx)(Fe.a,{variant:"outlined",label:"Orden de compra",helperText:"Si no tiene deje en blanco",value:D.datosFactura.ordenCompra,name:"ordenCompra",onChange:p})})]})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:6,children:Object(w.jsxs)(Z.a,{container:!0,spacing:2,justifyContent:"center",alignItems:"center",children:[Object(w.jsx)(Z.a,{item:!0,xs:12,sm:6,children:Object(w.jsxs)(Ve.a,{fullWidth:!0,children:[Object(w.jsx)(He.a,{variant:"outlined",children:"M\xe9todo de pago"}),Object(w.jsxs)(Ge.a,{value:D.datosFactura.id_formaPago,name:"id_formaPago",onChange:p,variant:"outlined",disabled:"2"===D.datosFactura.tipoFactura,children:[Object(w.jsx)(Je.a,{value:"",selected:!0,disabled:!0,children:Object(w.jsx)("em",{children:"Seleccione forma de pago"})}),A.listaFormasPago.map((function(e,t){return Object(w.jsx)(Je.a,{value:e.id_facturas_formas_pago,children:e.descripcion_forma_pago},t)}))]})]})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:6,children:Object(w.jsx)(Fe.a,{fullWidth:!0,value:D.datosFactura.obs_pago,name:"obs_pago",onChange:p,variant:"outlined",label:"Observaciones de pago"})}),Object(w.jsx)(Z.a,{item:!0,sm:12,md:8,children:Object(w.jsx)(At,{label:"Cantidad recibida",onKeyPress:function(e){"Enter"===e.key&&T()},autoFocus:!0,inputRef:f,disabled:"2"===D.datosFactura.tipoFactura,autoComplete:"off",name:"cantidad_recibida",value:D.datosFactura.cantidad_recibida,onChange:p,fullWidth:!0,color:"success",variant:"outlined",InputProps:{startAdornment:Object(w.jsx)(Ie.a,{position:"start",children:B}),inputComponent:Va,inputProps:{min:0}}})}),Object(w.jsx)(Z.a,{item:!0,sm:12,md:4,children:Object(w.jsx)(Dt,{disabled:"2"===D.datosFactura.tipoFactura,variant:"outlined",onClick:function(){h()},startIcon:Object(w.jsx)(ee.a,{children:"add"}),children:"Agregar"})}),E&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(Z.a,{item:!0,xs:12,sm:12,md:6,children:Object(w.jsx)(At,{fullWidth:!0,disabled:I>0,label:"Descuento %",onChange:function(e){R(e,!0)},InputProps:{startAdornment:Object(w.jsx)(Ie.a,{position:"start",children:"%"}),inputComponent:Va,inputProps:{min:0,max:100,maxLength:2}}})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:12,md:6,children:Object(w.jsx)(At,{fullWidth:!0,disabled:k>0,label:"Descuento ".concat(B),onChange:function(e){R(e)},InputProps:{startAdornment:Object(w.jsx)(Ie.a,{position:"start",children:B}),inputComponent:Va,inputProps:{min:0}}})})]}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:12,children:Object(w.jsx)(de.a,{icon:!1,variant:"outlined",severity:"info",children:Object(w.jsxs)(Z.a,{container:!0,children:[Object(w.jsx)(Z.a,{item:!0,xs:6,sm:6,children:Object(w.jsx)("h3",{children:"TOTAL A PAGAR:"})}),Object(w.jsx)(Z.a,{item:!0,xs:6,sm:6,children:Object(w.jsxs)("h3",{children:[l.numberSeparator(l.redondeo2decimales(z))," ",B]})}),Object(w.jsx)(Z.a,{item:!0,xs:6,sm:6,children:Object(w.jsx)("h3",{children:"ABONADO:"})}),Object(w.jsx)(Z.a,{item:!0,xs:6,sm:6,children:Object(w.jsxs)("h3",{children:[l.numberSeparator(D.datosFactura.totalAbonado/W)," ",B]})}),Object(w.jsx)(Z.a,{item:!0,xs:6,sm:6,children:Object(w.jsx)("h3",{children:"DESCUENTOS:"})}),Object(w.jsx)(Z.a,{item:!0,xs:6,sm:6,children:Object(w.jsxs)("h3",{children:[l.numberSeparator(D.descuento/W)," ",B]})}),Object(w.jsx)(Z.a,{item:!0,xs:6,sm:6,children:Object(w.jsx)("h3",{children:"IMPUESTO:"})}),Object(w.jsx)(Z.a,{item:!0,xs:6,sm:6,children:Object(w.jsxs)("h3",{children:[l.numberSeparator(l.redondeo2decimales(q))," ",B]})}),Object(w.jsx)(Z.a,{item:!0,xs:6,sm:6,children:Object(w.jsx)("h3",{children:"CAMBIO:"})}),Object(w.jsx)(Z.a,{item:!0,xs:6,sm:6,children:Object(w.jsx)("h3",{children:V<=0?"0 "+B:l.numberSeparator(V)+" "+B})}),Object(w.jsx)(Z.a,{item:!0,xs:6,sm:12,children:Object(w.jsxs)(te.a,{variant:"overline",children:["SON: ",l.NumeroALetras(z,B)]})})]})})})]})})]})}),Object(w.jsxs)(Ye.a,{children:[Object(w.jsx)(Dt,{color:"primary",variant:"contained",size:"large",onClick:T,disabled:u.finalizarVenta||D.itemsFactura.length<1,children:"FINALIZAR"}),Object(w.jsx)(Dt,{onClick:N,color:"error",variant:"outlined",size:"large",children:"CANCELAR"})]})]})},Tr=function(){var e,t=yr(),a=t.dialogs,r=t.setDialogs,n=t.setIndexPrecioCambiar,o=t.indexPrecioCambiar,c=t.datosFacturas,i=t.indexFactura,s=(null===(e=c.facturas[i].itemsFactura[o])||void 0===e?void 0:e.url_imagen)?c.facturas[i].itemsFactura[o].url_imagen:null,l=function(){r(Object(Te.a)(Object(Te.a)({},a),{},{imagen:!1})),n(-1)};return Object(w.jsx)(w.Fragment,{children:o>=0&&Object(w.jsxs)(ze.a,{open:a.imagen,fullWidth:!0,maxWidth:"lg",onClose:l,children:[Object(w.jsx)(Ue.a,{children:Object(w.jsx)("p",{style:{textAlign:"center"},children:s?Object(w.jsx)("img",{src:s,alt:"..."}):"No tiene imagen"})}),Object(w.jsx)(Ye.a,{children:Object(w.jsx)(ae.a,{variant:"outlined",onClick:l,children:"Cerrar"})})]})})},Rr=function(){var e=Object(c.useRef)(null),t=yr(),a=t.dialogs,r=t.setDialogs,n=t.cerrarDialogFactura,o=t.indexFactura,i=t.datosFacturas,s=t.Funciones,l=JSON.parse(localStorage.getItem("dataEmpresa")),d=i.facturas[o],u=Object(Te.a)({},i),j=u.listaFacturas.findIndex((function(e){return e.id_caja_empresa===d.datosFactura.id_caja})),b=u.listaFacturas[j]?u.listaFacturas[j]:{},p=0,m=0,O=0,x=0,h=0;d.itemsFactura.forEach((function(e){var t=e.precio_guardado*e.cantidad_producto,a=e.iva_porcentaje;5===a?(p+=t,O+=t*a/(100+a)):10===a?(m+=t,x+=t*a/(100+a)):0===a&&(h+=t)}));return Object(w.jsxs)(ze.a,{open:a.imprimirFactura,fullWidth:!0,maxWidth:"md",onClose:n,TransitionComponent:yt.a,children:[Object(w.jsx)(Ue.a,{children:Object(w.jsxs)("div",{style:{display:"flex",justifyContent:"center",flexDirection:"column",margin:"25px auto",fontFamily:"monospace"},id:"print_factura",className:"maindiv",ref:e,children:[Object(w.jsx)("table",{width:"740px",align:"center",style:{borderCollapse:"collapse"},className:"collapse",border:"1",children:Object(w.jsxs)("tbody",{children:[Object(w.jsxs)("tr",{children:[Object(w.jsxs)("td",{width:"65%",align:"left",colSpan:"3",style:{fontSize:"11px"},children:[Object(w.jsx)("h2",{children:l.nombre_empresa}),Object(w.jsxs)("p",{children:["De: ",l.propietario_empresa]}),Object(w.jsx)("p",{children:l.categoria_empresa}),Object(w.jsxs)("p",{className:"fontsize9",children:["Tel:",l.telefono_empresa," - ",l.direccion_empresa]})]}),Object(w.jsxs)("td",{width:"65%",align:"left",colSpan:"3",style:{fontSize:"10px"},children:[Object(w.jsxs)("p",{children:["RUC: ",null===l||void 0===l?void 0:l.ruc_empresa]}),Object(w.jsxs)("p",{children:["TIMBRADO NRO: ",null===b||void 0===b?void 0:b.timbrado_factura]}),Object(w.jsxs)("p",{children:["Inicio vigencia: ",null===b||void 0===b?void 0:b.inicio_timbrado]}),Object(w.jsxs)("p",{children:["Fin vigencia: ",null===b||void 0===b?void 0:b.fin_timbrado," "]}),Object(w.jsxs)("b",{children:["FACTURA NRO: ",null===b||void 0===b?void 0:b.nro_datos_factura," ",d.datosFactura.nro_factura]})]})]}),Object(w.jsxs)("tr",{children:[Object(w.jsxs)("td",{width:"65%",align:"left",colSpan:"3",style:{fontSize:"10px"},children:[Object(w.jsxs)("p",{children:["Fecha: ",s.getFechaActualString()]}),Object(w.jsxs)("p",{children:["Nombre o Raz\xf3n Social: ",d.datosCliente.nombre_cliente]}),Object(w.jsxs)("p",{children:["Direcci\xf3n: ",d.datosCliente.direccion_cliente]})]}),Object(w.jsxs)("td",{width:"35%",align:"left",valign:"top",style:{fontSize:"10px"},children:[Object(w.jsxs)("p",{children:["Condici\xf3n de venta:"," ","1"===d.datosFactura.tipoFactura?"Contado":"Cr\xe9dito"]}),Object(w.jsxs)("p",{children:["RUC/CI: ",d.datosCliente.ruc_cliente]})]})]})]})}),Object(w.jsx)("br",{}),Object(w.jsx)("div",{style:{minHeight:"600px"},children:Object(w.jsxs)("table",{align:"center",width:"740px",style:{borderCollapse:"collapse"},className:"collapse",border:"1",children:[Object(w.jsx)("thead",{children:Object(w.jsxs)("tr",{align:"left",children:[Object(w.jsx)("th",{width:"10%",align:"center",children:"CANT."}),Object(w.jsx)("th",{width:"50%",align:"center",children:Object(w.jsx)("p",{children:"DESCRIPCION"})}),Object(w.jsx)("th",{width:"10%",align:"center",children:"PRECIO"}),Object(w.jsx)("th",{width:"10%",align:"center",children:"EXENTA"}),Object(w.jsx)("th",{width:"10%",align:"center",children:"5%"}),Object(w.jsx)("th",{width:"10%",align:"center",children:"10%"})]})}),Object(w.jsx)("tbody",{children:d.itemsFactura.map((function(e,t){return Object(w.jsxs)("tr",{style:{fontSize:"10px"},valign:"top",children:[Object(w.jsx)("td",{width:"10%",align:"center",valign:"center",children:e.cantidad_producto}),Object(w.jsx)("td",{width:"50%",children:e.nombre_producto}),Object(w.jsx)("td",{width:"10%",align:"center",children:Object(w.jsx)("span",{children:s.numberSeparator(e.precio_guardado)})}),Object(w.jsx)("td",{width:"10%",align:"center",children:0===e.iva_porcentaje&&s.numberSeparator(e.precio_guardado*e.cantidad_producto)}),Object(w.jsx)("td",{width:"10%",align:"center",children:5===e.iva_porcentaje&&s.numberSeparator(e.precio_guardado*e.cantidad_producto)}),Object(w.jsx)("td",{width:"10%",align:"center",children:10===e.iva_porcentaje&&s.numberSeparator(e.precio_guardado*e.cantidad_producto)})]},t)}))})]})}),Object(w.jsx)("br",{}),Object(w.jsx)("table",{width:"740px",align:"center",style:{borderCollapse:"collapse"},className:"collapse",border:"1",children:Object(w.jsx)("tbody",{children:Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{width:"70%",children:Object(w.jsx)("p",{children:"SUBTOTALES:"})}),Object(w.jsx)("td",{width:"10%",align:"center",children:s.numberSeparator(h)}),Object(w.jsx)("td",{width:"10%",align:"center",children:s.numberSeparator(p)}),Object(w.jsx)("td",{width:"10%",align:"center",children:s.numberSeparator(m)})]})})}),Object(w.jsx)("br",{}),Object(w.jsx)("table",{align:"center",width:"740px",style:{borderCollapse:"collapse"},className:"collapse",border:"1",children:Object(w.jsxs)("tbody",{children:[Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{width:"70%",colSpan:"3",children:Object(w.jsxs)("b",{children:["TOTAL A PAGAR: ",d.datosMoneda.abreviatura_moneda," "," ",s.NumeroALetras(d.total,"")]})}),Object(w.jsx)("td",{width:"30%",align:"right",children:Object(w.jsx)("b",{children:s.numberSeparator(d.total)})})]}),Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{children:"LIQUIDACION IVA"}),Object(w.jsxs)("td",{children:["5%: ",s.redondeo2decimales(O)]}),Object(w.jsxs)("td",{children:["10%: ",s.redondeo2decimales(x)]}),Object(w.jsxs)("td",{align:"right",children:["TOTAL IVA:",s.redondeo2decimales(d.total_iva)]})]})]})})]})}),Object(w.jsxs)(Ye.a,{children:[Object(w.jsx)(X.a,{targetRef:e,x:8,y:8,filename:"".concat(null===b||void 0===b?void 0:b.nro_datos_factura," ").concat(d.datosFactura.nro_factura," ").concat(d.datosCliente.nombre_cliente,".pdf"),children:function(e){var t=e.toPdf;return Object(w.jsx)(Dt,{variant:"outlined",startIcon:Object(w.jsx)(ee.a,{children:"picture_as_pdf"}),onClick:t,children:"PDF"})}}),Object(w.jsx)(Dt,{size:"large",variant:"contained",color:"primary",startIcon:Object(w.jsx)(ee.a,{children:"print"}),onClick:function(){Y()({type:"html",printable:"print_factura",style:" .border1 {border:none} \n    .maindiv{margin:20px auto; font-family:monospace;max-width:198mm;display:flex;flex-direction:column;}\n    .maindiv td{ padding-left:10px;}\n    .collapse{border-collapse:collapse; border-color:silver}\n    "})},children:"Imprimir"}),Object(w.jsx)(Dt,{size:"large",variant:"outlined",color:"primary",onClick:function(){r(Object(Te.a)(Object(Te.a)({},a),{},{imprimirFactura:!1})),n()},children:"Cerrar"})]})]})},Mr=function(){var e=yr(),t=e.dialogs,a=e.setDialogs,r=e.indexFactura,n=e.datosFacturas,o=e.Funciones,c=e.cerrarDialogFactura,i=JSON.parse(localStorage.getItem("dataEmpresa")),s=n.facturas[r],l=function(){a(Object(Te.a)(Object(Te.a)({},t),{},{imprimirTicket:!1})),c()};return Object(w.jsxs)(ze.a,{open:t.imprimirTicket,maxWidth:"xs",onClose:l,TransitionComponent:yt.a,children:[Object(w.jsx)("div",{style:{display:"flex",justifyContent:"center",padding:"25px",margin:"0 auto"},id:"print_factura",children:Object(w.jsxs)("table",{border:"0",style:{width:"".concat(i.dimesion_ticket),borderCollapse:"collapse"},children:[Object(w.jsxs)("thead",{style:{fontSize:"11px"},children:[Object(w.jsx)("tr",{children:Object(w.jsx)("td",{align:"center",style:{fontSize:"15px"},children:i.nombre_empresa})}),Object(w.jsx)("tr",{children:Object(w.jsx)("td",{align:"center",children:i.direccion_empresa})}),Object(w.jsx)("tr",{children:Object(w.jsxs)("td",{align:"center",children:["Tel: ",i.telefono_empresa]})}),Object(w.jsx)("tr",{children:Object(w.jsx)("td",{align:"center",children:Object(w.jsxs)("strong",{children:[" RECIBO NRO: ",s.datosFactura.nro_factura]})})}),Object(w.jsx)("tr",{children:Object(w.jsxs)("td",{align:"center",children:["Moneda: ",s.datosMoneda.nombre_moneda]})})]}),Object(w.jsxs)("tbody",{children:[Object(w.jsx)("tr",{children:Object(w.jsx)("td",{children:Object(w.jsx)("hr",{})})}),Object(w.jsx)("tr",{children:Object(w.jsx)("td",{children:Object(w.jsx)("table",{width:"100%",children:Object(w.jsxs)("tbody",{children:[Object(w.jsxs)("tr",{style:{fontSize:"11px"},children:[Object(w.jsx)("td",{children:"CA"}),Object(w.jsx)("td",{children:"DESC"}),Object(w.jsx)("td",{children:"PRE"}),Object(w.jsx)("td",{children:"SUBT"})]}),s.itemsFactura.map((function(e,t){return Object(w.jsxs)("tr",{style:{fontSize:"10px",textTransform:"lowercase"},children:[Object(w.jsx)("td",{valign:"top",children:e.cantidad_producto}),Object(w.jsx)("td",{valign:"top",children:e.nombre_producto}),Object(w.jsx)("td",{valign:"top",children:o.numberSeparator(e.precio_guardado)}),Object(w.jsx)("td",{valign:"top",children:o.numberSeparator(e.precio_guardado*e.cantidad_producto)})]},t)}))]})})})}),Object(w.jsx)("tr",{children:Object(w.jsx)("td",{children:Object(w.jsx)("hr",{})})}),Object(w.jsx)("tr",{children:Object(w.jsx)("td",{children:Object(w.jsx)("table",{width:"100%",style:{fontSize:"12px"},children:Object(w.jsxs)("tbody",{children:[Object(w.jsx)("tr",{children:Object(w.jsxs)("th",{children:["SUBTOTAL: ",o.numberSeparator(s.total)]})}),s.descuento>0&&Object(w.jsx)("tr",{children:Object(w.jsxs)("th",{children:[" DESCUENTO: -",s.descuento," "]})}),Object(w.jsx)("tr",{children:Object(w.jsxs)("th",{children:["TOTAL: ",o.numberSeparator(s.total-s.descuento)," ",s.datosMoneda.abreviatura_moneda]})}),Object(w.jsx)("tr",{children:Object(w.jsxs)("th",{children:[o.NumeroALetras(s.total-s.descuento,s.datosMoneda.abreviatura_moneda)," "]})})]})})})}),Object(w.jsx)("tr",{children:Object(w.jsx)("td",{children:Object(w.jsx)("hr",{})})})]}),Object(w.jsxs)("tfoot",{style:{fontSize:"11px"},children:[Object(w.jsx)("tr",{children:Object(w.jsxs)("td",{align:"left",children:["CLIENTE: ",s.datosCliente.nombre_cliente]})}),Object(w.jsx)("tr",{children:Object(w.jsxs)("td",{align:"left",children:["DOC: ",s.datosCliente.ruc_cliente]})}),Object(w.jsx)("tr",{children:Object(w.jsxs)("td",{align:"left",children:["FECHA EMISION: ",s.datosFactura.fecha_factura]})}),Object(w.jsx)("tr",{children:Object(w.jsx)("td",{children:Object(w.jsx)("hr",{})})}),Object(w.jsx)("tr",{children:Object(w.jsx)("td",{align:"center",children:"Los datos impresos requieren un cuidado especial. Para ello evite exponer al calor y humedad en exceso, luz solar o l\xe1mparas"})}),Object(w.jsx)("tr",{children:Object(w.jsxs)("td",{align:"center",children:[" ","*",i.nombre_empresa," agradece su compra *"]})})]})]})}),Object(w.jsxs)(Ye.a,{children:[Object(w.jsx)(Dt,{size:"large",variant:"contained",color:"primary",startIcon:Object(w.jsx)(ee.a,{children:"print"}),onClick:function(){Y()({type:"html",printable:"print_factura",style:"#print_factura{font-family:monospace}"})},children:"Imprimir"}),Object(w.jsx)(Dt,{size:"large",variant:"outlined",color:"primary",onClick:l,children:"Cerrar"})]})]})},Lr=function(){var e=yr().dialogs;return e.imprimirTicket?Object(w.jsx)(Mr,{}):e.imprimirFactura?Object(w.jsx)(Rr,{}):Object(w.jsx)(w.Fragment,{})},Wr=function(){var e=yr(),t=e.setDialogs,a=e.dialogs,r=e.CargarNota,n=Object(c.useRef)(null),o=function(){t(Object(Te.a)(Object(Te.a)({},a),{},{nota:!1}))},i=function(){var e=n.current.value;""!==e&&r(e)};return Object(w.jsxs)(ze.a,{open:a.nota,fullWidth:!0,maxWidth:"sm",onClose:o,children:[Object(w.jsx)(qe.a,{children:"Ingresar n\xfamero de nota"}),Object(w.jsx)(Ue.a,{dividers:!0,children:Object(w.jsx)(Z.a,{container:!0,spacing:2,children:Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(Fe.a,{required:!0,inputRef:n,onKeyPress:function(e){"Enter"===e.key&&i()},autoFocus:!0,fullWidth:!0,label:"Ingrese nro de nota"})})})}),Object(w.jsxs)(Ye.a,{children:[Object(w.jsx)(ae.a,{variant:"outlined",onClick:i,children:"Ingresar"}),Object(w.jsx)(ae.a,{variant:"outlined",onClick:o,children:"Cerrar"})]})]})},zr=function(){var e=yr(),t=e.dialogs,a=e.setDialogs,n=e.datosFacturas,o=e.indexFactura,i=e.setearFactura,s=e.setErrors,u=e.errors,j=I().token_user,b={ruc_cliente:"",nombre_cliente:"",direccion_cliente:"",telefono_cliente:"",email_cliente:""},p={ruc_cliente:!1,nombre_cliente:!1,ruc_error:"",nombre_error:""},m=Object(c.useState)(b),O=Object(r.a)(m,2),x=O[0],h=O[1],f=Object(c.useState)(p),g=Object(r.a)(f,2),_=g[0],v=g[1],C=Object(c.useState)(!1),S=Object(r.a)(C,2),y=S[0],F=S[1],P=Object(c.useRef)(null),A=Object(c.useRef)(null),D=function(){a(Object(Te.a)(Object(Te.a)({},t),{},{registrarCliente:!1})),h(b),v(p),F(!1)},E=function(e){var t=e.target,a=t.name,r=t.value;h(Object(Te.a)(Object(Te.a)({},x),{},Object(G.a)({},a,r)))},N=function(){var e=Object(d.a)(l.a.mark((function e(){var t,a,r,c,d;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(v(p),!(x.ruc_cliente.length<3)){e.next=5;break}return v(Object(Te.a)(Object(Te.a)({},_),{},{ruc_cliente:!0,ruc_error:"Complete este dato"})),null===(t=P.current)||void 0===t||t.focus(),e.abrupt("return",!1);case 5:if(!(x.nombre_cliente.length<4)){e.next=9;break}return v(Object(Te.a)(Object(Te.a)({},_),{},{nombre_cliente:!0,nombre_error:"El nombre debe tener al menos 5 letras"})),null===(a=A.current)||void 0===a||a.focus(),e.abrupt("return",!1);case 9:return r=P.current.value,F(!0),e.next=13,k.get({table:"clientes",fields:"id_cliente",where:"ruc_cliente,=,'".concat(r,"'")});case 13:if(0!==e.sent.found){e.next=21;break}return e.next=17,k.insert({table:"clientes",data:x,token:j});case 17:"ok"===(c=e.sent).response&&((d=Object(Te.a)({},n)).facturas[o].datosCliente.id_cliente=c.last_id,d.facturas[o].datosCliente.ruc_cliente=x.ruc_cliente,d.facturas[o].datosCliente.nombre_cliente=x.nombre_cliente,d.facturas[o].datosCliente.direccion_cliente=x.direccion_cliente,s(Object(Te.a)(Object(Te.a)({},u),{},{cliente:!1,clienteMensaje:""})),i(d),D()),e.next=23;break;case 21:v(Object(Te.a)(Object(Te.a)({},_),{},{ruc_cliente:!0,ruc_error:"Ese cliente ya esta registrado."})),P.current.focus();case 23:F(!1);case 24:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(w.jsx)("form",{onSubmit:N,children:Object(w.jsxs)(ze.a,{open:t.registrarCliente,onClose:D,fullWidth:!0,children:[Object(w.jsx)(qe.a,{children:"Registrar cliente"}),Object(w.jsx)(Ue.a,{dividers:!0,children:Object(w.jsxs)(Z.a,{container:!0,spacing:2,children:[Object(w.jsx)(Z.a,{item:!0,xs:12,children:y&&Object(w.jsx)(Be.a,{})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(Fe.a,{autoComplete:"off",required:!0,inputRef:P,onChange:E,label:"Nro Documento",autoFocus:!0,fullWidth:!0,name:"ruc_cliente",value:x.ruc_cliente,variant:"outlined",InputProps:{startAdornment:Object(w.jsx)(Ie.a,{position:"start",children:Object(w.jsx)(ee.a,{color:"disabled",children:"description"})})},error:_.ruc_cliente,helperText:_.ruc_error})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(Fe.a,{required:!0,inputRef:A,autoComplete:"off",label:"Nombre o nombre de empresa",fullWidth:!0,name:"nombre_cliente",variant:"outlined",onChange:E,value:x.nombre_cliente,InputProps:{startAdornment:Object(w.jsx)(Ie.a,{position:"start",children:Object(w.jsx)(ee.a,{color:"disabled",children:"person"})})},error:_.nombre_cliente,helperText:_.nombre_error})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(Fe.a,{label:"Tel\xe9fono",fullWidth:!0,autoComplete:"off",onChange:E,name:"telefono_cliente",variant:"outlined",value:x.telefono_cliente,InputProps:{startAdornment:Object(w.jsx)(Ie.a,{position:"start",children:Object(w.jsx)(ee.a,{color:"disabled",children:"phone"})})}})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(Fe.a,{label:"Direcci\xf3n",fullWidth:!0,autoComplete:"off",onChange:E,name:"direccion_cliente",variant:"outlined",value:x.direccion_cliente,InputProps:{startAdornment:Object(w.jsx)(Ie.a,{position:"start",children:Object(w.jsx)(ee.a,{color:"disabled",children:"location_city"})})}})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(Fe.a,{label:"Email",fullWidth:!0,autoComplete:"off",onChange:E,name:"email_cliente",variant:"outlined",value:x.email_cliente,InputProps:{startAdornment:Object(w.jsx)(Ie.a,{position:"start",children:Object(w.jsx)(ee.a,{color:"disabled",children:"alternate_email"})})}})})]})}),Object(w.jsxs)(Ye.a,{children:[Object(w.jsx)(ae.a,{variant:"outlined",color:"primary",onClick:function(){N()},type:"submit",children:"Registrar"}),Object(w.jsx)(ae.a,{variant:"outlined",onClick:D,children:"Cancelar"})]})]})})};var qr=function(){var e=yr(),t=e.datosFacturas,a=e.indexFactura,r=e.dialogs,n=e.setDialogs,o=e.Funciones,i=Object(Te.a)({},t).facturas[a],s=Object(c.useRef)(null),l=parseFloat(i.datosMoneda.valor_moneda),d=function(){return n(Object(Te.a)(Object(Te.a)({},r),{},{imprimirPresupuesto:!1}))};return Object(w.jsx)(w.Fragment,{children:r.imprimirPresupuesto&&Object(w.jsxs)(ze.a,{open:r.imprimirPresupuesto,fullWidth:!0,maxWidth:"md",onClose:d,TransitionComponent:yt.a,children:[Object(w.jsx)(qe.a,{children:"Imprimir Presupuesto"}),Object(w.jsx)(Ue.a,{dividers:!0,children:Object(w.jsxs)("div",{id:"print_presupuesto",className:"print_presupuesto",ref:s,style:{display:"grid",gap:"2px"},children:[Object(w.jsx)("h4",{children:"Presupuesto"}),Object(w.jsxs)("p",{children:["Nombre: ",i.datosCliente.nombre_cliente]}),Object(w.jsxs)("p",{children:["Fecha: ",i.datosFactura.fecha_factura]}),Object(w.jsxs)("p",{children:["Moneda: ",i.datosMoneda.nombre_moneda]}),Object(w.jsxs)("table",{className:"collapse",cellPadding:2,border:"1",style:{borderCollapse:"collapse"},children:[Object(w.jsx)("thead",{children:Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{children:"Cod."}),Object(w.jsx)("td",{children:"Cant."}),Object(w.jsx)("td",{children:"Desc."}),Object(w.jsx)("td",{children:"Prec"}),Object(w.jsx)("td",{children:"Total"})]})}),Object(w.jsxs)("tbody",{children:[i.itemsFactura.map((function(e,t){return Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{children:e.codigo_producto}),Object(w.jsx)("td",{children:e.cantidad_producto}),Object(w.jsx)("td",{children:e.nombre_producto}),Object(w.jsx)("td",{children:o.numberSeparator(e.precio_guardado/l)}),Object(w.jsx)("td",{children:o.numberSeparator(parseFloat(e.precio_guardado*e.cantidad_producto)/l)})]},t)})),Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{colSpan:3}),Object(w.jsx)("td",{children:"Total:"}),Object(w.jsx)("td",{children:o.numberFormat(i.total/l)})]})]})]})]})}),Object(w.jsxs)(Ye.a,{children:[Object(w.jsx)(X.a,{targetRef:s,filename:"".concat(i.datosCliente.nombre_cliente,".pdf"),children:function(e){var t=e.toPdf;return Object(w.jsx)(Dt,{variant:"outlined",startIcon:Object(w.jsx)(ee.a,{children:"picture_as_pdf"}),onClick:t,children:"PDF"})}}),Object(w.jsx)(Dt,{variant:"outlined",onClick:function(){Y()({type:"html",printable:"print_presupuesto",style:" .collapse {border-collapse:collapse}"})},children:"Imprimir"}),Object(w.jsx)(Dt,{variant:"outlined",onClick:d,children:"Cerrar"})]})]})})},Ur=a(809),Br=function(e){var t=e.open,a=e.onClose,r=e.message,n=e.severity,o=void 0===n?"error":n;return Object(w.jsx)(Ea.a,{open:t,onClose:a,autoHideDuration:2e3,anchorOrigin:{vertical:"top",horizontal:"center"},children:Object(w.jsx)(de.a,{severity:o,variant:"filled",children:r})})},Vr=function(){var e=yr(),t=e.datosFacturas,a=e.indexFactura,r=e.setDialogs,n=e.dialogs,o=t.facturas[a].datosCliente;return Object(w.jsx)(Ae.a,{arrow:!0,placement:"right",title:Object(w.jsx)("h3",{children:"Cambiar cliente"}),children:Object(w.jsxs)(ae.a,{onClick:function(){return r(Object(Te.a)(Object(Te.a)({},n),{},{cambioCliente:!0}))},variant:"text",children:["Cliente: ",o.nombre_cliente]})})},Hr=function(){var e,t=yr(),a=t.cambiarDeposito,n=t.datosFacturas,o=t.indexFactura,c=Object(Te.a)({},n).facturas[o],s=i.a.useState(null),l=Object(r.a)(s,2),d=l[0],u=l[1],j=Boolean(d),b=(null===(e=n.listaDepositos.filter((function(e){return e.id_deposito===c.depositoActivo}))[0])||void 0===e?void 0:e.nombre_deposito)||"Depositos no habilitados";return Object(w.jsxs)("div",{children:[Object(w.jsx)(ae.a,{onClick:function(e){u(e.currentTarget)},children:b}),Object(w.jsx)(qt.a,{anchorEl:d,open:j,onClose:function(){u(null)},children:n.listaDepositos.map((function(e,t){return Object(w.jsx)(Je.a,{onClick:function(){!function(e){a(e.id_deposito),u(null)}(e)},children:e.nombre_deposito},t)}))})]})},Gr=function(){var e=yr(),t=e.setDialogs,a=e.dialogs;return Object(w.jsx)(Ae.a,{arrow:!0,placement:"top",title:Object(w.jsx)("h3",{children:"Cargar una nota ya creada"}),children:Object(w.jsx)(ae.a,{variant:"text",onClick:function(){return t(Object(Te.a)(Object(Te.a)({},a),{},{nota:!0}))},children:"Cargar nota . . ."})})},Jr=function(e){var t=e.outside,a=yr(),r=a.datosFacturas,n=a.setearIndexFactura,o=a.indexFactura,c=a.dialogs,i=a.setDialogs;return Object(w.jsx)(w.Fragment,{children:r.facturas.length>1&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(de.a,{icon:!1,children:"Pedidos en espera"}),Object(w.jsx)(Ut.a,{children:r.facturas.map((function(e,a){return a!==o&&e.guardado&&Object(w.jsx)(Bt.a,{disablePadding:!0,children:Object(w.jsxs)(Ra.a,{onClick:function(){!function(e){t?(i(Object(Te.a)(Object(Te.a)({},c),{},{main:!0})),n(e)):n(e)}(a)},children:[Object(w.jsx)(Vt.a,{children:Object(w.jsx)(ee.a,{children:"keyboard_arrow_right"})}),Object(w.jsx)(Ht.a,{primary:"".concat(e.itemsFactura.length," item(s) -  ").concat(e.datosCliente.nombre_cliente)})]})},a)}))})]})})},Yr=function(e){var t=e.index,a=yr(),r=a.borrarItem,n=a.openCambiarPrecio,o=a.openImagen;return Object(w.jsxs)(we.a,{direction:"row",alignItems:"center",spacing:1,children:[Object(w.jsx)(Pe.a,{color:"success",onClick:function(){o(t)},size:"large",children:Object(w.jsx)(Ae.a,{placement:"top",title:"Imagen",arrow:!0,children:Object(w.jsx)(ee.a,{children:"image"})})}),Object(w.jsx)(Pe.a,{color:"warning",onClick:function(){n(t)},size:"large",children:Object(w.jsx)(Ae.a,{placement:"top",title:"Cambiar precio",arrow:!0,children:Object(w.jsx)(ee.a,{children:"request_quote"})})}),Object(w.jsx)(Pe.a,{color:"error",onClick:function(){r(t)},size:"large",children:Object(w.jsx)(Ae.a,{placement:"top",title:"Borrar item",arrow:!0,children:Object(w.jsx)(ee.a,{children:"delete"})})})]})},Kr=Object(z.a)((function(e){var t;return{tableContainer:{position:"relative",overflowX:"unset",marginBottom:25,padding:"2px",transition:"all 0.1s linear"},tableheader:Object(G.a)({},e.breakpoints.down("md"),{display:"none"}),tablecell:{position:"sticky",zIndex:1,transition:"all 0.2s linear"},tablelist:(t={},Object(G.a)(t,e.breakpoints.down("md"),{display:"flex",flexDirection:"column",border:"1px solid silver",margin:"0 0 10px 0"}),Object(G.a)(t,"borderRadius","8px"),t),tableitem:Object(G.a)({},e.breakpoints.down("md"),{display:"flex",justifyContent:"space-between"}),columname:Object(G.a)({display:"none",textTransform:"uppercase"},e.breakpoints.down("md"),{display:"block"})}})),Xr=function(){var e,t=Kr(),a=yr(),r=a.datosFacturas,n=a.indexFactura,o=a.Funciones,c=a.restarCantidad,i=a.sumarCantidad,s=Object(Qe.a)(r.facturas[n].itemsFactura),l=parseFloat(r.facturas[n].datosMoneda.valor_moneda);return Object(w.jsx)(w.Fragment,{children:0===(null===(e=r.facturas[n])||void 0===e?void 0:e.itemsFactura.length)?Object(w.jsx)(w.Fragment,{children:Object(w.jsx)(ie.a,{className:t.tablelist,hover:!0,children:Object(w.jsx)(se.a,{colSpan:7,align:"center",children:Object(w.jsx)(de.a,{severity:"warning",variant:"outlined",icon:!1,children:Object(w.jsx)(Ar.a,{children:"FACTURA VAC\xcdA"})})})})}):s.map((function(e,a){return Object(w.jsxs)(ie.a,{className:t.tablelist,children:[Object(w.jsxs)(se.a,{className:t.tableitem,children:[Object(w.jsx)("span",{className:t.columname,children:"COD."}),Object(w.jsx)("span",{children:e.codigo_producto})]}),Object(w.jsxs)(se.a,{className:t.tableitem,children:[Object(w.jsx)("span",{className:t.columname,children:"CANT."}),Object(w.jsx)("span",{children:Object(w.jsxs)(we.a,{direction:"row",children:[Object(w.jsx)(Ae.a,{title:"Restar 1",children:Object(w.jsx)(Pe.a,{onClick:function(t){c(parseFloat(e.cantidad_producto),a)},children:Object(w.jsx)(ee.a,{children:"remove_circle_outline"})})}),Object(w.jsx)(te.a,{variant:"h6",children:e.cantidad_producto}),Object(w.jsx)(Pe.a,{onClick:function(t){i(parseFloat(e.cantidad_producto),a)},children:Object(w.jsx)(ee.a,{children:"add_circle_outline"})})]})})]}),Object(w.jsxs)(se.a,{className:t.tableitem,children:[Object(w.jsx)("span",{className:t.columname,children:"DESC."}),Object(w.jsx)("span",{children:e.nombre_producto})]}),Object(w.jsxs)(se.a,{className:t.tableitem,children:[Object(w.jsx)("span",{className:t.columname,children:"IVA"}),Object(w.jsx)("span",{children:e.iva_porcentaje})]}),Object(w.jsxs)(se.a,{className:t.tableitem,children:[Object(w.jsx)("span",{className:t.columname,children:"PRECIO"}),Object(w.jsx)("span",{children:o.numberSeparator(e.precio_guardado/l)})]}),Object(w.jsxs)(se.a,{className:t.tableitem,children:[Object(w.jsx)("span",{className:t.columname,children:"SUBTOTAL"}),Object(w.jsx)("span",{children:o.numberSeparator(e.subtotal_precio/l)})]}),Object(w.jsx)(se.a,{className:t.tableitem,children:Object(w.jsx)(Yr,{index:a})})]},a)}))})},Qr=function(){var e,t,a=Kr(),r=yr(),n=r.datosFacturas,o=r.indexFactura,c=r.cargas;return Object(w.jsx)(ne.a,{className:a.tableContainer,children:Object(w.jsxs)(oe.a,{children:[0!==(null===(e=n.facturas[o])||void 0===e||null===(t=e.itemsFactura)||void 0===t?void 0:t.length)&&Object(w.jsx)(ce.a,{className:a.tableheader,children:Object(w.jsxs)(ie.a,{children:[[{field:"codigo_producto",title:"Cod."},{field:"cantidad_producto",title:"Cant."},{field:"nombre_producto",title:"Descripci\xf3n"},{field:"iva_producto",title:"IVA"},{field:"precio_producto",title:"Precio"},{field:"subtotal_precio",title:"Subtotal"}].map((function(e,t){return Object(w.jsx)(se.a,{align:"left",className:a.tablecell,children:Object(w.jsx)(te.a,{variant:"overline",children:e.title})},t)})),Object(w.jsx)(se.a,{className:a.tablecell,children:Object(w.jsx)(te.a,{variant:"overline",children:"OPCIONES"})})]})}),Object(w.jsx)(le.a,{children:c.items?Object(w.jsx)("tr",{children:Object(w.jsx)("td",{align:"center",children:Object(w.jsx)(U.a,{})})}):Object(w.jsx)(Xr,{})})]})})},Zr=function(){var e,t=yr(),a=t.Funciones,r=t.dialogs,n=t.setDialogs,o=t.cargas,i=t.inputCodigo,s=t.inputCantidad,l=t.verificarExisteEnTabla,d=t.Aguardar,u=t.datosFacturas,j=t.indexFactura,b=t.CancelarFacturaActual,p=t.changeMonedas,m=t.Anotar,O=Object(Te.a)({},u.facturas[j]),x=function(e){"Enter"===e.key&&l(i.current.value)};Object(c.useEffect)((function(){function e(e){var t;(e.ctrlKey&&"KeyB"===e.code&&n(Object(Te.a)(Object(Te.a)({},r),{},{buscarProducto:!0})),e.ctrlKey&&"KeyM"===e.code)&&(null===i||void 0===i||null===(t=i.current)||void 0===t||t.focus());e.ctrlKey&&"KeyI"===e.code&&n(Object(Te.a)(Object(Te.a)({},r),{},{finalizarVenta:!0}))}return document.addEventListener("keypress",e),function(){return document.removeEventListener("keypress",e)}}),[r,n,i]);var h=O.total/parseFloat(O.datosMoneda.valor_moneda);return Object(w.jsxs)(Z.a,{container:!0,columnSpacing:{xs:1,sm:2,md:2},children:[Object(w.jsxs)(Z.a,{item:!0,children:[Object(w.jsx)(Vr,{})," ",Object(w.jsx)(Gr,{})]}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:3,md:3,children:Object(w.jsx)(Hr,{})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:3,children:u.facturas.length>1&&Object(w.jsxs)(ae.a,{children:["En espera(",u.facturas.length-1,")"]})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:12,md:12,lg:8,children:Object(w.jsx)(Qr,{})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:12,md:12,lg:4,children:Object(w.jsxs)(Z.a,{container:!0,rowSpacing:2,columnSpacing:{xs:1,sm:2,md:3},children:[Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(At,{onKeyPress:x,inputRef:i,id:"input_inserta_codigo_producto",autoComplete:"off",autoFocus:!0,name:"codigo_producto",variant:"outlined",label:"C\xf3digo de Producto",placeholder:"Ctrl + b",helperText:"Ingrese el c\xf3digo y presione Enter o el bot\xf3n",fullWidth:!0,InputProps:{startAdornment:Object(w.jsx)(Ie.a,{position:"start",children:Object(w.jsx)(Pe.a,{onClick:function(){n(Object(Te.a)(Object(Te.a)({},r),{},{buscarProducto:!0}))},children:Object(w.jsx)(ee.a,{children:"search"})})}),endAdornment:Object(w.jsx)(Ie.a,{position:"end",children:o.cargandoProducto&&Object(w.jsx)(U.a,{size:24})})}})}),Object(w.jsx)(Z.a,{xs:12,item:!0,children:Object(w.jsx)(At,{onKeyPress:x,inputRef:s,type:"number",name:"cantidad",variant:"outlined",helperText:"Cantidad",label:"Cantidad",defaultValue:"1"})}),Object(w.jsx)(Z.a,{xs:12,item:!0,children:Object(w.jsx)(Dt,{variant:"contained",fullWidth:!0,size:"large",color:"primary",onClick:function(){l(i.current.value)},children:"Agregar item"})}),Object(w.jsx)(Z.a,{xs:12,item:!0,children:Object(w.jsx)(yt.a,{in:(null===(e=u.facturas[j])||void 0===e?void 0:e.itemsFactura.length)>0,children:Object(w.jsxs)(Z.a,{container:!0,spacing:2,children:[Object(w.jsx)(Z.a,{item:!0,xs:12,sm:6,md:12,lg:6,children:Object(w.jsx)(Dt,{variant:"outlined",onClick:function(){u.facturas[j].itemsFactura.length>0&&n(Object(Te.a)(Object(Te.a)({},r),{},{finalizarVenta:!0}))},color:"success",fullWidth:!0,children:"FINALIZAR"})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:6,md:12,lg:6,children:Object(w.jsx)(Dt,{variant:"outlined",size:"large",fullWidth:!0,color:"primary",onClick:b,children:"CANCELAR"})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:6,children:Object(w.jsx)(Dt,{variant:"outlined",size:"large",fullWidth:!0,onClick:d,color:"warning",children:"Aguardar"})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:6,children:Object(w.jsx)(Dt,{variant:"outlined",size:"large",fullWidth:!0,onClick:m,color:"secondary",children:"Anotar"})}),Object(w.jsx)(Z.a,{xs:12,item:!0,children:Object(w.jsx)(de.a,{severity:"info",icon:!1,children:Object(w.jsxs)(te.a,{variant:"h6",children:["Total: ",a.numberSeparator(h)," ",u.facturas[j].datosMoneda.abreviatura_moneda]})})})]})})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:u.listaMonedas.map((function(e,t){return Object(w.jsx)(ot.a,{value:e.id_moneda,name:"listaMonedas",onChange:function(){p(e)},label:e.abreviatura_moneda,labelPlacement:"end",control:Object(w.jsx)(ct.a,{checked:O.datosMoneda.id_moneda===e.id_moneda})},t)}))}),Object(w.jsxs)(Z.a,{item:!0,xs:12,children:[Object(w.jsx)(ae.a,{variant:"outlined",size:"small",color:"error",onClick:function(){n(Object(Te.a)(Object(Te.a)({},r),{},{ayuda:!0}))},children:"Ayuda"}),O.itemsFactura.length>0&&Object(w.jsx)(Ae.a,{title:"Imprimir presupuesto",placement:"top",children:Object(w.jsx)(Pe.a,{onClick:function(){n(Object(Te.a)(Object(Te.a)({},r),{},{imprimirPresupuesto:!0}))},children:Object(w.jsx)(ee.a,{children:"print"})})})]}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(Jr,{})})]})})]})},$r=function(){var e=yr(),t=e.errors,a=e.setErrors,r=e.Funciones,n=e.cargas,o=e.dialogs,c=e.setDialogs,i=e.datosFacturas,s=e.indexFactura,l=i.facturas[s],d=null===l||void 0===l?void 0:l.datosMoneda.abreviatura_moneda;return Object(w.jsxs)(w.Fragment,{children:[n.general&&Object(w.jsx)(V,{}),Object(w.jsxs)(ze.a,{open:o.main,fullScreen:!0,TransitionComponent:Ur.a,children:[Object(w.jsxs)(qe.a,{children:[Object(w.jsx)(Ae.a,{title:Object(w.jsx)("h2",{children:"Volver men\xfa principal"}),TransitionComponent:yt.a,arrow:!0,placement:"right-start",children:Object(w.jsx)(Pe.a,{onClick:function(){c(Object(Te.a)(Object(Te.a)({},o),{},{main:!1,finalizarVenta:!1}))},color:"secondary",children:Object(w.jsx)(ee.a,{children:"arrow_back_ios_new"})})}),"Nueva venta - Total: ",r.numberSeparator(r.redondeo2decimales(l.total))," ",d]}),Object(w.jsxs)(Ue.a,{children:[Object(w.jsx)(Br,{open:t.error,severity:t.color,onClose:function(){a(Object(Te.a)(Object(Te.a)({},t),{},{error:!1}))},message:t.mensaje}),n.finalizarVenta?Object(w.jsx)(V,{}):Object(w.jsx)(Zr,{})]})]})]})},en=function(){var e=yr(),t=e.dialogs,a=e.setDialogs,r=e.Funciones;return Object(w.jsxs)(Z.a,{container:!0,spacing:2,children:[Object(w.jsx)(Z.a,{item:!0,children:Object(w.jsx)(Dt,{startIcon:Object(w.jsx)(ee.a,{children:"storefront"}),variant:"outlined",size:"large",color:"primary",onClick:function(){a(Object(Te.a)(Object(Te.a)({},t),{},{main:!0}))},children:"Hacer venta"})}),Object(w.jsx)(Z.a,{item:!0,children:Object(w.jsx)(Dt,{startIcon:Object(w.jsx)(ee.a,{children:"receipt_long"}),variant:"outlined",size:"large",color:"primary",onClick:function(){return r.goto("facturas")},children:"Lista de facturas"})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(Jr,{outside:!0})})]})},tn=function(){return Object(w.jsxs)(wr,{children:[Object(w.jsx)(Er,{}),Object(w.jsx)(Tr,{}),Object(w.jsx)(Nr,{}),Object(w.jsx)(zr,{}),Object(w.jsx)(Ir,{}),Object(w.jsx)(Pr,{}),Object(w.jsx)(qr,{}),Object(w.jsx)(Fr,{}),Object(w.jsx)(Dr,{}),Object(w.jsx)(Lr,{}),Object(w.jsx)(Wr,{}),Object(w.jsx)($r,{}),Object(w.jsx)(en,{})]})},an=Object(c.createContext)(),rn=function(){var e=Object(c.useContext)(an);return{lista:e.lista,setLista:e.setLista,cargando:e.cargando,setCargando:e.setCargando,openDialog:e.openDialog,setOpenDialog:e.setOpenDialog,formulario:e.formulario,setFormulario:e.setFormulario,enviarFormulario:e.enviarFormulario,borrarRegistro:e.borrarRegistro}},nn=function(e){var t=e.children,a=JSON.parse(localStorage.getItem("dataProductos")),n=I().token_user,o=Object(c.useState)([]),i=Object(r.a)(o,2),s=i[0],u=i[1],j=Object(c.useState)(!0),b=Object(r.a)(j,2),p=b[0],m=b[1],O={id_marca:"",nombre_marca:""},x=Object(c.useState)(O),h=Object(r.a)(x,2),f=h[0],g=h[1],_=Object(c.useState)(!1),v=Object(r.a)(_,2),C=v[0],S=v[1],F=function(){var e=Object(d.a)(l.a.mark((function e(t){var r,o,c,i,s,d,u;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),r=f.id_marca?"Actualizado":"Agregado",o="marcas",m(!0),""!==f.id_marca){e.next=12;break}return delete f.id_marca,e.next=8,k.insert({table:o,data:f,token:n});case 8:"ok"===(c=e.sent).response&&a&&(i=Object(Te.a)({},a),s={id_marca:c.last_id,nombre_marca:f.nombre_marca},i.marcas.push(s),localStorage.setItem("dataProductos",JSON.stringify(i))),e.next=16;break;case 12:return e.next=14,k.update({table:o,data:f,token:n,id:f.id_marca});case 14:c=e.sent,a&&(d=Object(Te.a)({},a),u=d.marcas.findIndex((function(e){return e.id_marca===f.id_marca})),d.marcas[u].nombre_marca=f.nombre_marca,localStorage.setItem("dataProductos",JSON.stringify(d)));case 16:"ok"===c.response?y()({icon:"success",text:"".concat(r," correctamente")}):console.log(c),A(),S(!1),g(O);case 20:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),P=function(){var e=Object(d.a)(l.a.mark((function e(t){var r,o=arguments;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=o.length>1&&void 0!==o[1]?o[1]:"",y()({icon:"info",text:'Desear borrar "'.concat(r,'" ?'),title:"Borrar?",buttons:["Cancelar","OK"]}).then(function(){var e=Object(d.a)(l.a.mark((function e(r){var o,c,i,d,j;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r){e.next=21;break}return e.next=3,k.get({table:"productos",where:"id_marca_producto,=,".concat(t)});case 3:if("ok"!==(o=e.sent).response){e.next=20;break}if(!(o.found>0)){e.next=9;break}y()({icon:"error",text:"No se puede borrar porque hay productos que tiene esta marca"}),e.next=18;break;case 9:return e.next=11,k.delete({table:"marcas",id:t,token:n});case 11:"ok"!==(c=e.sent).response&&console.log(c),i=Object(Qe.a)(s),d=i.findIndex((function(e){return e.id_marca===t})),i.splice(d,1),a&&((j=Object(Te.a)({},a)).marcas.splice(d,1),localStorage.setItem("dataProductos",JSON.stringify(j))),u(i);case 18:e.next=21;break;case 20:console.log(o);case 21:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),A=Object(c.useCallback)(Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.get({table:"marcas"});case 2:"ok"===(t=e.sent).response?u(t.results):console.log(t),m(!1);case 5:case"end":return e.stop()}}),e)}))),[]);return Object(c.useEffect)((function(){var e=!0,t=new AbortController;return e&&A(),function(){e=!1,t.abort()}}),[A]),Object(w.jsx)(an.Provider,{value:{lista:s,setLista:u,cargando:p,setCargando:m,openDialog:C,setOpenDialog:S,formulario:f,setFormulario:g,enviarFormulario:F,borrarRegistro:P},children:t})},on=function(){var e=rn(),t=e.lista,a=e.cargando,n=e.setOpenDialog,o=e.setFormulario,i=e.formulario,s=e.borrarRegistro,l=Object(c.useState)(""),d=Object(r.a)(l,2),u=d[0],j=d[1],b=Object(w.jsxs)(we.a,{direction:"row",spacing:2,children:[Object(w.jsx)(Fe.a,{InputProps:{endAdornment:Object(w.jsx)(Ie.a,{position:"end",children:Object(w.jsx)(Pe.a,{children:Object(w.jsx)(ee.a,{children:"search"})})})},onKeyPress:function(e){e.key},onChange:function(e){j(e.target.value)},variant:"outlined",label:"Buscar",value:u}),Object(w.jsx)(Ae.a,{title:"AGREGAR NUEVO",arrow:!0,children:Object(w.jsx)(ae.a,{color:"primary",variant:"outlined",size:"large",onClick:function(){n(!0)},children:"AGREGAR"})})]}),p=t.filter((function(e){return e.nombre_marca.toLowerCase().includes(u.toLowerCase())}));return Object(w.jsx)(Ne,{children:Object(w.jsx)(ye,{nombretabla:"Marcas",icono:"branding_watermark",bgicono:"#3f51b5",namecolumnID:"id_marca",columnas:[{field:"id_marca",title:"ID"},{field:"nombre_marca",title:"Nombre"}],filas:p,Acciones:function(e){var t=e.id,a=e.extraprops,r=e.filaProps;return Object(w.jsxs)(we.a,{justifyContent:"center",spacing:1,direction:"row",children:[Object(w.jsx)(De.a,{variant:"round",color:"primary",size:"small",onClick:function(){o(Object(Te.a)(Object(Te.a)({},i),{},{id_marca:t,nombre_marca:a})),n(!0)},children:Object(w.jsx)(ee.a,{children:"edit"})}),Object(w.jsx)(De.a,{variant:"round",color:"secondary",size:"small",onClick:function(){s(r.id_marca,r.nombre_marca)},children:Object(w.jsx)(ee.a,{children:"delete"})})]})},extraprops:"nombre_marca",search:b,cargando:a,showOptions:!0})})},cn=a(881),sn=function(){var e=rn(),t=e.formulario,a=e.setFormulario,r=e.openDialog,n=e.setOpenDialog,o=e.cargando,c=e.enviarFormulario,i=function(){a({nombre_marca:""}),n(!1)};return Object(w.jsx)(ze.a,{fullWidth:!0,open:r,onClose:i,children:Object(w.jsxs)("form",{onSubmit:c,children:[Object(w.jsx)(qe.a,{children:"Marcas"}),Object(w.jsxs)(Ue.a,{dividers:!0,children:[Object(w.jsx)(cn.a,{children:t.id_marca?"Editar el nombre de la marca":"Ingrese el nombre de la marca"}),Object(w.jsxs)(Z.a,{container:!0,spacing:2,children:[Object(w.jsx)(Z.a,{item:!0,xs:12,children:o&&Object(w.jsx)(Be.a,{})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(Fe.a,{autoFocus:!0,autoComplete:"off",value:t.nombre_marca,name:"nombre_marca",onChange:function(e){var r=e.target,n=r.name,o=r.value;a(Object(Te.a)(Object(Te.a)({},t),{},Object(G.a)({},n,o)))},fullWidth:!0,variant:"outlined",helperText:"Nombre de la marca",disabled:o,required:!0})})]})]}),Object(w.jsxs)(Ye.a,{children:[Object(w.jsxs)(ae.a,{variant:"outlined",onClick:c,children:[" ",t.id_marca?"EDITAR":"AGREGAR"]}),Object(w.jsx)(ae.a,{variant:"outlined",onClick:i,children:"CERRAR"})]})]})})},ln=function(){return Object(w.jsxs)(nn,{children:[Object(w.jsx)(sn,{}),Object(w.jsx)(on,{})]})},dn=Object(c.createContext)(),un=function(){var e=Object(c.useContext)(dn);return{cargando:e.cargando,setCargando:e.setCargando,datosCompra:e.datosCompra,dialogs:e.dialogs,setDialogs:e.setDialogs,setDatosCompra:e.setDatosCompra,inputCodigo:e.inputCodigo,ConsultarProducto:e.ConsultarProducto,formulario:e.formulario,setFormulario:e.setFormulario,InsertarProductoTabla:e.InsertarProductoTabla,Borrar:e.Borrar,cargandoItem:e.cargandoItem,setCargandoItem:e.setCargandoItem,EfectuarCompra:e.EfectuarCompra,Hacer_total:e.Hacer_total,listaCajas:e.listaCajas,setListaCajas:e.setListaCajas,error:e.error,setError:e.setError,LimpiarTodo:e.LimpiarTodo,sumarItem:e.sumarItem,restarItem:e.restarItem,listaDepositos:e.listaDepositos,idDeposito:e.idDeposito,setIdDeposito:e.setIdDeposito,cambiarDeposito:e.cambiarDeposito}},jn=function(e){var t=e.children,a=I(),n=a.token_user,o=a.id_user,i=Object(c.useState)(!0),s=Object(r.a)(i,2),u=s[0],j=s[1],b=Object(c.useState)(!1),p=Object(r.a)(b,2),m=p[0],O=p[1],x=Object(c.useState)({compra:!1,buscar:!1,imprimir:!1}),h=Object(r.a)(x,2),f=h[0],g=h[1],_=ue.fechaActualYMD(),v=ue.HoraActualHMS(),C=ue.getFechaHorarioString,S=Object(c.useRef)(null),F=JSON.parse(localStorage.getItem("compras")),P=Object(c.useState)([]),A=Object(r.a)(P,2),D=A[0],E=A[1],N=Object(c.useState)(F?F.idDeposito:""),T=Object(r.a)(N,2),R=T[0],M=T[1],L=Object(c.useState)(F?F.listaDepositos:[]),W=Object(r.a)(L,2),z=W[0],q=W[1],U=Object(c.useState)({id_producto:"",id_deposito_deposito:"",codigo_producto:"",nombre_producto:"",preciom_producto:"",precio_producto:"",costo_producto:"",proveedor:"",iva_producto:"",stock_producto_deposito:"",stock_nuevo:""}),B=Object(r.a)(U,2),V=B[0],H=B[1],G=Object(c.useState)({fecha_compra:_,nro_factura:"",tipo_factura:"1",fecha_pago:_,total_factura:F?F.total_factura:0,idCaja:"",idProveedor:"1",itemsFactura:F?F.itemsFactura:[]}),J=Object(r.a)(G,2),Y=J[0],K=J[1],X=Object(c.useState)({error:!1,msj:""}),Q=Object(r.a)(X,2),Z=Q[0],$=Q[1],ee=function(e){var t=Object(Te.a)(Object(Te.a)({},V),{},{id_producto:e.id_producto,id_productos_deposito:e.id_productos_deposito,codigo_producto:e.codigo_producto,stock_producto_deposito:e.stock_producto_deposito,proveedor:e.nombre_proveedor,iva_producto:e.porcentaje_impuesto,nombre_producto:e.nombre_producto,costo_producto:e.costo_producto,precio_producto:e.precio_producto,preciom_producto:e.preciom_producto,descripcion_medida:e.descripcion_medida,stock_nuevo:""});H(t)},te=function(){var e=Object(d.a)(l.a.mark((function e(){var t,a,r,c,i,s,u,b,p,m,O,x,h;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=D.findIndex((function(e){return e.id_caja===Y.idCaja})),!((r=parseFloat(null===(t=D[a])||void 0===t?void 0:t.monto_caja)-parseFloat(Y.total_factura))<0&&"1"===Y.tipo_factura)){e.next=7;break}return y()({icon:"error",text:"En la caja elegida no hay suficiente dinero"}),e.abrupt("return",!1);case 7:if(!((c=Object(Qe.a)(Y.itemsFactura)).length>0)){e.next=36;break}if(i={},s={},j(!0),"1"!==Y.tipo_factura){e.next=18;break}return u={id_caja_movimiento:Y.idCaja,id_user_movimiento:o,id_tipo_registro:"6",monto_movimiento:Y.total_factura,detalles_movimiento:"Compra de productos factura contado nro ".concat(Y.nro_factura),fecha_movimiento:C},e.next=16,Promise.all([k.update({table:"cajas",token:n,data:{monto_caja:r},id:Y.idCaja}),k.insert({table:"cajas_movimientos",data:u,token:n})]);case 16:"ok"===(b=e.sent)[0].response&&"ok"===b[1].response||console.log(b[0],b[1]);case 18:return p=[],c.forEach((function(e){i={costo_producto:e.costo_producto,precio_producto:e.precio_producto,preciom_producto:e.preciom_producto},s={stock_producto_deposito:parseFloat(e.stock_producto_deposito)+parseFloat(e.stock_nuevo)},p.push(k.update({table:"productos",data:i,token:n,id:e.id_producto})),p.push(k.update({table:"productos_depositos",data:s,token:n,id:e.id_productos_deposito}))})),m={id_proveedor_compra:1,tipo_factura_compra:Y.tipo_factura,fecha_pago_compra:"".concat(Y.fecha_pago," ").concat(v),fecha_compra:C,nro_factura_compra:Y.nro_factura,total_factura_compra:Y.total_factura,estado_compra:Y.tipo_factura},e.next=23,k.insert({table:"compras",data:m,token:n});case 23:return"ok"!==(O=e.sent).response&&console.log(O),e.next=27,O.last_id;case 27:return x=e.sent,h=[],c.forEach(function(){var e=Object(d.a)(l.a.mark((function e(t){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a={id_item_compra:x,id_producto_compra:t.id_producto,precio_compra:t.costo_producto,precio_venta:t.precio_producto,preciom_venta:t.preciom_producto,cantidad_compra:t.stock_nuevo},h.push(k.insert({table:"compras_items",data:a,token:n}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=32,Promise.allSettled(h);case 32:g(Object(Te.a)(Object(Te.a)({},f),{},{imprimir:!0})),j(!1),e.next=37;break;case 36:y()({icon:"error",text:"No hay items en la factura"}).then((function(){S.current.focus()}));case 37:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ae=function(e){var t=0;e.itemsFactura.forEach((function(e){t+=parseFloat(e.costo_producto)*parseFloat(e.stock_nuevo)})),e.total_factura=t,re(e)},re=function(e){K(e),localStorage.setItem("compras",JSON.stringify(e))},ne=function(){var e=Object(d.a)(l.a.mark((function e(){var t,a,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==R&&R){e.next=3;break}return $({error:!0,msj:"Elija el dep\xf3sito"}),e.abrupt("return",!1);case 3:if(t=S.current.value,a=Object(Te.a)({},Y),!(a.itemsFactura.filter((function(e){return e.codigo_producto===t})).length>0)){e.next=11;break}S.current.value="",y()({text:"Ese producto ya est\xe1 en la lista",icon:"info",timer:1200}).then((function(){oe()})),e.next=16;break;case 11:return O(!0),e.next=14,k.get({table:"productos",include:"proveedors,impuestos,unidad_medidas,productos_depositos",on:"id_impuesto_producto,id_impuesto,id_proveedor_producto,id_proveedor,id_unidad_medida_producto,id_unidad_medida,id_producto,id_producto_deposito",fields:"id_producto,id_productos_deposito,codigo_producto,nombre_producto,tipo_producto,stock_producto_deposito,nombre_proveedor,ruc_proveedor,porcentaje_impuesto,id_producto,costo_producto,preciom_producto,precio_producto, descripcion_medida",where:"codigo_producto,=,'".concat(t,"',and,id_deposito_deposito,=,").concat(R)});case 14:"ok"===(r=e.sent).response?r.found>0?"2"===r.results[0].tipo_producto?y()("Ese c\xf3digo pertenece a un servicio").then((function(){oe()})):(ee(r.results[0]),g(Object(Te.a)(Object(Te.a)({},f),{},{compra:!0}))):y()({text:"Desea registrar ese producto?",icon:"info",buttons:["No","Si"]}).then((function(e){e&&ue.goto("productos/new/?codigo=".concat(t))})):console.log(r);case 16:O(!1);case 17:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),oe=function(){S.current.focus()},ce=Object(c.useCallback)(Object(d.a)(l.a.mark((function e(){var t,a,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(localStorage.getItem("compras")){e.next=8;break}return e.next=3,k.get({table:"depositos",where:"tipo_deposito,=,1"});case 3:t=e.sent,a="","ok"===t.response&&(a=t.found>0?t.results[0].id_deposito:"",q(t.results)),r=JSON.stringify({fecha_compra:_,nro_factura:"",tipo_factura:"1",fecha_pago:_,total_factura:0,idCaja:"",itemsFactura:[],listaDepositos:"ok"===t.response?t.results:[],idDeposito:a}),localStorage.setItem("compras",r);case 8:case"end":return e.stop()}}),e)}))),[_]),ie=Object(c.useCallback)(Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.get({table:"cajas",include:"cajas_users",on:"id_caja,id_caja_caja",where:"id_user_caja,=,".concat(o,",and,estado_caja,=,1"),fields:"id_caja,nombre_caja,monto_caja"});case 2:"ok"===(t=e.sent).response?E(t.results):console.log(t),j(!1);case 5:case"end":return e.stop()}}),e)}))),[o]);return Object(c.useEffect)((function(){var e=!0,t=new AbortController;return oe(),e&&(ie(),ce()),function(){e=!1,t.abort()}}),[ie,ce]),Object(w.jsx)(dn.Provider,{value:{cargando:u,setCargando:j,dialogs:f,setDialogs:g,datosCompra:Y,setDatosCompra:K,inputCodigo:S,ConsultarProducto:ne,formulario:V,setFormulario:H,InsertarProductoTabla:function(e){ee(e),g(Object(Te.a)(Object(Te.a)({},f),{},{compra:!0}))},Borrar:function(e){var t=Object(Te.a)({},Y),a=t.itemsFactura.findIndex((function(t){return t.codigo_producto===e}));t.itemsFactura.splice(a,1),ae(t)},cargandoItem:m,setCargandoItem:O,EfectuarCompra:te,Hacer_total:ae,listaCajas:D,setListaCajas:E,error:Z,setError:$,LimpiarTodo:function(){re({fecha_compra:_,nro_factura:"",tipo_factura:"1",fecha_pago:_,total_factura:0,idCaja:"",itemsFactura:[],listaDepositos:z}),oe()},sumarItem:function(e){var t=Object(Te.a)({},Y),a=parseFloat(t.itemsFactura[e].stock_nuevo)+1;t.itemsFactura[e].stock_nuevo=a,ae(t)},restarItem:function(e){var t=Object(Te.a)({},Y),a=parseFloat(t.itemsFactura[e].stock_nuevo)-1;a>0&&(t.itemsFactura[e].stock_nuevo=a,ae(t))},listaDepositos:z,idDeposito:R,setIdDeposito:M,cambiarDeposito:function(e){M(e)}},children:t})},bn=Object(z.a)((function(e){var t;return{tableContainer:{position:"relative",overflowX:"unset",marginBottom:25,padding:"2px",transition:"all 0.1s linear"},tableheader:Object(G.a)({},e.breakpoints.down("lg"),{display:"none"}),tablecell:{position:"sticky",zIndex:1,transition:"all 0.2s linear"},tablelist:(t={},Object(G.a)(t,e.breakpoints.down("lg"),{display:"flex",flexDirection:"column",border:"1px solid silver",margin:"0 0 10px 0"}),Object(G.a)(t,"borderRadius","8px"),t),tableitem:Object(G.a)({},e.breakpoints.down("md"),{display:"flex",justifyContent:"space-between"}),columname:Object(G.a)({display:"none",textTransform:"uppercase"},e.breakpoints.down("md"),{display:"block"})}})),pn=a(112),mn=function(){var e=bn(),t=un(),a=t.datosCompra,r=t.Borrar,n=t.sumarItem,o=t.restarItem,c=a.itemsFactura.slice(0).reverse();return Object(w.jsxs)(w.Fragment,{children:[c.map((function(t,a){return Object(w.jsxs)(ie.a,{className:e.tablelist,children:[Object(w.jsxs)(se.a,{className:e.tableitem,children:[Object(w.jsx)("span",{className:e.columname,children:"C\xd3DIGO:"}),Object(w.jsx)("span",{children:t.codigo_producto})]}),Object(w.jsxs)(se.a,{className:e.tableitem,children:[Object(w.jsx)("span",{className:e.columname,children:"CANTIDAD:"}),Object(w.jsx)("span",{children:Object(w.jsxs)(we.a,{direction:"row",children:[Object(w.jsx)(Pe.a,{onClick:function(){o(a)},children:Object(w.jsx)(ee.a,{children:"remove_circle_outline"})}),Object(w.jsx)(te.a,{variant:"h6",children:t.stock_nuevo}),Object(w.jsx)(Pe.a,{onClick:function(){n(a)},children:Object(w.jsx)(ee.a,{children:"add_circle_outline"})})]})})]}),Object(w.jsxs)(se.a,{className:e.tableitem,children:[Object(w.jsx)("span",{className:e.columname,children:"DESCRIP:"}),Object(w.jsx)("span",{children:Object(w.jsxs)(te.a,{variant:"overline",children:[" ",t.nombre_producto]})})]}),Object(w.jsxs)(se.a,{className:e.tableitem,children:[Object(w.jsx)("span",{className:e.columname,children:"PRECIO:"}),Object(w.jsx)("span",{children:ue.numberSeparator(parseFloat(t.costo_producto))})]}),Object(w.jsxs)(se.a,{className:e.tableitem,children:[Object(w.jsx)("span",{className:e.columname,children:"SUBTOTAL:"}),Object(w.jsx)("span",{children:ue.numberSeparator(parseFloat(t.costo_producto)*parseFloat(t.stock_nuevo))})]}),Object(w.jsxs)(se.a,{className:e.tableitem,children:[Object(w.jsx)("span",{className:e.columname,children:"OPCIONES:"}),Object(w.jsx)("span",{children:(c=t.codigo_producto,Object(w.jsxs)("div",{children:[Object(w.jsx)(Ae.a,{title:"Informaci\xf3n del producto",arrow:!0,children:Object(w.jsx)(Pe.a,{onClick:function(){},children:Object(w.jsx)(ee.a,{style:{color:pn.a[500]},children:"info"})})}),Object(w.jsx)(Ae.a,{title:"Remover",arrow:!0,children:Object(w.jsx)(Pe.a,{onClick:function(){r(c)},children:Object(w.jsx)(ee.a,{color:"secondary",children:"delete"})})})]}))})]})]},a);var c})),0===c.length&&Object(w.jsx)(w.Fragment,{children:Object(w.jsx)(ie.a,{children:Object(w.jsx)(se.a,{colSpan:7,align:"center",children:Object(w.jsx)(de.a,{severity:"info",variant:"outlined",icon:Object(w.jsx)(ee.a,{children:"shopping_basket"}),children:Object(w.jsx)(Ar.a,{children:"FACTURA VAC\xcdA"})})})})})]})},On=[{field:"codigo_producto",headerName:"C\xf3digo"},{field:"cantidad_producto",headerName:"Cantidad"},{field:"nombre_producto",headerName:"Descripci\xf3n"},{field:"precio_producto",headerName:"Precio"},{field:"subtotal",headerName:"Subtotal"}],xn=function(){var e=bn();return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)(ne.a,{className:e.tableContainer,children:Object(w.jsxs)(oe.a,{children:[Object(w.jsx)(ce.a,{className:e.tableheader,children:Object(w.jsxs)(ie.a,{children:[On.map((function(t,a){return Object(w.jsx)(se.a,{align:"left",className:e.tablecell,children:Object(w.jsx)(te.a,{variant:"overline",children:t.headerName})},a)})),Object(w.jsx)(se.a,{className:e.tablecell,children:Object(w.jsx)(te.a,{variant:"overline",children:"OPCIONES"})})]})}),Object(w.jsx)(le.a,{children:Object(w.jsx)(mn,{})})]})})})},hn=function(){var e,t=un(),a=t.listaDepositos,n=t.cambiarDeposito,o=t.idDeposito,c=i.a.useState(null),s=Object(r.a)(c,2),l=s[0],d=s[1],u=Boolean(l),j=(null===(e=a.filter((function(e){return e.id_deposito===o}))[0])||void 0===e?void 0:e.nombre_deposito)||"Selecciona deposito";return Object(w.jsxs)("div",{children:[Object(w.jsx)(ae.a,{onClick:function(e){d(e.currentTarget)},children:j}),Object(w.jsx)(qt.a,{anchorEl:l,open:u,onClose:function(){d(null)},children:a.map((function(e,t){return Object(w.jsx)(Je.a,{onClick:function(){!function(e){n(e.id_deposito),d(null)}(e)},children:e.nombre_deposito},t)}))})]})},fn=function(){var e=un(),t=e.inputCodigo,a=e.ConsultarProducto,r=e.datosCompra,n=e.setDatosCompra,o=e.cargandoItem,i=e.idDeposito,s=e.EfectuarCompra,l=e.dialogs,d=e.setDialogs,u=e.cargando,j=e.listaCajas,b=e.error,p=e.setError,m=e.LimpiarTodo,O=Object(c.useRef)(null),x=function(e){n(Object(Te.a)(Object(Te.a)({},r),{},Object(G.a)({},e.target.name,e.target.value)))},h=function(){""===t.current.value?p(Object(Te.a)(Object(Te.a)({},b),{},{error:!0,msj:"Ingrese c\xf3digo correctamente"})):a()};return Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(Br,{onClose:function(){p(Object(Te.a)(Object(Te.a)({},b),{},{error:!1}))},open:b.error,message:b.msj}),Object(w.jsxs)(Z.a,{container:!0,spacing:1,children:[Object(w.jsx)(Z.a,{item:!0,xs:12,md:9,children:Object(w.jsxs)(Z.a,{container:!0,spacing:1,children:[Object(w.jsx)(Z.a,{item:!0,sm:12,md:6,children:Object(w.jsx)(Fe.a,{autoFocus:!0,fullWidth:!0,label:"C\xf3digo",onKeyPress:function(e){return"Enter"===e.key&&h()},inputRef:t,InputProps:{startAdornment:Object(w.jsx)(Ie.a,{position:"start",children:Object(w.jsxs)(Pe.a,{onClick:function(){i?d(Object(Te.a)(Object(Te.a)({},l),{},{buscar:!0})):p(Object(Te.a)(Object(Te.a)({},b),{},{error:!0,msj:"Elija dep\xf3sito"}))},children:[Object(w.jsx)(ee.a,{children:"search"})," "]})}),endAdornment:Object(w.jsx)(Ie.a,{position:"end",children:o&&Object(w.jsx)(U.a,{size:24})})},helperText:"Ingrese el c\xf3digo del producto o busquelo con la lupa"})}),Object(w.jsx)(Z.a,{item:!0,sm:12,md:2,children:Object(w.jsx)(ae.a,{size:"large",color:"primary",variant:"outlined",onClick:h,children:"Consultar"})}),Object(w.jsx)(Z.a,{item:!0,sm:12,md:4,children:!u&&Object(w.jsx)(hn,{})}),Object(w.jsx)(Z.a,{item:!0,sm:12,children:u?Object(w.jsx)(V,{}):Object(w.jsx)(xn,{})})]})}),Object(w.jsx)(Z.a,{item:!0,xs:12,md:3,children:Object(w.jsxs)(Z.a,{container:!0,spacing:2,children:[Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(te.a,{variant:"h6",children:"DATOS DE COMPRA"})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(Fe.a,{fullWidth:!0,type:"date",name:"fecha_compra",label:"Fecha",value:r.fecha_compra,onChange:x})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(Fe.a,{fullWidth:!0,inputRef:O,name:"nro_factura",onChange:x,label:"Nro factura",autoComplete:"off",value:r.nro_factura})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsxs)(Ve.a,{component:"fieldset",children:[Object(w.jsx)(ot.a,{value:"1",control:Object(w.jsx)(ct.a,{checked:"1"===r.tipo_factura,onChange:function(e){n(Object(Te.a)(Object(Te.a)({},r),{},{tipo_factura:"1"}))},color:"primary"}),label:"Factura contado",labelPlacement:"end"}),Object(w.jsx)(ot.a,{value:"2",control:Object(w.jsx)(ct.a,{checked:"2"===r.tipo_factura,color:"primary",onChange:function(e){n(Object(Te.a)(Object(Te.a)({},r),{},{tipo_factura:"2",idCaja:""}))}}),label:"Factura cr\xe9dito",labelPlacement:"end"})]})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:"1"===r.tipo_factura&&Object(w.jsxs)(Ve.a,{fullWidth:!0,children:[Object(w.jsx)(He.a,{variant:"outlined",children:"Seleccione la caja"}),Object(w.jsxs)(Ge.a,{name:"id_caja",variant:"outlined",disabled:"2"===r.tipo_factura,value:r.idCaja,onChange:function(e){n(Object(Te.a)(Object(Te.a)({},r),{},{idCaja:e.target.value}))},children:[j.length<1&&Object(w.jsx)(Je.a,{disabled:!0,children:"No hay cajas disponibles"}),Object(w.jsx)(Je.a,{disabled:!0,children:"Seleccione caja"}),j.map((function(e,t){return Object(w.jsx)(Je.a,{value:e.id_caja,children:e.nombre_caja},t)}))]})]})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:"2"===r.tipo_factura&&Object(w.jsx)(Fe.a,{type:"date",disabled:"1"===r.tipo_factura,name:"fecha_pago",label:"Fecha de pago",helperText:"En caso de que sea factura a cr\xe9dito",value:r.fecha_pago,onChange:function(e){new Date>new Date(e.target.value)?y()({text:"La fecha no puede ser en el pasado",icon:"error"}):n(Object(Te.a)(Object(Te.a)({},r),{},{fecha_pago:e.target.value}))}})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsxs)(te.a,{variant:"button",children:["TOTAL: ",ue.numberSeparator(r.total_factura)," "]})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(ae.a,{variant:"outlined",size:"large",color:"secondary",onClick:function(){return r.itemsFactura.length<1?(p(Object(Te.a)(Object(Te.a)({},b),{},{error:!0,msj:"No hay items en la factura"})),!1):""===r.idCaja&&"1"===r.tipo_factura?(p(Object(Te.a)(Object(Te.a)({},b),{},{error:!0,msj:"Seleccione la caja"})),!1):""===r.nro_factura?(p(Object(Te.a)(Object(Te.a)({},b),{},{error:!0,msj:"Especifique el n\xfamero de factura"})),O.current.focus(),!1):(p(Object(Te.a)(Object(Te.a)({},b),{},{error:!1,msj:""})),void s())},fullWidth:!0,children:"Procesar compra"})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(ae.a,{variant:"outlined",size:"large",color:"primary",onClick:m,fullWidth:!0,children:"Nueva"})})]})})]})]})},gn=function(){return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)(ye,{nombretabla:"Compras realizadas",subtitle:"Compras realizadas",icono:"shopping_bag",columnas:[],filas:[],Acciones:function(){},showOptions:!0})})},_n=function(){var e=un(),t=e.dialogs,a=e.setDialogs,r=e.formulario,n=e.setFormulario,o=e.inputCodigo,c=e.Hacer_total,i=e.datosCompra,s=e.idDeposito,l=function(){o.current.value="",n({codigo_producto:"",nombre_producto:"",preciom_producto:"",precio_producto:"",costo_producto:"",stock_nuevo:"",proveedor:"",iva_producto:"",stock_producto_deposito:""}),a(Object(Te.a)(Object(Te.a)({},t),{},{compra:!1,buscar:!1})),o.current.focus()},d=function(e){var t=e.target,a=t.name,o=t.value;n(Object(Te.a)(Object(Te.a)({},r),{},Object(G.a)({},a,o)))};return Object(w.jsxs)(ze.a,{fullWidth:!0,open:t.compra,onClose:l,scroll:"body",children:[Object(w.jsx)(qe.a,{children:Object(w.jsxs)(we.a,{direction:"row",justifyContent:"space-between",children:["Datos de compra",Object(w.jsx)(Pe.a,{onClick:l,children:Object(w.jsx)(ee.a,{children:"close"})})]})}),Object(w.jsx)(Ue.a,{dividers:!0,children:Object(w.jsxs)(Z.a,{container:!0,spacing:2,children:[Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill,minmax(250px,1fr)",gap:"5px"},children:[Object(w.jsxs)(de.a,{icon:!1,variant:"outlined",children:[Object(w.jsxs)("p",{children:["Codigo: ",r.codigo_producto," "]}),Object(w.jsxs)("p",{children:["Nombre: ",r.nombre_producto.toUpperCase()," "]}),Object(w.jsx)(hn,{})]}),Object(w.jsxs)(de.a,{icon:!1,variant:"outlined",children:[Object(w.jsxs)("p",{children:["Proveedor: ",r.proveedor]}),Object(w.jsxs)("p",{children:["Impuesto: ",r.iva_producto," %"]}),Object(w.jsxs)("p",{children:["Stock actual: ",r.stock_producto_deposito," ",r.descripcion_medida]})]})]})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(te.a,{variant:"overline",children:"Ingrese los datos de compra"})}),Object(w.jsx)(Z.a,{item:!0,xs:12,md:6,children:Object(w.jsx)(Fe.a,{autoFocus:!0,fullWidth:!0,variant:"outlined",onChange:d,value:r.stock_nuevo,name:"stock_nuevo",label:"Stock o cantidad comprada",InputProps:{inputProps:{min:0},inputComponent:Va}})}),Object(w.jsx)(Z.a,{item:!0,xs:12,md:6,children:Object(w.jsx)(Fe.a,{fullWidth:!0,variant:"outlined",onChange:d,name:"costo_producto",value:r.costo_producto,label:"Precio de compra o costo",InputProps:{inputProps:{min:0},inputComponent:Va}})}),Object(w.jsx)(Z.a,{item:!0,xs:12,md:6,children:Object(w.jsx)(Fe.a,{fullWidth:!0,variant:"outlined",onChange:d,value:r.precio_producto,name:"precio_producto",label:"Precio de venta",InputProps:{inputProps:{min:0},inputComponent:Va},helperText:"Precio con impuesto incluido"})}),Object(w.jsx)(Z.a,{item:!0,xs:12,md:6,children:Object(w.jsx)(Fe.a,{fullWidth:!0,variant:"outlined",onChange:d,value:r.preciom_producto,name:"preciom_producto",label:"Precio de venta mayorista",InputProps:{inputProps:{min:0},inputComponent:Va},helperText:"Precio con impuesto incluido"})})]})}),Object(w.jsxs)(Ye.a,{children:[Object(w.jsx)(ae.a,{variant:"outlined",onClick:function(){if(""!==r.stock_nuevo&&""!==r.preciom_producto&&""!==r.precio_producto&&""!==r.costo_producto&&(""!==s||(y()({text:"Seleccione un deposito.",timer:1200}),0))){var e=Object(Te.a)({},i),t=Object(Te.a)({},r);t.id_deposito_deposito=s,e.itemsFactura.push(t),c(e),l()}},children:"Agregar"}),Object(w.jsx)(ae.a,{variant:"outlined",onClick:l,children:"Cancelar"})]})]})},vn=function(){var e=un(),t=e.setDialogs,a=e.dialogs,n=e.InsertarProductoTabla,o=e.idDeposito,s=Object(c.useState)([]),u=Object(r.a)(s,2),j=u[0],b=u[1],p=Object(c.useState)(!1),m=Object(r.a)(p,2),O=m[0],x=m[1],h=Object(c.useCallback)(function(){var e=Object(d.a)(l.a.mark((function e(t){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:""!==(a=t.target.value)?(x(!0),setTimeout(Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.get({table:"productos",include:"proveedors,impuestos,unidad_medidas,productos_depositos",on:"id_impuesto_producto,id_impuesto,id_proveedor_producto,id_proveedor,id_unidad_medida_producto,id_unidad_medida,id_producto,id_productos_deposito",fields:"id_producto,codigo_producto,nombre_producto,tipo_producto,nombre_proveedor,ruc_proveedor,porcentaje_impuesto,id_producto,costo_producto,preciom_producto,precio_producto,descripcion_medida,id_productos_deposito",where:"tipo_producto,=,1,and,id_deposito_deposito,=,".concat(o),filtersField:"nombre_producto",filtersSearch:a,pagesize:"10"});case 2:"ok"===(t=e.sent).response?b(t.results):console.log(t);case 4:case"end":return e.stop()}}),e)}))),500)):b([]),x(!1);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[o]),f=function(){t(Object(Te.a)(Object(Te.a)({},a),{},{buscar:!1}))};return Object(w.jsxs)(ze.a,{fullWidth:!0,open:a.buscar,onClose:f,children:[Object(w.jsx)(qe.a,{children:"Buscar producto"}),Object(w.jsx)(Ue.a,{dividers:!0,children:Object(w.jsx)(sr.a,{loadingText:"Cargando...",loading:O,noOptionsText:"Sin productos en lista...",onChange:function(e,t){f(),n(t)},disableClearable:!0,autoComplete:!0,autoHighlight:!0,autoSelect:!0,options:j,getOptionLabel:function(e){return e.nombre_producto+" - "+e.codigo_producto},fullWidth:!0,renderInput:function(e){return Object(w.jsx)(Fe.a,Object(Te.a)(Object(Te.a)({},e),{},{autoFocus:!0,label:"Buscar producto",InputProps:Object(Te.a)(Object(Te.a)({},e.InputProps),{},{endAdornment:Object(w.jsxs)(i.a.Fragment,{children:[O?Object(w.jsx)(U.a,{color:"inherit",size:20}):null,e.InputProps.endAdornment]})}),onChange:h,fullWidth:!0,placeholder:"Escriba el nombre del producto",variant:"outlined"}))}})}),Object(w.jsx)(Ye.a,{children:Object(w.jsx)(ae.a,{onClick:f,variant:"outlined",children:"Cerrar"})})]})};var Cn=function(){var e=un(),t=e.datosCompra,a=e.dialogs,r=e.setDialogs,n=e.LimpiarTodo,o=Object(Te.a)({},t),c=function(){r(Object(Te.a)(Object(Te.a)({},a),{},{imprimir:!1})),n()};return Object(w.jsx)(w.Fragment,{children:Object(w.jsxs)(ze.a,{open:a.imprimir,fullWidth:!0,maxWidth:"md",onClose:c,TransitionComponent:yt.a,children:[Object(w.jsx)(qe.a,{children:"Imprimir"}),Object(w.jsx)(Ue.a,{dividers:!0,children:Object(w.jsxs)("div",{id:"print_compra",className:"print",style:{display:"grid",gap:"2px"},children:[Object(w.jsx)("h4",{children:"Compra"}),Object(w.jsxs)("p",{children:["Fecha: ",o.fecha_compra]}),Object(w.jsxs)("table",{className:"collapse",border:"1",style:{borderCollapse:"collapse"},children:[Object(w.jsx)("thead",{children:Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{children:"Cod."}),Object(w.jsx)("td",{children:"Cant."}),Object(w.jsx)("td",{children:"Desc."}),Object(w.jsx)("td",{children:"Cost"}),Object(w.jsx)("td",{children:"Prec"}),Object(w.jsx)("td",{children:"Total"})]})}),Object(w.jsxs)("tbody",{children:[o.itemsFactura.map((function(e,t){return Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{children:e.codigo_producto}),Object(w.jsx)("td",{children:e.stock_nuevo}),Object(w.jsx)("td",{children:e.nombre_producto}),Object(w.jsx)("td",{children:e.costo_producto}),Object(w.jsx)("td",{children:Et.numberSeparator(e.precio_producto)}),Object(w.jsx)("td",{children:Et.numberSeparator(parseFloat(e.precio_producto)*parseFloat(e.stock_nuevo))})]},t)})),Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{colSpan:4}),Object(w.jsx)("td",{children:"Total:"}),Object(w.jsx)("td",{children:Et.numberFormat(o.total_factura)})]})]})]})]})}),Object(w.jsxs)(Ye.a,{children:[Object(w.jsx)(ae.a,{variant:"outlined",onClick:function(){Y()({type:"html",printable:"print_compra",style:" .collapse {border-collapse:collapse}"})},children:"Imprimir"}),Object(w.jsx)(ae.a,{variant:"outlined",onClick:c,children:"Cerrar"})]})]})})},kn=function(){var e=Object(c.useState)(0),t=Object(r.a)(e,2),a=t[0],n=t[1],o=function(e){var t=e.children,r=e.index;return a===r&&Object(w.jsx)("div",{style:{marginTop:"25px"},children:t})};return Object(w.jsxs)(w.Fragment,{children:[Object(w.jsxs)(Na.a,{indicatorColor:"primary",textColor:"primary",value:a,onChange:function(e,t){n(t)},children:[Object(w.jsx)(Ta.a,{label:"Nueva compra"}),Object(w.jsx)(Ta.a,{label:"Lista de compras"})]}),Object(w.jsxs)(o,{value:a,index:0,children:[Object(w.jsx)(fn,{}),Object(w.jsx)(Cn,{}),Object(w.jsx)(vn,{})]}),Object(w.jsx)(o,{value:a,index:1,children:Object(w.jsx)(gn,{})}),Object(w.jsx)(_n,{})]})},Sn=function(){return Object(w.jsx)(jn,{children:Object(w.jsx)(kn,{})})},yn=Object(c.createContext)();var wn=function(){var e=Object(c.useContext)(yn);return{cargas:e.cargas,lista:e.lista,listaMonedas:e.listaMonedas,listaUsers:e.listaUsers,listaRegistrosMonedas:e.listaRegistrosMonedas,formEdit:e.formEdit,setFormEdit:e.setFormEdit,dialogs:e.dialogs,setDialogs:e.setDialogs,formNew:e.formNew,formAbrir:e.formAbrir,setFormAbrir:e.setFormAbrir,setFormNew:e.setFormNew,formTransferencia:e.formTransferencia,setFormTransferencia:e.setFormTransferencia,initialTransferencia:e.initialTransferencia,initialFormNew:e.initialFormNew,Funciones:e.Funciones,agregarCajaNueva:e.agregarCajaNueva,editarCaja:e.editarCaja,aperturaCaja:e.aperturaCaja,errors:e.errors,setErrors:e.setErrors,transferir:e.transferir,totalSumaMonedasArqueo:e.totalSumaMonedasArqueo,setTotalSumaMonedasArqueo:e.setTotalSumaMonedasArqueo,datosCajaCierre:e.datosCajaCierre,setDatosCajaCierre:e.setDatosCajaCierre,arqueo:e.arqueo,setArqueo:e.setArqueo,getLista:e.getLista,dialogQuery:e.dialogQuery,dialogID:e.dialogID}},Fn=function(e){var t=e.children,a=I(),n=a.token_user,o=a.id_user,s=function(){var e=Object(H.f)().search;return i.a.useMemo((function(){return new URLSearchParams(e)}),[e])}(),u=s.get("dialog")?s.get("dialog"):"",j=s.get("id")?s.get("id"):"",b={editar:!1,abrir:"open"===u,cerrar:!1,nuevo:"new"===u,transferencia:!1,arqueo:!1,arqueoFinal:!1},p=Object(c.useState)(b),m=Object(r.a)(p,2),O=m[0],x=m[1],h=Object(c.useState)({nuevo:!1,nuevoMensaje:"",editar:!1,editarMensaje:"",abrir:!1,abrirMensaje:"",transferencia:!1,transferenciaMensaje:""}),f=Object(r.a)(h,2),g=f[0],_=f[1],v=Object(c.useState)({lista:!0,editar:!1,cerrar:!1,abrir:!1,nuevo:!1,transferencia:!1,arqueo:!1,arqueoFinal:!1}),C=Object(r.a)(v,2),S=C[0],F=C[1],P=Object(c.useState)(0),A=Object(r.a)(P,2),D=A[0],E=A[1],N=Object(c.useState)([]),T=Object(r.a)(N,2),R=T[0],M=T[1],L=Object(c.useState)([]),W=Object(r.a)(L,2),z=W[0],q=W[1],U=Object(c.useState)([]),B=Object(r.a)(U,2),V=B[0],G=B[1],J=Object(c.useState)([]),Y=Object(r.a)(J,2),K=Y[0],X=Y[1],Q=Object(c.useState)([]),Z=Object(r.a)(Q,2),$=Z[0],ee=Z[1],te=Object(c.useState)({}),ae=Object(r.a)(te,2),re=ae[0],ne=ae[1],oe=Object(c.useState)({}),ce=Object(r.a)(oe,2),ie=ce[0],se=ce[1],le={id_moneda_caja:"",id_user_caja:"",nombre_caja:"",monto_inicial:"0",monto_cierre:"0",monto_caja:"0",fecha_apertura:ue.getFechaHorarioString(),fecha_creacion:ue.getFechaHorarioString(),ult_mov_caja:ue.getFechaHorarioString(),tipo_caja:"1",estado_caja:"1"},de=Object(c.useState)(le),je=Object(r.a)(de,2),be=je[0],pe=je[1],me=Object(c.useState)({id_caja:"",nombre_caja:""}),Oe=Object(r.a)(me,2),xe=Oe[0],he=Oe[1],fe={id_caja:"",id_caja_transferencia:"",nombre_caja:"",monto_transferir:"0",monto_caja:"",fecha_movimiento:""},ge=Object(c.useState)(fe),_e=Object(r.a)(ge,2),ve=_e[0],Ce=_e[1],ke=function(){var e=Object(d.a)(l.a.mark((function e(){var t,a,r,c,i,s,d,j;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return F(Object(Te.a)(Object(Te.a)({},S),{},{nuevo:!0})),delete(t=Object(Te.a)({},be)).id_user_caja,t.monto_caja=be.monto_inicial,e.next=6,k.insert({table:"cajas",data:t,token:n});case 6:if("ok"!==(a=e.sent).response){e.next=19;break}return r=a.last_id,c=be.id_user_caja,i={id_user_caja:c,id_caja_caja:r},s={id_caja_movimiento:r,id_user_movimiento:o,id_tipo_registro:"3",monto_movimiento:be.monto_inicial,monto_sin_efectivo:"0",detalles_movimiento:"Creaci\xf3n, habilitaci\xf3n y apertura de caja",fecha_movimiento:be.fecha_apertura},d={id_caja_arqueo:r,id_user_arqueo:o,monto_arqueo:be.monto_inicial,tipo_arqueo:"1",fecha_arqueo:ue.getFechaHorarioString()},e.next=15,Promise.all([k.insert({table:"cajas_users",data:i,token:n}),k.insert({table:"cajas_movimientos",data:s,token:n}),k.insert({table:"cajas_arqueos",token:n,data:d})]);case 15:"ok"===(j=e.sent)[0].response&&"ok"===j[1].response&&y()({text:"Agregado y habilitado correctamente",timer:1200,icon:"success"}).then((function(){"new"===u?ue.goto("ventas"):(x(Object(Te.a)(Object(Te.a)({},O),{},{nuevo:!1})),Fe(!1))})),e.next=20;break;case 19:console.log(a);case 20:F(Object(Te.a)(Object(Te.a)({},S),{},{nuevo:!1}));case 21:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Se=function(){var e=Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return F(Object(Te.a)(Object(Te.a)({},S),{},{editar:!0})),e.next=3,k.update({table:"cajas",data:xe,id:xe.id_caja,token:n});case 3:"ok"===e.sent.response&&(y()({text:"Editado correctamente",icon:"success",timer:1200}),Fe(!1),x(Object(Te.a)(Object(Te.a)({},O),{},{editar:!1}))),F(Object(Te.a)(Object(Te.a)({},S),{},{editar:!1}));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ye=function(){var e=Object(d.a)(l.a.mark((function e(){var t,a,r,c,i,s,d;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return F(Object(Te.a)(Object(Te.a)({},S),{},{transferencia:!0})),t=z.find((function(e){return e.id_caja===ve.id_caja_transferencia})),a={id_caja:ve.id_caja,monto_caja:parseFloat(ve.monto_caja)-parseFloat(ve.monto_transferir)},r={id_caja:ve.id_caja_transferencia,monto_caja:parseFloat(t.monto_caja)+parseFloat(ve.monto_transferir)},e.next=6,k.update({table:"cajas",data:a,id:ve.id_caja,token:n});case 6:if("ok"!==(c=e.sent).response){e.next=18;break}return e.next=10,k.update({table:"cajas",data:r,id:ve.id_caja_transferencia,token:n});case 10:return i=e.sent,s={id_caja_movimiento:ve.id_caja,id_user_movimiento:o,id_tipo_registro:"16",fecha_movimiento:ue.getFechaHorarioString(),monto_movimiento:parseFloat(ve.monto_transferir),detalles_movimiento:"Transferencia de caja ".concat(ve.nombre_caja," ").concat(ve.id_caja," a: ").concat(t.nombre_caja," ").concat(t.id_caja," ")},e.next=14,k.insert({table:"cajas_movimientos",data:s,token:n});case 14:d=e.sent,"ok"===i.response&&"ok"===d.response?(y()({text:"Transferido correctamente",icon:"success",timer:1200}),Fe(!1),x(Object(Te.a)(Object(Te.a)({},O),{},{transferencia:!1}))):console.log(i,d),e.next=19;break;case 18:console.log(c);case 19:F(Object(Te.a)(Object(Te.a)({},S),{},{transferencia:!1}));case 20:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),we=function(){var e=Object(d.a)(l.a.mark((function e(t){var a,r,c,i,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return F(Object(Te.a)(Object(Te.a)({},S),{},{abrir:!0})),a=""===j?t.id_caja:j,r={estado_caja:"1",fecha_apertura:ue.getFechaHorarioString(),ult_mov_caja:ue.getFechaHorarioString(),monto_inicial:t.monto_inicial,monto_caja:t.monto_inicial},c={id_caja_movimiento:a,id_user_movimiento:o,id_tipo_registro:"3",monto_movimiento:"0",monto_sin_efectivo:"0",detalles_movimiento:"Apertura de caja",fecha_movimiento:t.fecha_apertura},i={id_caja_arqueo:a,monto_arqueo:t.monto_inicial,tipo_arqueo:"1",id_user_arqueo:o,fecha_arqueo:ue.getFechaHorarioString()},e.next=7,Promise.all([k.update({table:"cajas",data:r,id:a,token:n}),k.insert({table:"cajas_movimientos",data:c,token:n}),k.insert({table:"cajas_arqueos",token:n,data:i})]);case 7:"ok"===(s=e.sent)[1].response&&"ok"===s[0].response?y()({text:"Caja abierta correctamente",icon:"success",timer:1200}).then((function(){"open"===u?ue.goto("ventas"):(Fe(!1),x(Object(Te.a)(Object(Te.a)({},O),{},{abrir:!1})))})):console.log(s),F(Object(Te.a)(Object(Te.a)({},S),{},{abrir:!1}));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Fe=Object(c.useCallback)(Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return F({lista:!0}),e.next=3,Promise.all([k.get({table:"cajas",include:"users,monedas,cajas_users",on:"id_user,id_user_caja,id_moneda,id_moneda_caja,id_caja,id_caja_caja",fields:"nombre_caja,id_caja,estado_caja,nombre_user,monto_caja,monto_inicial,monto_cierre,nombre_moneda,abreviatura_moneda,fecha_apertura"}),k.get({table:"users",token:n,fields:"nombre_user,id_user"}),k.get({table:"monedas",fields:"nombre_moneda,id_moneda,abreviatura_moneda"}),k.get({table:"monedas_registros"})]);case 3:t=e.sent,q(t[0].results),G(t[1].results),X(t[2].results),ee(t[3].results),F({lista:!1,editar:!1,cerrar:!1,abrir:!1,nuevo:!1});case 9:case"end":return e.stop()}}),e)}))),[n]);return Object(c.useEffect)((function(){var e=new AbortController,t=!0;return t&&Fe(),function(){t=!1,e.abort()}}),[Fe]),Object(w.jsx)(yn.Provider,{value:{cargas:S,lista:z,listaMonedas:K,listaUsers:V,listaRegistrosMonedas:$,formEdit:xe,setFormEdit:he,dialogs:O,setDialogs:x,formNew:be,formAbrir:ie,setFormAbrir:se,setFormNew:pe,formTransferencia:ve,setFormTransferencia:Ce,initialTransferencia:fe,initialFormNew:le,Funciones:ue,agregarCajaNueva:ke,editarCaja:Se,aperturaCaja:we,errors:g,setErrors:_,transferir:ye,totalSumaMonedasArqueo:D,setTotalSumaMonedasArqueo:E,datosCajaCierre:re,setDatosCajaCierre:ne,arqueo:R,setArqueo:M,getLista:Fe,dialogQuery:u,dialogID:j},children:t})},In=a(863),Pn=function(){var e=wn(),t=e.dialogs,a=e.setDialogs,r=e.formNew,n=e.setFormNew,o=e.initialFormNew,c=e.listaUsers,i=e.listaMonedas,s=e.errors,l=e.setErrors,d=e.agregarCajaNueva,u=e.cargas,j=function(e){var t=e.target,a=t.value,o=t.name;n(Object(Te.a)(Object(Te.a)({},r),{},Object(G.a)({},o,a)))},b=function(){a(Object(Te.a)(Object(Te.a)({},t),{},{nuevo:!1})),n(o)};return Object(w.jsxs)(ze.a,{open:t.nuevo,onClose:b,fullWidth:!0,children:[Object(w.jsx)(qe.a,{children:"Habilitar y agregar nueva caja"}),Object(w.jsx)(Ue.a,{dividers:!0,children:Object(w.jsxs)(Z.a,{container:!0,spacing:2,children:[Object(w.jsxs)(Z.a,{item:!0,xs:12,children:[s.nuevo&&Object(w.jsx)(de.a,{icon:!1,severity:"error",children:s.nuevoMensaje}),u.nuevo&&Object(w.jsx)(Be.a,{})]}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(Fe.a,{autoFocus:!0,required:!0,fullWidth:!0,name:"nombre_caja",value:r.nombre_caja,onChange:j,label:"Nombre de caja"})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(Fe.a,{fullWidth:!0,name:"monto_inicial",value:r.monto_inicial,onChange:j,label:"Monto inicial",InputProps:{inputComponent:Va,inputProps:{min:0}}})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsxs)(Ve.a,{fullWidth:!0,children:[Object(w.jsx)(He.a,{children:"Asignar a un usuario"}),Object(w.jsx)(Ge.a,{onChange:j,name:"id_user_caja",value:r.id_user_caja,fullWidth:!0,children:c.map((function(e){return Object(w.jsx)(Je.a,{value:e.id_user,children:e.nombre_user},e.id_user)}))}),Object(w.jsx)(In.a,{children:" "})]})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsxs)(Ve.a,{fullWidth:!0,children:[Object(w.jsx)(He.a,{children:"Moneda de caja"}),Object(w.jsx)(Ge.a,{onChange:j,name:"id_moneda_caja",value:r.id_moneda_caja,fullWidth:!0,children:i.map((function(e,t){return Object(w.jsx)(Je.a,{value:e.id_moneda,children:e.nombre_moneda},t)}))}),Object(w.jsx)(In.a,{children:" "})]})})]})}),Object(w.jsxs)(Ye.a,{children:[Object(w.jsx)(ae.a,{variant:"outlined",onClick:function(){return""===r.nombre_caja?(l(Object(Te.a)(Object(Te.a)({},s),{},{nuevo:!0,nuevoMensaje:"Ingrese el nombre de caja"})),!1):""===r.id_user_caja?(l(Object(Te.a)(Object(Te.a)({},s),{},{nuevo:!0,nuevoMensaje:"Seleccione un usuario"})),!1):""===r.id_moneda_caja?(l(Object(Te.a)(Object(Te.a)({},s),{},{nuevo:!0,nuevoMensaje:"Seleccione una moneda"})),!1):parseFloat(r.monto_inicial)<0?(l(Object(Te.a)(Object(Te.a)({},s),{},{nuevo:!0,nuevoMensaje:"El monto inicial no puede ser negativo"})),!1):(l(Object(Te.a)(Object(Te.a)({},s),{},{nuevo:!1,nuevoMensaje:""})),void d())},children:"Agregar"}),Object(w.jsx)(ae.a,{variant:"outlined",onClick:b,children:"Cerrar"})]})]})},An=function(){var e=wn(),t=e.dialogs,a=e.setDialogs,r=e.setFormEdit,n=e.formEdit,o=e.errors,c=e.setErrors,i=e.editarCaja,s=e.cargas,l=function(){a(Object(Te.a)(Object(Te.a)({},t),{},{editar:!1})),c(Object(Te.a)(Object(Te.a)({},o),{},{editar:!1,editarMensaje:""}))};return Object(w.jsxs)(ze.a,{fullWidth:!0,open:t.editar,onClose:l,children:[Object(w.jsx)(qe.a,{children:"Editar nombre"}),Object(w.jsx)(Ue.a,{dividers:!0,children:Object(w.jsxs)(Z.a,{container:!0,spacing:2,children:[Object(w.jsxs)(Z.a,{item:!0,xs:12,children:[o.editar&&Object(w.jsx)(de.a,{icon:!1,severity:"error",children:o.editarMensaje}),s.editar&&Object(w.jsx)(Be.a,{})]}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(Fe.a,{autoFocus:!0,fullWidth:!0,disabled:s.editar,name:"nombre_caja",value:n.nombre_caja,onChange:function(e){var t=e.target,a=t.value,o=t.name;r(Object(Te.a)(Object(Te.a)({},n),{},Object(G.a)({},o,a)))},label:"Nombre de caja"})})]})}),Object(w.jsxs)(Ye.a,{children:[Object(w.jsx)(ae.a,{variant:"outlined",disabled:s.editar,onClick:function(){if(""===n.nombre_caja)return c(Object(Te.a)(Object(Te.a)({},o),{},{editar:!0,editarMensaje:"Complete el nombre por favor"})),!1;i(),c(Object(Te.a)(Object(Te.a)({},o),{},{editar:!1,editarMensaje:""}))},children:"Editar"}),Object(w.jsx)(ae.a,{variant:"outlined",onClick:l,children:"Cancelar"})]})]})},Dn=function(){var e=wn(),t=e.setDialogs,a=e.dialogs,r=e.lista,n=e.formTransferencia,o=e.setFormTransferencia,c=e.initialTransferencia,i=e.errors,s=e.setErrors,l=e.cargas,d=e.Funciones,u=e.transferir,j=function(e){var t=e.target,a=t.value,r=t.name;o(Object(Te.a)(Object(Te.a)({},n),{},Object(G.a)({},r,a)))},b=r.filter((function(e){return e.id_caja!==n.id_caja})),p=function(){t(Object(Te.a)(Object(Te.a)({},a),{},{transferencia:!1})),s(Object(Te.a)(Object(Te.a)({},i),{},{transferencia:!1,transferenciaMensaje:""})),o(c)};return Object(w.jsxs)(ze.a,{open:a.transferencia,onClose:p,fullWidth:!0,children:[Object(w.jsx)(qe.a,{children:"Transferencia de caja en caja"}),Object(w.jsx)(Ue.a,{dividers:!0,children:Object(w.jsxs)(Z.a,{container:!0,spacing:2,children:[Object(w.jsxs)(Z.a,{item:!0,xs:12,children:[i.transferencia&&Object(w.jsx)(de.a,{icon:!1,severity:"error",children:i.transferenciaMensaje}),l.transferencia&&Object(w.jsx)(Be.a,{})]}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsxs)(de.a,{icon:!1,children:["Caja: ",n.nombre_caja," - Monto: ",d.numberSeparator(isNaN(n.monto_caja)?0:n.monto_caja)," ",n.abreviatura_moneda]})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsxs)(Ve.a,{fullWidth:!0,children:[Object(w.jsx)(He.a,{children:"Transferir a..."}),Object(w.jsx)(Ge.a,{onChange:j,name:"id_caja_transferencia",value:n.id_caja_transferencia,fullWidth:!0,children:b.map((function(e,t){return Object(w.jsx)(Je.a,{value:e.id_caja,children:e.nombre_caja},t)}))})]})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(Fe.a,{fullWidth:!0,disabled:l.transferencia,name:"monto_transferir",value:n.monto_transferir,onChange:j,label:"Monto a transferir",InputProps:{inputComponent:Va,inputProps:{min:0}}})})]})}),Object(w.jsxs)(Ye.a,{children:[Object(w.jsx)(ae.a,{variant:"outlined",disabled:l.transferencia,onClick:function(){return""===n.id_caja_transferencia?(s(Object(Te.a)(Object(Te.a)({},i),{},{transferencia:!0,transferenciaMensaje:"Indique la caja a la que desea transferir"})),!1):parseFloat(n.monto_transferir)>parseFloat(n.monto_caja)?(s(Object(Te.a)(Object(Te.a)({},i),{},{transferencia:!0,transferenciaMensaje:"En la caja no hay suficientes fondos"})),!1):(s(Object(Te.a)(Object(Te.a)({},i),{},{transferencia:!1,transferenciaMensaje:""})),void u())},children:"Transferir"}),Object(w.jsx)(ae.a,{variant:"outlined",disabled:l.transferencia,onClick:p,children:"Cerrar"})]})]})},En=function(){var e=wn(),t=e.lista,a=e.cargas,r=e.dialogs,n=e.setDialogs,o=e.setFormEdit,c=e.setFormAbrir,i=e.setFormTransferencia,s=e.formTransferencia,l=e.setDatosCajaCierre,d=e.setTotalSumaMonedasArqueo,u=Object(w.jsxs)(we.a,{spacing:2,direction:"row",children:[Object(w.jsx)(Fe.a,{InputProps:{endAdornment:Object(w.jsx)(Ie.a,{position:"end",children:Object(w.jsx)(Pe.a,{onClick:function(){},children:Object(w.jsx)(ee.a,{children:"search"})})})},onKeyPress:function(e){},onChange:function(e){},variant:"outlined",label:"Buscar"}),Object(w.jsx)(ae.a,{color:"primary",variant:"outlined",size:"large",onClick:function(){return n(Object(Te.a)(Object(Te.a)({},r),{},{nuevo:!0}))},children:"AGREGAR"})]});return Object(w.jsx)(ye,{nombretabla:"Cajas",subtitle:"Habilitaci\xf3n y apertura de cajas",icono:"point_of_sale",columnas:[{field:"id_caja",title:"ID"},{field:"nombre_caja",title:"Nombre de caja"},{field:"estado_caja",title:"Estado",items:{0:"CERRADO",1:"ABIERTO"},comparaItem:"estado_caja",styleCondicion:{0:{backgroundColor:"#dd4632",padding:"6px",borderRadius:"5px",color:"#fff"},1:{backgroundColor:"#00ce4f",padding:"6px",borderRadius:"5px",color:"#fff"}}},{field:"nombre_user",title:"asignado a"},{field:"monto_caja",title:"Monto Actual Efectivo",isNumber:!0}],filas:t,Acciones:function(e){var t=e.filaProps;return Object(w.jsxs)(we.a,{spacing:1,direction:"row",justifyContent:"center",children:[Object(w.jsx)(Ae.a,{arrow:!0,title:"Hacer transferencia",children:Object(w.jsx)(Pe.a,{onClick:function(){var e;"0"===(e=t).estado_caja?y()({text:"Una caja cerrada no puede transferir"}):(i(Object(Te.a)(Object(Te.a)({},s),{},{id_caja:e.id_caja,nombre_caja:e.nombre_caja,monto_caja:e.monto_caja,abreviatura_moneda:e.abreviatura_moneda})),n(Object(Te.a)(Object(Te.a)({},r),{},{transferencia:!0})))},children:Object(w.jsx)(ee.a,{color:"secondary",children:"flight_takeoff"})})}),Object(w.jsx)(Ae.a,{arrow:!0,title:"Editar",children:Object(w.jsx)(Pe.a,{onClick:function(){return o({nombre_caja:(e=t).nombre_caja,id_caja:e.id_caja}),void n(Object(Te.a)(Object(Te.a)({},r),{},{editar:!0}));var e},children:Object(w.jsx)(ee.a,{color:"info",children:"edit"})})}),"1"===t.estado_caja?Object(w.jsx)(Ae.a,{arrow:!0,title:"Cerrar",children:Object(w.jsx)(Pe.a,{onClick:function(){l(t),n(Object(Te.a)(Object(Te.a)({},r),{},{arqueo:!0})),d(0)},children:Object(w.jsx)(ee.a,{color:"error",children:"close"})})}):Object(w.jsx)(Ae.a,{arrow:!0,title:"Abrir",children:Object(w.jsx)(Pe.a,{onClick:function(){!function(e){var t=Object(Te.a)({},e);t.monto_inicial=e.monto_caja,c(t),n(Object(Te.a)(Object(Te.a)({},r),{},{abrir:!0}))}(t)},children:Object(w.jsx)(ee.a,{color:"primary",children:"open_in_browser"})})})]})},cargando:a.lista,search:u,showOptions:!0})},Nn=function(){var e=wn(),t=e.dialogs,a=e.setDialogs,n=e.listaRegistrosMonedas,o=e.Funciones,i=e.totalSumaMonedasArqueo,s=e.setTotalSumaMonedasArqueo,l=_t().MONEDA_PRINCIPAL,d=Object(c.useState)({}),u=Object(r.a)(d,2),j=u[0],b=u[1],p=function(e){var t=e.target,a=t.value,r=t.name,o=parseInt(a);""===a&&(o=0);var c=Object(Te.a)({},j);c[r]=o,b(c);var i=0,l=function(e){var t=n.find((function(t){return t.id_monedas_registro===e})),a=parseInt(t.valor_moneda_registro);i+=c[e]*a};for(var d in c)l(d);s(i)},m=function(){a(Object(Te.a)(Object(Te.a)({},t),{},{arqueo:!1})),b({})};return Object(w.jsx)(w.Fragment,{children:t.arqueo&&Object(w.jsxs)(ze.a,{fullWidth:!0,maxWidth:"md",open:t.arqueo,onClose:m,children:[Object(w.jsx)(qe.a,{children:"Arqueo de caja"}),Object(w.jsxs)(Ue.a,{dividers:!0,children:[Object(w.jsxs)(Z.a,{container:!0,spacing:2,children:[Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(te.a,{variant:"button",children:"COMPLETE CON CANTIDAD DE BILLETES Y MONEDAS PARA CERRAR CAJA"})}),n.map((function(e,t){return Object(w.jsx)(c.Fragment,{children:Object(w.jsx)(Z.a,{item:!0,xs:6,md:3,children:Object(w.jsx)(Fe.a,{InputProps:{inputComponent:Va,inputProps:{min:0}},helperText:e.descripcion_registro_moneda,name:e.id_monedas_registro,onChange:p})})},t)}))]}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsxs)(te.a,{variant:"h6",children:["TOTAL EN EFECTIVO:"," ",o.numberSeparator(i)," ",l.nombre_moneda," "]})})]}),Object(w.jsxs)(Ye.a,{children:[Object(w.jsx)(ae.a,{color:"primary",onClick:function(){a(Object(Te.a)(Object(Te.a)({},t),{},{arqueo:!1,arqueoFinal:!0})),b({})},variant:"outlined",children:"Confirmar cierre"}),Object(w.jsx)(ae.a,{variant:"outlined",onClick:m,children:"Cancelar"})]})]})})},Tn=function(){var e=wn(),t=e.dialogs,a=e.setDialogs,r=e.formAbrir,n=e.setFormAbrir,o=e.Funciones,i=e.aperturaCaja,s=e.errors,l=e.setErrors,d=e.cargas,u=e.dialogQuery,j=e.lista,b=e.dialogID,p=function(){a(Object(Te.a)(Object(Te.a)({},t),{},{abrir:!1}))},m=Object(c.useCallback)((function(){if("open"===u){var e=Object(Qe.a)(j),t=e.findIndex((function(e){return e.id_caja===b}));if(e[t]){var a=e[t];a.monto_inicial=a.monto_caja,n(a)}}}),[u,j,b,n]);return Object(c.useEffect)((function(){var e=new AbortController,t=!0;return t&&m(),function(){t=!1,e.abort()}}),[m]),Object(w.jsxs)(ze.a,{open:t.abrir,onClose:p,fullWidth:!0,children:[Object(w.jsx)(qe.a,{children:"Hacer apertura"}),Object(w.jsx)(Ue.a,{dividers:!0,children:d.lista?Object(w.jsx)(U.a,{}):Object(w.jsxs)(Z.a,{container:!0,spacing:2,children:[Object(w.jsxs)(Z.a,{item:!0,xs:12,children:[s.abrir&&Object(w.jsx)(de.a,{icon:!1,severity:"error",children:s.abrirMensaje}),d.abrir&&Object(w.jsx)(Be.a,{})]}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsxs)(de.a,{severity:"warning",icon:!1,children:["NOMBRE: ",Object(w.jsx)(Ar.a,{children:null===r||void 0===r?void 0:r.nombre_caja})]})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsxs)(de.a,{severity:"info",icon:!1,children:["Monto de \xfaltimo cierre valor en efectivo : ",Object(w.jsxs)(Ar.a,{children:[o.numberSeparator(null===r||void 0===r?void 0:r.monto_cierre)," ",null===r||void 0===r?void 0:r.nombre_moneda]})]})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(de.a,{severity:"info",icon:!1,children:"PRESIONE EN ABRIR PARA PROCEDER"})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(Fe.a,{fullWidth:!0,autoFocus:!0,name:"monto_inicial",value:null===r||void 0===r?void 0:r.monto_inicial,onChange:function(e){var t=e.target,a=t.value,o=t.name;n(Object(Te.a)(Object(Te.a)({},r),{},Object(G.a)({},o,a)))},label:"Monto inicial en caja",InputProps:{inputComponent:Va,inputProps:{min:0},startAdornment:Object(w.jsx)(Ie.a,{position:"start",children:null===r||void 0===r?void 0:r.abreviatura_moneda})},helperText:"Ingrese el monto actual existente en caja"})})]})}),Object(w.jsxs)(Ye.a,{children:[Object(w.jsx)(ae.a,{variant:"outlined",onClick:function(){var e=Object(Te.a)({},r);if(delete e.nombre_caja,delete e.nombre_user,delete e.nombre_moneda,delete e.abreviatura_moneda,e.ult_mov_caja=o.getFechaHorarioString(),e.estado_caja="1",e.fecha_apertura=o.getFechaHorarioString(),parseFloat(e.monto_inicial)<0)return l(Object(Te.a)(Object(Te.a)({},s),{},{abrir:!0,abrirMensaje:"El monto inicial no puede ser negativo"})),!1;l(Object(Te.a)(Object(Te.a)({},s),{},{abrir:!1,abrirMensaje:""})),i(e)},children:"Abrir caja"}),Object(w.jsx)(ae.a,{variant:"outlined",onClick:p,children:"Cerrar"})]})]})},Rn=function(e){var t=e.datos,a=e.cargando,r="Gs.",n=wn().totalSumaMonedasArqueo,o=t.saldoFinal-n>0?t.saldoFinal-n:0,i=n-t.saldoFinal>0?n-t.saldoFinal:0;return Object(w.jsxs)(Z.a,{container:!0,spacing:2,children:[Object(w.jsx)(Z.a,{item:!0,xs:12,children:a&&Object(w.jsx)(Be.a,{})}),Object(w.jsx)(Z.a,{item:!0,xs:6,children:Object(w.jsx)(de.a,{icon:!1,severity:"warning",children:Object(w.jsxs)(te.a,{variant:"button",children:["Monto inicial : ",Et.numberSeparator(t.montoInicial)," ",r]})})}),Object(w.jsx)(Z.a,{item:!0,xs:6,children:Object(w.jsx)(de.a,{icon:!1,severity:"warning",children:Object(w.jsxs)(te.a,{variant:"button",children:["FECHA DE APERTURA: ",t.fechaApertura," "]})})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:6,children:Object(w.jsxs)(de.a,{icon:!1,severity:"info",children:[Object(w.jsx)(te.a,{variant:"button",children:"Nombre caja: "})," ",Object(w.jsxs)(te.a,{variant:"overline",children:[" ",t.nombreCaja," "]})]})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:6,children:Object(w.jsxs)(de.a,{icon:!1,severity:"info",children:[Object(w.jsx)(te.a,{variant:"button",children:"Responsable: "})," ",t.nombre_user]})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(de.a,{severity:"info",icon:!1,children:Object(w.jsxs)(te.a,{variant:"h5",children:["VENTAS SIN EFECTIVO: ",Et.numberSeparator(t.montoSinEfectivo)," ",r]})})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:6,children:Object(w.jsxs)(Z.a,{container:!0,spacing:1,children:[Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(de.a,{icon:!1,children:Object(w.jsx)(te.a,{variant:"button",children:"INGRESOS "})})}),Object(w.jsx)(Z.a,{item:!0,xs:6,children:Object(w.jsx)(te.a,{variant:"overline",children:"Ventas totales:"})}),Object(w.jsx)(Z.a,{item:!0,xs:6,children:Object(w.jsxs)(te.a,{variant:"overline",children:[Et.numberSeparator(t.ventasContado)," ",r]})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(Z.a,{container:!0,spacing:1,children:t.ventasDescripcion.map((function(e){return Object(w.jsxs)(c.Fragment,{children:[Object(w.jsxs)(Z.a,{item:!0,xs:6,children:[Object(w.jsx)(te.a,{variant:"overline",children:e.descripcion})," "]}),Object(w.jsx)(Z.a,{item:!0,xs:6,children:Object(w.jsxs)(te.a,{variant:"overline",children:[Et.numberSeparator(e.monto)," ",r]})})]},e.id)}))})}),Object(w.jsx)(Z.a,{item:!0,xs:6,children:Object(w.jsx)(te.a,{variant:"overline",children:"Dep\xf3sitos en caja:"})}),Object(w.jsx)(Z.a,{item:!0,xs:6,children:Object(w.jsxs)(te.a,{variant:"overline",children:[Et.numberSeparator(t.depositos)," ",r]})}),Object(w.jsx)(Z.a,{item:!0,xs:6,children:Object(w.jsx)(te.a,{variant:"overline",children:"Cobros de cr\xe9ditos:"})}),Object(w.jsx)(Z.a,{item:!0,xs:6,children:Object(w.jsxs)(te.a,{variant:"overline",children:[Et.numberSeparator(t.cobrosVentasCredito)," ",r]})}),Object(w.jsx)(Z.a,{item:!0,xs:6,children:Object(w.jsx)(te.a,{variant:"overline",children:"Otros ingresos:"})}),Object(w.jsx)(Z.a,{item:!0,xs:6,children:Object(w.jsxs)(te.a,{variant:"overline",children:[Et.numberSeparator(t.otrosIngresos)," ",r]})})]})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:6,children:Object(w.jsxs)(Z.a,{container:!0,spacing:1,children:[Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(de.a,{severity:"error",icon:!1,children:Object(w.jsx)(te.a,{variant:"button",children:"EGRESOS "})})}),Object(w.jsx)(Z.a,{item:!0,xs:6,children:Object(w.jsx)(te.a,{variant:"overline",children:"Compras contado:"})}),Object(w.jsx)(Z.a,{item:!0,xs:6,children:Object(w.jsxs)(te.a,{variant:"overline",children:[Et.numberSeparator(t.comprasContado)," ",r]})}),Object(w.jsx)(Z.a,{item:!0,xs:6,children:Object(w.jsx)(te.a,{variant:"overline",children:"Retiros de caja:"})}),Object(w.jsx)(Z.a,{item:!0,xs:6,children:Object(w.jsxs)(te.a,{variant:"overline",children:[Et.numberSeparator(t.retiros)," ",r]})}),Object(w.jsx)(Z.a,{item:!0,xs:6,children:Object(w.jsx)(te.a,{variant:"overline",children:"Pagos de cr\xe9ditos:"})}),Object(w.jsx)(Z.a,{item:!0,xs:6,children:Object(w.jsxs)(te.a,{variant:"overline",children:[Et.numberSeparator(t.pagoComprasCredito)," ",r]})}),Object(w.jsx)(Z.a,{item:!0,xs:6,children:Object(w.jsx)(te.a,{variant:"overline",children:"Descuentos:"})}),Object(w.jsx)(Z.a,{item:!0,xs:6,children:Object(w.jsxs)(te.a,{variant:"overline",children:[Et.numberSeparator(t.descuentos)," ",r]})}),Object(w.jsx)(Z.a,{item:!0,xs:6,children:Object(w.jsx)(te.a,{variant:"overline",children:"Otros egresos:"})}),Object(w.jsx)(Z.a,{item:!0,xs:6,children:Object(w.jsxs)(te.a,{variant:"overline",children:[Et.numberSeparator(t.otrosPagos)," ",r]})})]})}),Object(w.jsx)(Z.a,{item:!0,xs:6,children:0!==o&&Object(w.jsx)(de.a,{severity:"error",variant:"outlined",icon:!1,children:Object(w.jsxs)(te.a,{variant:"button",children:["FALTANTE: ",Et.numberSeparator(o)," ",r]})})}),Object(w.jsx)(Z.a,{item:!0,xs:6,children:0!==i&&Object(w.jsx)(de.a,{severity:"info",variant:"outlined",icon:!1,children:Object(w.jsxs)(te.a,{variant:"button",children:["SOBRANTE: ",Et.numberSeparator(i)," ",r]})})}),(i>0||o>0)&&Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(Fe.a,{variant:"outlined",fullWidth:!0,label:"Declarar sobrante o faltante"})}),Object(w.jsx)(Z.a,{item:!0,xs:12,md:6,children:Object(w.jsx)(de.a,{severity:"success",variant:"outlined",icon:!1,children:Object(w.jsxs)(te.a,{variant:"h6",children:["SALDO FINAL: ",Et.numberSeparator(t.saldoFinal)," ",r]})})}),Object(w.jsx)(Z.a,{item:!0,xs:12,md:6,children:Object(w.jsx)(de.a,{severity:"warning",variant:"outlined",icon:!1,children:Object(w.jsxs)(te.a,{variant:"h6",children:["ARQUEO DE CAJA: ",Et.numberSeparator(n)," ",r]})})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:0===i&&0===o&&Object(w.jsx)(de.a,{severity:"success",children:"Arqueo correcto"})})]})},Mn=function(){var e=wn(),t=e.dialogs,a=e.setDialogs,n=e.setTotalSumaMonedasArqueo,o=e.datosCajaCierre,i=e.totalSumaMonedasArqueo,s=e.Funciones,u=e.getLista,j=I(),b=j.token_user,p=j.id_user,m=Object(c.useState)(!0),O=Object(r.a)(m,2),x=O[0],h=O[1],f=Object(c.useState)({montoInicial:0,saldoFinal:0,ventasContado:0,cobrosVentasCredito:0,depositos:0,retiros:0,comprasContado:0,pagoComprasCredito:0,otrosIngresos:0,otrosPagos:0,fechaApertura:"",montoSinEfectivo:0,montoEfectivo:0,nombreCaja:"",ventasDescripcion:[]}),g=Object(r.a)(f,2),_=g[0],v=g[1],C=Object(c.useCallback)(Object(d.a)(l.a.mark((function e(){var a,r,n,c,i,s,d,u,j,b,p,m,O,x,f,g,_,C,S,y,w,F,I,P,A,D,E,N,T,R,M;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.arqueoFinal){e.next=12;break}return h(!0),a=o.id_caja,r=o.fecha_apertura,e.next=6,Promise.all([k.get({table:"cajas_movimientos",include:"cajas_registros,cajas",on:"id_tipo_registro,id_cajas_registro,id_caja,id_caja_movimiento",where:"id_caja_movimiento,=,".concat(a,",and,fecha_movimiento,>=,'").concat(r,"'")}),k.get({table:"cajas_users",include:"users",on:"id_user_caja,id_user",where:"id_caja_caja,=,".concat(a),fields:"nombre_user"}),k.get({table:"facturas",include:"facturas_formas_pagos",on:"id_facturas_formas_pago,id_forma_pago_factura",where:"id_caja_factura,=,".concat(a,",and,fecha_factura,>=,'").concat(r,"',and,tipo_factura,<>,2")})]);case 6:n=e.sent,c=n[0],i=n[1],s=n[2],"ok"===c.response&&(d=c.results[0].nombre_caja,u=parseFloat(o.monto_inicial),j=r,b=0,p=0,m=0,O=0,x=0,f=0,g=0,_=0,C=0,S=0,y=0,w=[],F=-1,P=0,s.found>0&&s.results.forEach((function(e){I=e.id_forma_pago_factura,P=parseFloat(e.monto_total_factura),-1===(F=w.findIndex((function(e){return e.id===I})))?w.push({id:I,descripcion:e.descripcion_forma_pago,monto:P}):w[F].monto+=P})),c.found>0&&(A=c.results,T=[8,10,11,12,13,15],A.forEach((function(e){D=parseInt(e.tipo_registro),E=parseInt(e.id_tipo_registro),N=parseFloat(e.monto_movimiento),O=1===D?O+N:0===D?O-N:0,x+=parseFloat(e.monto_sin_efectivo),p+=1===E?N:0,g+=2===E?N:0,b+=4===E?N:0,f+=5===E?N:0,_+=6===E?N:0,C+=7===E?N:0,m+=17===E?N:0,S+=T.some((function(e){return e===E}))&&0===D?N:0,y+=E>9&&1===D?N:0}))),(R=O+u-x)<0&&(R=0),M={montoInicial:u,saldoFinal:R,montoSinEfectivo:x,depositos:b,descuentos:m,ventasContado:p,cobrosVentasCredito:g,retiros:f,comprasContado:_,pagoComprasCredito:C,otrosPagos:S,otrosIngresos:y,fechaApertura:j,nombreCaja:d,nombre_user:i.results[0].nombre_user,ventasDescripcion:w},v(M)),h(!1);case 12:case"end":return e.stop()}}),e)}))),[o,t]),S=function(){var e=Object(d.a)(l.a.mark((function e(){var t,a,r,n,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h(!0),t={fecha_cierre:s.getFechaHorarioString(),estado_caja:"0",monto_cierre:_.saldoFinal},a={id_caja_movimiento:o.id_caja,id_user_movimiento:p,id_tipo_registro:"9",monto_movimiento:_.saldoFinal,fecha_movimiento:s.getFechaHorarioString(),monto_sin_efectivo:_.montoSinEfectivo,detalles_movimiento:"Cierre de caja fecha "+s.getFechaHorarioString()},r={id_caja_arqueo:o.id_caja,monto_arqueo:_.saldoFinal,id_user_arqueo:p,tipo_arqueo:"0",fecha_arqueo:s.getFechaHorarioString()},e.next=6,Promise.all([k.update({table:"cajas",data:t,token:b,id:o.id_caja}),k.insert({table:"cajas_movimientos",token:b,data:a}),k.insert({table:"cajas_arqueos",token:b,data:r})]);case 6:n=e.sent,c=n[0],"ok"===n[1].response&&"ok"===c.response?(u(),A()):console.log(n),h(!1),localStorage.removeItem("facturasStorage");case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(c.useEffect)((function(){var e=new AbortController,t=!0;return t&&C(),function(){t=!1,e.abort()}}),[C]);var F=_.saldoFinal-i>0?_.saldoFinal-i:0,P=i-_.saldoFinal>0?i-_.saldoFinal:0,A=function(){a(Object(Te.a)(Object(Te.a)({},t),{},{arqueoFinal:!1})),n(0)};return Object(w.jsxs)(ze.a,{fullScreen:!0,open:t.arqueoFinal,onClose:A,children:[Object(w.jsx)(qe.a,{children:"Cierre de caja - Resumen"}),Object(w.jsx)(Ue.a,{dividers:!0,children:Object(w.jsx)(Rn,{arqueo:i,datos:_,cargando:x})}),Object(w.jsxs)(Ye.a,{children:[Object(w.jsx)(ae.a,{variant:"outlined",size:"large",disabled:x,onClick:function(){a(Object(Te.a)(Object(Te.a)({},t),{},{arqueoFinal:!1,arqueo:!0})),n(0)},children:"Volver a arqueo"}),Object(w.jsx)(ae.a,{variant:"outlined",size:"large",disabled:x||0!==F||0!==P,onClick:function(){y()({text:"Desea cerrar la caja ".concat(o.nombre_caja,"?"),buttons:["Cancelar","Cerrar caja"]}).then((function(e){e&&S()}))},color:"primary",children:"Confirmar cierre"}),Object(w.jsx)(ae.a,{variant:"outlined",size:"large",onClick:A,children:"Cancelar"})]})]})},Ln=function(){return Object(w.jsxs)(Fn,{children:[Object(w.jsx)(En,{}),Object(w.jsx)(Pn,{}),Object(w.jsx)(Tn,{}),Object(w.jsx)(An,{}),Object(w.jsx)(Nn,{}),Object(w.jsx)(Mn,{}),Object(w.jsx)(Dn,{})]})},Wn=Object(c.createContext)(),zn=function(){var e=Object(c.useContext)(Wn),t=e.cargando,a=e.setCargando,r=e.desdeFecha,n=e.setDesdeFecha,o=e.hastaFecha,i=e.setHastaFecha,s=e.dialog,l=e.setDialog,d=e.fecha,u=e.setLista,j=e.lista,b=e.listaCajas,p=e.setListaCajas,m=e.idCaja,O=e.setIdCaja;return{cargando:t,setCargando:a,desdeFecha:r,setDesdeFecha:n,hastaFecha:o,setHastaFecha:i,dialog:s,setDialog:l,fecha:d,setLista:u,lista:j,listaCajas:b,setListaCajas:p,idCaja:m,setTipoRegistro:e.setTipoRegistro,setIdCaja:O,getData:e.getData,movimientos:e.movimientos,form:e.form,setForm:e.setForm,initialForm:e.initialForm}},qn=function(e){var t=e.children,a=Object(c.useState)(!0),n=Object(r.a)(a,2),o=n[0],i=n[1],s=ue.fechaActualYMD(),u={nombre_caja:"",id_cajas_movimiento:"",nombre_user:"",tipo_registro:"",fecha_movimiento:"",monto_movimiento:"",monto_sin_efectivo:"",descripcion_registro:"",detalles_movimiento:""},j=Object(c.useState)(u),b=Object(r.a)(j,2),p=b[0],m=b[1],O=Object(c.useState)(s),x=Object(r.a)(O,2),h=x[0],f=x[1],g=Object(c.useState)(s),_=Object(r.a)(g,2),v=_[0],C=_[1],S=Object(c.useState)({registrar:!1,detalles:!1}),y=Object(r.a)(S,2),F=y[0],I=y[1],P=Object(c.useState)([]),A=Object(r.a)(P,2),D=A[0],E=A[1],N=Object(c.useState)([]),T=Object(r.a)(N,2),R=T[0],M=T[1],L=Object(c.useState)(""),W=Object(r.a)(L,2),z=W[0],q=W[1],U=Object(c.useState)(""),B=Object(r.a)(U,2),V=B[0],H=B[1],G=Object(c.useState)({ingresoEfectivo:0,ingresoSinEfectivo:0,ingresoTotal:0,egresos:0}),J=Object(r.a)(G,2),Y=J[0],K=J[1],X=Object(c.useCallback)(Object(d.a)(l.a.mark((function e(){var t,a,r,n,o,c,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i(!0),t=""!==z?",and,id_caja,=,".concat(z):"",a=""!==V?",and,tipo_registro,=,".concat(V):"",e.next=5,k.get({table:"cajas_movimientos",include:"cajas,cajas_registros,users",on:"id_caja,id_caja_movimiento,id_cajas_registro,id_tipo_registro,id_user,id_user_movimiento",fields:"nombre_caja,id_cajas_movimiento,nombre_user,tipo_registro,fecha_movimiento,monto_movimiento,monto_sin_efectivo,descripcion_registro,detalles_movimiento",where:"fecha_movimiento,between,'".concat(h," 00:00:00',and,'").concat(v," 23:59:59'").concat(t," ").concat(a),sort:"-fecha_movimiento"});case 5:"ok"===(r=e.sent).response?(E(r.results),n=0,o=0,c=0,s=0,r.results.forEach((function(e){"1"===e.tipo_registro?(c+=parseFloat(e.monto_sin_efectivo),n+=parseFloat(e.monto_movimiento),s+=parseFloat(e.monto_movimiento)+parseFloat(e.monto_sin_efectivo)):"0"===e.tipo_registro&&(o+=parseFloat(e.monto_movimiento))})),K({ingresoEfectivo:n,ingresoSinEfectivo:c,ingresoTotal:s,egresos:o})):console.log(r),i(!1);case 8:case"end":return e.stop()}}),e)}))),[z,h,v,V]),Q=Object(c.useCallback)(Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.get({table:"cajas",fields:"id_caja,nombre_caja"});case 2:"ok"===(t=e.sent).response?M(t.results):console.log(t);case 4:case"end":return e.stop()}}),e)}))),[]);return Object(c.useEffect)((function(){var e=new AbortController,t=!0;return t&&(X(),Q()),function(){t=!1,e.abort()}}),[X,Q]),Object(w.jsx)(Wn.Provider,{value:{cargando:o,setCargando:i,desdeFecha:h,setDesdeFecha:f,hastaFecha:v,setHastaFecha:C,dialog:F,setDialog:I,fecha:s,setLista:E,lista:D,listaCajas:R,setListaCajas:M,idCaja:z,setIdCaja:q,setTipoRegistro:H,getData:X,movimientos:Y,form:p,setForm:m,initialForm:u},children:t})},Un=function(){var e=zn(),t=e.dialog,a=e.setDialog,r=e.form,n=function(){a(Object(Te.a)(Object(Te.a)({},t),{},{detalles:!1}))};return Object(w.jsxs)(ze.a,{fullWidth:!0,open:t.detalles,onClose:n,children:[Object(w.jsx)(qe.a,{children:"Detalles de movimiento"}),Object(w.jsx)(Ue.a,{children:Object(w.jsxs)(Z.a,{container:!0,children:[Object(w.jsxs)(Z.a,{item:!0,xs:12,children:[Object(w.jsxs)("h3",{children:["Caja: ",r.nombre_caja]}),Object(w.jsxs)("h3",{children:["Usuario: ",r.nombre_user]}),Object(w.jsxs)("h4",{children:["Detalles: ",r.detalles_movimiento]}),Object(w.jsxs)("h4",{children:["Cantidad en efectivo: ",Et.numberFormat(r.monto_movimiento)]}),Object(w.jsxs)("h4",{children:["Cantidad sin efectivo: ",Et.numberFormat(r.monto_sin_efectivo)]})]}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(de.a,{icon:!1,severity:"1"===r.tipo_registro?"success":"warning",children:r.descripcion_registro})})]})}),Object(w.jsx)(Ye.a,{children:Object(w.jsx)(ae.a,{variant:"outlined",onClick:n,children:"Cerrar"})})]})},Bn=function(){var e=zn(),t=e.setDesdeFecha,a=e.setHastaFecha,n=e.setDialog,o=e.dialog,i=e.setForm,s=e.lista,l=e.fecha,d=e.setIdCaja,u=e.listaCajas,j=e.cargando,b=e.movimientos,p=e.setTipoRegistro,m=Object(c.useState)(l),O=Object(r.a)(m,2),x=O[0],h=O[1],f=Object(c.useState)(l),g=Object(r.a)(f,2),_=g[0],v=g[1],C=Object(c.useState)(""),k=Object(r.a)(C,2),S=k[0],y=k[1],F=Object(c.useState)(""),I=Object(r.a)(F,2),P=I[0],A=I[1],D=[{field:"id_cajas_movimiento",title:"#"},{field:"nombre_caja",title:"Caja"},{field:"nombre_user",title:"Responsable"},{field:"tipo_registro",title:"Tipo",items:{0:"Egreso",1:"Ingreso",2:"Apertura",3:"Cierre",4:"Informe"},comparaItem:"tipo_registro",styleCondicion:{0:{backgroundColor:"#dd4632",padding:"6px",borderRadius:"5px",color:"#fff"},1:{backgroundColor:"#00ce4f",padding:"6px",borderRadius:"5px",color:"#fff"},2:{backgroundColor:"#1976d2",padding:"6px",borderRadius:"5px",color:"#fff"},3:{backgroundColor:"#a2a2ce",padding:"6px",borderRadius:"5px",color:"#000"}}},{field:"fecha_movimiento",title:"Fecha de movimiento"},{field:"monto_movimiento",title:"Monto",isNumber:!0},{field:"monto_sin_efectivo",title:"Sin efectivo",isNumber:!0}],E=Object(w.jsxs)(Z.a,{container:!0,spacing:2,alignItems:"center",children:[Object(w.jsx)(Z.a,{item:!0,xs:12,sm:6,md:2,children:Object(w.jsx)(Fe.a,{fullWidth:!0,label:"Desde",variant:"outlined",type:"date",defaultValue:x,onChange:function(e){return h(e.target.value)},name:"desdeFecha"})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:6,md:2,children:Object(w.jsx)(Fe.a,{fullWidth:!0,label:"Hasta",variant:"outlined",type:"date",defaultValue:_,onChange:function(e){return v(e.target.value)},name:"hastaFecha"})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:6,md:3,children:Object(w.jsxs)(Ve.a,{fullWidth:!0,children:[Object(w.jsx)(He.a,{children:"Seleccione caja"}),Object(w.jsxs)(Ge.a,{name:"id_caja",onChange:function(e){y(e.target.value)},value:S,children:[Object(w.jsx)(Je.a,{value:"",children:"Todos"}),u.map((function(e,t){return Object(w.jsx)(Je.a,{value:e.id_caja,children:e.nombre_caja},t)}))]})]})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:6,md:3,children:Object(w.jsxs)(Ve.a,{fullWidth:!0,children:[Object(w.jsx)(He.a,{children:"Seleccione movimiento"}),Object(w.jsxs)(Ge.a,{name:"id_tipo_registro",onChange:function(e){A(e.target.value)},value:P,children:[Object(w.jsx)(Je.a,{value:"",children:"Todos"}),Object(w.jsx)(Je.a,{value:"2",children:"Apertura"}),Object(w.jsx)(Je.a,{value:"1",children:"Ingreso"}),Object(w.jsx)(Je.a,{value:"0",children:"Egreso"}),Object(w.jsx)(Je.a,{value:"3",children:"Cierre"})]})]})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:6,md:5,children:Object(w.jsx)(ae.a,{onClick:function(){a(_),t(x),d(S),p(P)},variant:"outlined",color:"primary",size:"large",startIcon:Object(w.jsx)(ee.a,{children:"filter_list"}),children:"Filtrar"})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(ae.a,{variant:"outlined",color:"secondary",onClick:function(){return n(Object(Te.a)(Object(Te.a)({},o),{},{registrar:!0}))},children:"Registrar movimiento"})}),Object(w.jsx)(Z.a,{item:!0,children:Object(w.jsx)(de.a,{severity:"success",variant:"outlined",icon:!1,children:Object(w.jsxs)(te.a,{variant:"h5",children:["Efectivo: ",ue.numberSeparator(b.ingresoEfectivo)," "]})})}),Object(w.jsx)(Z.a,{item:!0,children:Object(w.jsx)(de.a,{severity:"warning",variant:"outlined",icon:!1,children:Object(w.jsxs)(te.a,{variant:"h5",children:["Sin efectivo: ",ue.numberSeparator(b.ingresoSinEfectivo)," "]})})}),Object(w.jsx)(Z.a,{item:!0,children:Object(w.jsx)(de.a,{severity:"error",variant:"outlined",icon:!1,children:Object(w.jsxs)(te.a,{variant:"h5",children:["Egresos: ",ue.numberSeparator(b.egresos)," "]})})}),Object(w.jsx)(Z.a,{item:!0,children:Object(w.jsx)(de.a,{severity:"info",variant:"outlined",icon:!1,children:Object(w.jsxs)(te.a,{variant:"h5",children:["Neto: ",ue.numberSeparator(b.ingresoEfectivo-b.egresos)," "]})})})]});return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)(ye,{icono:"leaderboard",caption:"Total de movimiento: ".concat(ue.numberSeparator(b.ingresoTotal)),bgicono:"#303f9f",nombretabla:"Movimientos de caja",subtitle:"En este m\xf3dulo se pueden visualizar todos los movimientos de las cajas por fecha",search:E,namecolumnID:"id_cajas_movimiento",columnas:D,Acciones:function(e){var t=e.filaProps;return Object(w.jsx)(Ae.a,{arrow:!0,title:"Presione para ver m\xe1s detalles",children:Object(w.jsx)(ae.a,{onClick:function(){return i(t),void n(Object(Te.a)(Object(Te.a)({},o),{},{detalles:!0}))},variant:"outlined",color:"primary",children:"Ver m\xe1s"})})},filas:s,cargando:j,showOptions:!0})})},Vn=function(){var e,t=kt(),a=zn(),n=a.setDialog,o=a.dialog,i=a.fecha,s=a.getData,u=Object(c.useState)([]),j=Object(r.a)(u,2),b=j[0],p=j[1],m=Object(c.useState)([]),O=Object(r.a)(m,2),x=O[0],h=O[1],f=I(),g=f.id_user,_=f.token_user,v=Object(c.useState)(!0),C=Object(r.a)(v,2),S=C[0],F=C[1],P={id_tipo_registro:"",id_caja_movimiento:"",motivo_movimiento:""},A=Object(c.useState)(P),D=Object(r.a)(A,2),E=D[0],N=D[1],T=Object(c.useState)(0),R=Object(r.a)(T,2),M=R[0],L=R[1],W=function(e){var t=e.target,a=t.name,r=t.value;N(Object(Te.a)(Object(Te.a)({},E),{},Object(G.a)({},a,r)))},z=function(){n(Object(Te.a)(Object(Te.a)({},o),{},{registrar:!1})),N(P),L(0)},q=Object(c.useCallback)(Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!o.registrar){e.next=14;break}return e.t0=Promise,e.next=4,k.get({table:"cajas",include:"cajas_users",on:"id_caja_caja,id_caja",where:"id_user_caja,=,".concat(g,",and,estado_caja,=,1"),fields:"nombre_caja,id_caja,monto_caja"});case 4:return e.t1=e.sent,e.next=7,k.get({table:"cajas_registros",where:"show_registro,=,1"});case 7:return e.t2=e.sent,e.t3=[e.t1,e.t2],e.next=11,e.t0.all.call(e.t0,e.t3);case 11:"ok"===(t=e.sent)[0].response?h(t[0].results):console.log(t[0]),"ok"===t[1].response?p(t[1].results):console.log(t[1]);case 14:F(!1);case 15:case"end":return e.stop()}}),e)}))),[o,g]),U=x.find((function(e){return e.id_caja===E.id_caja_movimiento}));e=U?parseFloat(U.monto_caja):"0";var B=function(){var t=Object(d.a)(l.a.mark((function t(){var a,r,n,o,c,d;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(""!==E.id_tipo_registro){t.next=2;break}return t.abrupt("return",!1);case 2:if(""!==E.id_caja_movimiento){t.next=4;break}return t.abrupt("return",!1);case 4:if(F(!0),a=new Date,r="".concat(i," ").concat(a.getHours(),":").concat(a.getMinutes(),":").concat(a.getSeconds()),n=b.find((function(e){return e.id_cajas_registro===E.id_tipo_registro})),o={id_caja_movimiento:E.id_caja_movimiento,id_user_movimiento:g,id_tipo_registro:n.id_cajas_registro,monto_movimiento:M,detalles_movimiento:E.motivo_movimiento,fecha_movimiento:r},c={},"0"!==n.tipo_registro){t.next=20;break}if(!(e<M)){t.next=17;break}return console.log("MONTO ES MAYOR A LO QUE HAY"),F(!1),t.abrupt("return",!1);case 17:c={monto_caja:e-M};case 18:t.next=21;break;case 20:c={monto_caja:e+M};case 21:return t.t0=Promise,t.t1=k.update({table:"cajas",data:c,id:E.id_caja_movimiento,token:_}),t.next=25,k.insert({table:"cajas_movimientos",token:_,data:o});case 25:return t.t2=t.sent,t.t3=[t.t1,t.t2],t.next=29,t.t0.all.call(t.t0,t.t3);case 29:"ok"===(d=t.sent)[0].response&&"ok"===d[1].response?y()({text:"Movimiento de caja registrado",icon:"success",timer:1200}).then((function(){z(),s()})):console.log(d),F(!1);case 32:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return Object(c.useEffect)((function(){var e=new AbortController,t=!0;return t&&(q(),F(!1)),function(){t=!1,e.abort()}}),[q]),Object(w.jsxs)(ze.a,{fullWidth:!0,open:o.registrar,onClose:z,children:[Object(w.jsx)(qe.a,{children:Object(w.jsxs)("div",{className:t.titulodialog,children:["REGISTRAR MOVIMIENTO",Object(w.jsx)(Pe.a,{onClick:z,children:Object(w.jsx)(ee.a,{children:"close"})})]})}),Object(w.jsxs)(Ue.a,{dividers:!0,children:[S&&Object(w.jsx)(Be.a,{}),Object(w.jsxs)(Ve.a,{className:t.selects,children:[Object(w.jsx)(He.a,{className:t.labelSelect,children:"Seleccione la caja"}),Object(w.jsx)(Ge.a,{name:"id_caja_movimiento",variant:"outlined",value:E.id_caja_movimiento,onChange:W,children:x.map((function(e,t){return Object(w.jsx)(Je.a,{value:e.id_caja,children:e.nombre_caja},t)}))})]}),Object(w.jsx)(Fe.a,{className:t.textfield,fullWidth:!0,variant:"outlined",label:"Monto efectivo en caja",disabled:!0,value:"Gs. ".concat(ue.numberSeparator(e))}),Object(w.jsxs)(Ve.a,{className:t.selects,children:[Object(w.jsx)(He.a,{className:t.labelSelect,children:"Selecciona registro"}),Object(w.jsx)(Ge.a,{name:"id_tipo_registro",variant:"outlined",value:E.id_tipo_registro,onChange:W,children:b.map((function(e,t){return Object(w.jsxs)(Je.a,{value:e.id_cajas_registro,children:[e.descripcion_registro," (","1"===e.tipo_registro?"Ingreso":"Retiro",")"]},t)}))})]}),Object(w.jsx)(Fe.a,{className:t.textfield,fullWidth:!0,label:"Monto de movimiento",value:M,InputProps:{inputComponent:Va,inputProps:{min:0}},onChange:function(e){L(""===e.target.value?0:parseFloat(e.target.value))},variant:"outlined"}),Object(w.jsx)(Fe.a,{className:t.textfield,variant:"outlined",label:"Observaciones y detalles",onChange:W,name:"motivo_movimiento",fullWidth:!0,value:E.motivo_movimiento})]}),Object(w.jsxs)(Ye.a,{children:[Object(w.jsx)(ae.a,{variant:"outlined",disabled:S,onClick:B,color:"primary",children:"Registrar"}),Object(w.jsx)(ae.a,{variant:"outlined",onClick:z,children:"Cancelar"})]})]})},Hn=function(){return Object(w.jsxs)(qn,{children:[Object(w.jsx)(Bn,{}),Object(w.jsx)(Vn,{}),Object(w.jsx)(Un,{})]})},Gn=Object(c.createContext)(),Jn=function(){var e=Object(c.useContext)(Gn);return{loading:e.loading,setLoading:e.setLoading,lista:e.lista,dialogs:e.dialogs,setDialogs:e.setDialogs,form:e.form,setForm:e.setForm,initialForm:e.initialForm,getLista:e.getLista}},Yn=function(e){var t=e.children,a=Object(c.useState)(!0),n=Object(r.a)(a,2),o=n[0],i=n[1],s=Object(c.useState)({agregar:!1}),u=Object(r.a)(s,2),j=u[0],b=u[1],p={id_cajas_registro:"",descripcion_registro:"",tipo_registro:"0",show_registro:"1"},m=Object(c.useState)(p),O=Object(r.a)(m,2),x=O[0],h=O[1],f=Object(c.useState)([]),g=Object(r.a)(f,2),_=g[0],v=g[1],C=Object(c.useCallback)(Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.get({table:"cajas_registros",where:"show_registro,=,1"});case 2:"ok"===(t=e.sent).response?v(t.results):console.log(t),i(!1);case 5:case"end":return e.stop()}}),e)}))),[]);return Object(c.useEffect)((function(){var e=new AbortController,t=!0;return t&&C(),function(){t=!1,e.abort()}}),[C]),Object(w.jsx)(Gn.Provider,{value:{loading:o,setLoading:i,lista:_,dialogs:j,setDialogs:b,form:x,setForm:h,initialForm:p,getLista:C},children:t})},Kn=function(){var e=I().token_user,t=Jn(),a=t.dialogs,r=t.setDialogs,n=t.form,o=t.setForm,c=t.initialForm,i=t.getLista,s=function(){r(Object(Te.a)(Object(Te.a)({},a),{},{agregar:!1})),o(c)},u=function(){var t=Object(d.a)(l.a.mark((function t(s){var d,u;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s.preventDefault(),""!==n.id_cajas_registro){t.next=9;break}return delete n.id_cajas_registro,t.next=5,k.insert({table:"cajas_registros",data:n,token:e});case 5:"ok"===(d=t.sent).response?y()({icon:"success",timer:1500,text:"Agregado correctamente"}):console.log(d),t.next=13;break;case 9:return t.next=11,k.update({table:"cajas_registros",data:n,id:n.id_cajas_registro,token:e});case 11:"ok"===(u=t.sent).response?y()({icon:"success",timer:1500,text:"Actualizado correctamente"}):console.log(u);case 13:o(c),r(Object(Te.a)(Object(Te.a)({},a),{},{agregar:!1})),i();case 16:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),j=function(e){var t=e.target,a=t.name,r=t.value;o(Object(Te.a)(Object(Te.a)({},n),{},Object(G.a)({},a,r)))};return Object(w.jsx)(ze.a,{onClose:s,open:a.agregar,fullWidth:!0,children:Object(w.jsxs)("form",{onSubmit:u,children:[Object(w.jsx)(qe.a,{children:"Editar o Registrar"}),Object(w.jsx)(Ue.a,{dividers:!0,children:Object(w.jsxs)(Z.a,{container:!0,spacing:2,children:[Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(Fe.a,{fullWidth:!0,required:!0,label:"Descripcion",helperText:"Ej: Salario de Juan",autoFocus:!0,name:"descripcion_registro",value:n.descripcion_registro,onChange:j})}),Object(w.jsxs)(Z.a,{item:!0,xs:12,children:[Object(w.jsx)(rt.a,{component:"legend",children:"Tipo de registro"}),Object(w.jsx)(ot.a,{value:"0",control:Object(w.jsx)(ct.a,{name:"tipo_registro",checked:"0"===n.tipo_registro,onChange:j,color:"primary"}),label:"SALIDA",labelPlacement:"end"}),Object(w.jsx)(ot.a,{value:"1",control:Object(w.jsx)(ct.a,{name:"tipo_registro",checked:"1"===n.tipo_producto,onChange:j,color:"primary"}),label:"ENTRADA",labelPlacement:"end"})]})]})}),Object(w.jsxs)(Ye.a,{children:[Object(w.jsx)(ae.a,{variant:"outlined",type:"onsubmit",children:"Guardar"}),Object(w.jsx)(ae.a,{variant:"outlined",onClick:s,children:"Cancelar"})]})]})})},Xn=function(){var e=Jn(),t=e.lista,a=e.dialogs,r=e.setDialogs,n=e.loading,o=Object(w.jsx)(ae.a,{variant:"outlined",onClick:function(){return r(Object(Te.a)(Object(Te.a)({},a),{},{agregar:!0}))},children:"Agregar"});return Object(w.jsx)(ye,{search:o,nombretabla:"Registro de movimientos",icono:"list_alt",columnas:[{field:"id_cajas_registro",title:"#"},{field:"descripcion_registro",title:"Descripcion"},{field:"tipo_registro",title:"Tipo",items:{0:"SALIDA",1:"ENTRADA"},comparaItem:"tipo_registro",style:{backgroundColor:"#3f51b591",padding:"2px",borderRadius:"5px",cursor:"pointer"}}],filas:t,Acciones:function(e){e.filaProps;return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)(Pe.a,{onClick:function(){},children:Object(w.jsx)(ee.a,{children:"edit"})})})},showOptions:!1,cargando:n})},Qn=function(){return Object(w.jsxs)(Yn,{children:[Object(w.jsx)(Xn,{}),Object(w.jsx)(Kn,{})]})},Zn=function(){return Object(w.jsxs)(we.a,{direction:"column",spacing:2,justifyContent:"center",alignItems:"center",children:[Object(w.jsx)(ee.a,{color:"warning",sx:{fontSize:"8rem"},children:"warning"}),Object(w.jsx)(te.a,{variant:"body1",children:"No deber\xedas de estar aqu\xed"}),Object(w.jsxs)(we.a,{direction:"row",spacing:2,children:[Object(w.jsxs)(De.a,{variant:"extended",onClick:function(){ue.goto("")},children:[Object(w.jsx)(ee.a,{children:"home"}),"VOLVER A CASA"]}),Object(w.jsxs)(De.a,{variant:"extended",onClick:function(){ue.goto("salir")},children:[Object(w.jsx)(ee.a,{children:"logout"}),"SALIR"]})]})]})},$n=Object(c.createContext)(),eo=function(){var e=Object(c.useContext)($n);return{cargando:e.cargando,setCargando:e.setCargando,lista:e.lista,setLista:e.setLista,editar:e.editar,borrar:e.borrar,form:e.form,setForm:e.setForm,dialogs:e.dialogs,setDialogs:e.setDialogs,guardar:e.guardar}},to=function(e){var t=e.children,a=JSON.parse(localStorage.getItem("dataProductos")),n="depositos",o=I().token_user,i=Object(c.useState)(!0),s=Object(r.a)(i,2),u=s[0],j=s[1],b=Object(c.useState)([]),p=Object(r.a)(b,2),m=p[0],O=p[1],x=Object(c.useState)({editar:!1}),h=Object(r.a)(x,2),f=h[0],g=h[1],_=Object(c.useState)({id_deposito:"",nombre_deposito:""}),v=Object(r.a)(_,2),C=v[0],S=v[1],F=function(){var e=Object(d.a)(l.a.mark((function e(){var t,r,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return delete C.id_deposito,j(!0),e.next=4,k.insert({table:n,data:C,token:o});case 4:"ok"===(t=e.sent).response?(a&&(r=Object(Te.a)({},a),c={id_deposito:t.last_id,nombre_deposito:C.nombre_deposito},r.depositos.push(c),localStorage.setItem("dataProductos",JSON.stringify(r))),D(),y()({text:"Agregado correctamente",icon:"success",timer:1200})):console.log(t);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),P=function(){var e=Object(d.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:y()({text:"Desea borrar este registro?",icon:"warning",buttons:["Cancelar","Borrar"]}).then(function(){var e=Object(d.a)(l.a.mark((function e(r){var c,i,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r){e.next=5;break}return e.next=3,k.delete({table:n,id:t.id_deposito,token:o});case 3:"ok"===e.sent.response&&(y()({text:"Borrado correctamente",timer:1800,icon:"success"}),c=Object(Qe.a)(m),i=c.findIndex((function(e){return e.id_deposito===t.id_deposito})),c.splice(i,1),O(c),a&&((s=Object(Te.a)({},a)).depositos.splice(i,1),localStorage.setItem("dataProductos",JSON.stringify(s))));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),A=function(){var e=Object(d.a)(l.a.mark((function e(){var t,r,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return j(!0),e.next=3,k.update({table:n,data:C,id:C.id_deposito,token:o});case 3:"ok"===(t=e.sent).response?(y()({icon:"success",text:"Actualizado correctamente",timer:1200}),D(),a&&(r=Object(Te.a)({},a),c=r.depositos.findIndex((function(e){return e.id_deposito===C.id_deposito})),r.depositos[c].nombre_deposito=C.nombre_deposito,localStorage.setItem("dataProductos",JSON.stringify(r)))):console.log(t);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),D=Object(c.useCallback)(Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.get({table:n,where:"tipo_deposito,=,1"});case 2:"ok"===(t=e.sent).response?O(t.results):console.log(t),j(!1);case 5:case"end":return e.stop()}}),e)}))),[]);return Object(c.useEffect)((function(){var e=new AbortController,t=!0;return t&&D(),function(){t=!1,e.abort()}}),[D]),Object(w.jsx)($n.Provider,{value:{cargando:u,setCargando:j,lista:m,setLista:O,editar:A,borrar:P,form:C,setForm:S,dialogs:f,setDialogs:g,guardar:F},children:t})};function ao(e){var t=e.borrar,a=e.abrir,n=e.filaProps,o=Object(c.useRef)(null),i=Object(c.useState)(!1),s=Object(r.a)(i,2),l=s[0],d=s[1];return Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(Pe.a,{ref:o,onClick:function(){return d(!0)},children:Object(w.jsx)(ee.a,{color:"success",children:"more"})}),Object(w.jsxs)(qt.a,{open:l,anchorEl:o.current,onClose:function(){return d(!1)},PaperProps:{sx:{width:200,maxWidth:"100%"}},anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},children:[Object(w.jsxs)(Je.a,{onClick:function(){a(n)},sx:{color:"text.secondary"},children:[Object(w.jsx)(Vt.a,{children:Object(w.jsx)(ee.a,{color:"primary",children:"mode_edit"})}),Object(w.jsx)(Ht.a,{primary:"Editar",primaryTypographyProps:{variant:"body2"}})]}),Object(w.jsxs)(Je.a,{onClick:function(){t(n)},sx:{color:"text.secondary"},children:[Object(w.jsx)(Vt.a,{children:Object(w.jsx)(ee.a,{color:"secondary",children:"delete_outline"})}),Object(w.jsx)(Ht.a,{primary:"Borrar",primaryTypographyProps:{variant:"body2"}})]})]})]})}var ro=function(){var e=eo(),t=e.lista,a=e.cargando,r=e.borrar,n=e.setForm,o=e.setDialogs,c=e.dialogs,i=t.filter((function(e){return e.nombre_deposito.toLowerCase().includes("".toLowerCase())})),s=function(e){n(e),o(Object(Te.a)(Object(Te.a)({},c),{},{editar:!0}))},l=Object(w.jsx)(ae.a,{color:"primary",variant:"outlined",startIcon:Object(w.jsx)(ee.a,{children:"add"}),onClick:function(){o(Object(Te.a)(Object(Te.a)({},c),{},{editar:!0})),n({id_deposito:"",nombre_deposito:""})},children:"Agregar"});return Object(w.jsx)(ye,{nombretabla:"Dep\xf3sitos",subtitle:"Dep\xf3sitos donde se almacenan los productos.",search:l,cargando:a,icono:"local_convenience_store",columnas:[{field:"id_deposito",title:"#"},{field:"nombre_deposito",title:"Nombre Dep\xf3sito"}],filas:i,Acciones:function(e){var t=e.filaProps;return Object(w.jsx)(ao,{borrar:r,abrir:s,filaProps:t})},showOptions:!0})},no=function(){var e=eo(),t=e.setDialogs,a=e.dialogs,r=e.guardar,n=e.form,o=e.setForm,i=e.editar,s=Object(c.useRef)(null),l=function(){t(Object(Te.a)(Object(Te.a)({},a),{},{editar:!1})),o({nombre_deposito:"",id_deposito:""})};return Object(w.jsxs)(ze.a,{open:a.editar,onClose:l,TransitionComponent:Zt.a,fullWidth:!0,children:[Object(w.jsx)(qe.a,{children:""===n.id_deposito?"Agregar dep\xf3sito nuevo":"Editar dep\xf3sito"}),Object(w.jsxs)("form",{onSubmit:function(e){if(e.preventDefault(),""===n.nombre_deposito||n.nombre_deposito.length<1)return s.current.focus(),!1;""===n.id_deposito?r(n):i(n),l()},children:[Object(w.jsx)(Ue.a,{children:Object(w.jsx)(Z.a,{container:!0,spacing:2,children:Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(Fe.a,{required:!0,inputRef:s,onChange:function(e){var t=e.target,a=t.name,r=t.value;o(Object(Te.a)(Object(Te.a)({},n),{},Object(G.a)({},a,r)))},name:"nombre_deposito",variant:"outlined",autoFocus:!0,value:n.nombre_deposito,fullWidth:!0,label:"Nombre del dep\xf3sito"})})})}),Object(w.jsxs)(Ye.a,{children:[Object(w.jsx)(ae.a,{variant:"outlined",type:"submit",children:"Guardar"}),Object(w.jsx)(ae.a,{variant:"outlined",onClick:l,children:"Cancelar"})]})]})]})},oo=function(){return Object(w.jsxs)(to,{children:[Object(w.jsx)(ro,{}),Object(w.jsx)(no,{})]})},co=Object(c.createContext)(),io=function(){var e=Object(c.useContext)(co);return{lista:e.lista,setLista:e.setLista,cargando:e.cargando,setCargando:e.setCargando,dialogCotizacion:e.dialogCotizacion,setDialogCotizacion:e.setDialogCotizacion,datosMonedas:e.datosMonedas,setDatosMonedas:e.setDatosMonedas}},so=function(e){var t=e.children,a=Object(c.useState)([]),n=Object(r.a)(a,2),o=n[0],i=n[1],s=Object(c.useState)(!0),u=Object(r.a)(s,2),j=u[0],b=u[1],p=Object(c.useState)(!1),m=Object(r.a)(p,2),O=m[0],x=m[1],h=Object(c.useState)({id_moneda:"1",abreviatura_moneda:"Gs.",nombre_moneda:"Guaran\xedes",valor_moneda:"1",activo_moneda:"1"}),f=Object(r.a)(h,2),g=f[0],_=f[1],v=Object(c.useCallback)(Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.get({table:"monedas"});case 2:"ok"===(t=e.sent).response?i(t.results):console.log(t),b(!1);case 5:case"end":return e.stop()}}),e)}))),[]);return Object(c.useEffect)((function(){var e=!0,t=new AbortController;return e&&v(),function(){e=!1,t.abort()}}),[v]),Object(w.jsx)(co.Provider,{value:{lista:o,setLista:i,cargando:j,setCargando:b,dialogCotizacion:O,setDialogCotizacion:x,datosMonedas:g,setDatosMonedas:_},children:t})},lo=function(){var e=io(),t=e.lista,a=e.cargando,r=e.setDialogCotizacion,n=e.setDatosMonedas,o=Object(w.jsx)("div",{});return Object(w.jsx)(ye,{nombretabla:"Cotizaciones de monedas",subtitle:"Moneda principal: Guaran\xed",bgicono:"#3f51b5",icono:"monetization_on",columnas:[{field:"id_moneda",title:"ID"},{field:"activo_moneda",title:"Moneda principal",items:{0:"No",1:"Moneda principal"},comparaItem:"activo_moneda"},{field:"abreviatura_moneda",title:"Abre."},{field:"nombre_moneda",title:"Nombre de moneda"},{field:"valor_moneda",title:"Valor",isNumber:!0}],cargando:a,filas:t,Acciones:function(e){var t=e.filaProps;return Object(w.jsx)(ae.a,{variant:"outlined",onClick:function(){n(t),r(!0)},color:"primary",size:"small",children:"Cambiar"})},namecolumnID:"id_moneda",search:o,showOptions:!0})},uo=function(){var e=kt(),t=I().token_user,a=io(),n=a.setDialogCotizacion,o=a.dialogCotizacion,i=a.datosMonedas,s=a.lista,u=a.setLista,j=Object(c.useState)({valor_moneda:""}),b=Object(r.a)(j,2),p=b[0],m=b[1],O=Object(c.useState)(!1),x=Object(r.a)(O,2),h=x[0],f=x[1],g=function(){n(!1)},_=function(){var e=Object(d.a)(l.a.mark((function e(){var a,r,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f(!0),e.next=3,k.update({table:"monedas",id:i.id_moneda,data:p,token:t});case 3:"ok"===(a=e.sent).response?(r=s.findIndex((function(e){return e.id_moneda===i.id_moneda})),(n=Object(Qe.a)(s))[r].valor_moneda=p.valor_moneda,u(n),g()):console.log(a),f(!1);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(c.useEffect)((function(){o&&m({valor_moneda:i.valor_moneda})}),[o,i]),Object(w.jsxs)(ze.a,{open:o,onClose:g,fullWidth:!0,children:[Object(w.jsx)(qe.a,{children:Object(w.jsxs)("div",{className:e.titulodialog,children:[Object(w.jsx)("div",{children:"Cambiar cotizaci\xf3n"}),Object(w.jsx)(Pe.a,{onClick:function(){return g()},children:Object(w.jsx)(ee.a,{children:"close"})})]})}),Object(w.jsxs)(Ue.a,{dividers:!0,children:[h&&Object(w.jsx)(Be.a,{}),Object(w.jsx)(cn.a,{children:"Con respecto a la moneda principal"}),Object(w.jsx)(Fe.a,{variant:"outlined",onChange:function(e){var t=e.target,a=t.name,r=t.value;m(Object(Te.a)(Object(Te.a)({},p),{},Object(G.a)({},a,r)))},name:"valor_moneda",InputProps:{inputComponent:Va},value:p.valor_moneda,label:"Cotizaci\xf3n"})]}),Object(w.jsxs)(Ye.a,{children:[Object(w.jsx)(ae.a,{variant:"outlined",color:"primary",onClick:_,disabled:h,children:"Confirmar"}),Object(w.jsx)(ae.a,{variant:"outlined",onClick:g,children:"Cerrar"})]})]})},jo=function(){return Object(w.jsxs)(so,{children:[Object(w.jsx)(lo,{}),Object(w.jsx)(uo,{})]})},bo=Object(c.createContext)(),po=function(){var e=Object(c.useContext)(bo);return{cargando:e.cargando,setCargando:e.setCargando,lista:e.lista,setLista:e.setLista,getFactura:e.getFactura,nroFactura:e.nroFactura,error:e.error,setError:e.setError,tipoFactura:e.tipoFactura,setTipoFactura:e.setTipoFactura,listaPendientes:e.listaPendientes,setListaPendientes:e.setListaPendientes}},mo=function(e){var t=e.children,a=Object(c.useState)(!1),n=Object(r.a)(a,2),o=n[0],i=n[1],s=Object(c.useState)([]),u=Object(r.a)(s,2),j=u[0],b=u[1],p=Object(c.useState)([]),m=Object(r.a)(p,2),O=m[0],x=m[1],h=Object(c.useRef)(null),f=Object(c.useState)({error:!1,msj:""}),g=Object(r.a)(f,2),_=g[0],v=g[1],C=Object(c.useState)("1"),S=Object(r.a)(C,2),y=S[0],F=S[1],I=Object(c.useCallback)(Object(d.a)(l.a.mark((function e(){var t,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i(!0),t=parseInt(h.current.value),isNaN(t)){e.next=7;break}return e.next=5,k.get({table:"facturas_items",include:"facturas,clientes,productos",on:"id_factura,id_items_factura,id_cliente,id_cliente_factura,id_producto,id_producto_factura",where:"nro_factura,=,".concat(t,",and,tipo_producto,=,1,and,tipo_factura,=,").concat(y,",and,entregado_item,=,0")});case 5:"ok"===(a=e.sent).response?b(a.results):console.log(a);case 7:i(!1);case 8:case"end":return e.stop()}}),e)}))),[y]),P=Object(c.useCallback)(Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.get({table:"facturas_items",include:"productos,facturas",on:"id_producto,id_producto_factura,id_factura,id_items_factura",where:"entregado_item,=,0",fields:"codigo_producto,cantidad_producto,nombre_producto,entregado_item,nro_factura"});case 2:"ok"===(t=e.sent).response?x(t.results):console.log(t);case 4:case"end":return e.stop()}}),e)}))),[]);return Object(c.useEffect)((function(){var e=new AbortController,t=!0;return t&&P(),function(){t=!1,e.abort()}}),[P]),Object(w.jsx)(bo.Provider,{value:{cargando:o,setCargando:i,lista:j,setLista:b,getFactura:I,nroFactura:h,error:_,setError:v,tipoFactura:y,setTipoFactura:F,listaPendientes:O,setListaPendientes:x},children:t})},Oo=function(){var e=Object(c.useState)(!1),t=Object(r.a)(e,2),a=t[0],n=t[1],o=Object(c.useState)(!1),i=Object(r.a)(o,2),s=i[0],u=i[1],j=po(),b=j.lista,p=j.setLista,m=j.tipoFactura,O=j.listaPendientes,x=j.setListaPendientes,h=I().token_user,f=Object(Qe.a)(b);if(b.length<1)return Object(w.jsx)(de.a,{icon:Object(w.jsx)(ee.a,{children:"mood_bad"}),children:"No hay facturas"});var g="".concat("0"===m?"RECIBO":"FACTURA",": ").concat(b[0].nro_factura,"  -  CLIENTE: ").concat(b[0].nombre_cliente,"  - DOC: ").concat(b[0].ruc_cliente),_=function(){u(!1)},v=function(){var e=Object(d.a)(l.a.mark((function e(t){var a,r,o,c,i,s,d,j;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n(!0),u(!0),a=Object(Qe.a)(b),r=Object(Qe.a)(O),o=t.id_producto,c=parseFloat(t.stock_producto)-parseFloat(t.cantidad_producto),i=a.findIndex((function(e){return e.id_producto===o})),s=t.id_facturas_item,d=r.findIndex((function(e){return e.id_producto===o})),e.next=11,Promise.all([k.update({token:h,table:"facturas_items",id:s,data:{entregado_item:"1"}}),k.update({token:h,table:"productos",data:{stock_producto:c},id:o})]);case 11:"ok"===(j=e.sent)[0].response&&"ok"===j[1].response&&(n(!1),r.splice(d,1),a.splice(i,1),p(a),x(r));case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(Ea.a,{open:s,autoHideDuration:1500,onClose:_,anchorOrigin:{horizontal:"right",vertical:"bottom"},children:Object(w.jsx)(de.a,{onClose:_,severity:"success",children:"PRODUCTO CHEQUEADO"})}),Object(w.jsx)(ye,{columnas:[{field:"codigo_producto",title:"CODIGO"},{field:"nombre_producto",title:"PRODUCTO"},{field:"entregado_item",title:"Entregado",items:{0:"No",1:"ENTREGADO"},comparaItem:"entregado_item"},{field:"cantidad_producto",title:"CANTIDAD",style:{backgroundColor:"#a7c74591",padding:"2px 5px",borderRadius:"5px",cursor:"pointer",fontWeight:"bolder"}}],filas:f,icono:"receipt",nombretabla:g,subtitle:"Verifique bien los productos para entregar, y presione el bot\xf3n de check",namecolumnID:"codigo_producto",Acciones:function(e){var t=e.filaProps;return Object(w.jsxs)(we.a,{direction:"row",spacing:2,children:[Object(w.jsx)(Fe.a,{label:"Codigo"}),a?Object(w.jsx)(U.a,{size:18}):Object(w.jsx)(Ae.a,{title:"Chequear",arrow:!0,children:Object(w.jsx)(ae.a,{color:"primary",variant:"outlined",startIcon:Object(w.jsx)(ee.a,{style:{color:pn.a[500]},children:"check_circle"}),onClick:function(){v(t)},children:"Chequear"})})]})},showOptions:!0})]})},xo=function(){var e=po(),t=e.nroFactura,a=e.getFactura,n=e.lista,o=e.cargando,i=e.tipoFactura,s=e.setTipoFactura,l=Object(c.useState)(!1),d=Object(r.a)(l,2),u=d[0],j=d[1],b=Object(c.useState)("Ingrese el n\xfamero de factura"),p=Object(r.a)(b,2),m=p[0],O=p[1],x=function(){if(""===t.current.value)return j(!0),O("Ingrese correctamente el n\xfamero de factura"),t.current.focus(),!1;j(!1),O("Ingrese el n\xfamero de factura"),a()};return Object(w.jsx)(st.a,{disableGutters:!0,children:Object(w.jsxs)(Z.a,{container:!0,spacing:2,justify:"flex-start",alignItems:"flex-start",children:[Object(w.jsx)(Z.a,{item:!0,xs:12,md:1,children:Object(w.jsx)($.a,{variant:"rounded",style:{padding:8,backgroundColor:"#3f51b5"},children:Object(w.jsx)(ee.a,{fontSize:"large",children:"delivery_dining"})})}),Object(w.jsxs)(Z.a,{item:!0,xs:12,md:11,children:[Object(w.jsx)(te.a,{variant:"button",children:"Entregas"}),Object(w.jsx)("br",{}),Object(w.jsx)(te.a,{variant:"caption",children:"En el m\xf3dulo de ENTREGAS se dan salida a los productos vendidos del stock del sistema. Ingresando el n\xfamero de factura se visualiza los productos pendientes de entregas."})]}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:3,children:Object(w.jsxs)(Ve.a,{fullWidth:!0,children:[Object(w.jsx)(He.a,{variant:"outlined",children:"Tipo"}),Object(w.jsxs)(Ge.a,{variant:"outlined",onChange:function(e){s(e.target.value)},name:"tipo_factura",value:i,children:[Object(w.jsx)(Je.a,{value:"0",children:"Recibo"}),Object(w.jsx)(Je.a,{value:"1",children:"Factura Contado"}),Object(w.jsx)(Je.a,{value:"2",children:"Factura Cr\xe9dito"})]})]})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:5,children:Object(w.jsx)(Fe.a,{onKeyPress:function(e){"Enter"===e.key&&x()},inputRef:t,label:"N\xfamero de ".concat("0"===i?"recibo":"factura"),helperText:m,autoFocus:!0,variant:"outlined",fullWidth:!0,error:u,InputProps:{endAdornment:Object(w.jsx)(Ie.a,{position:"end",children:o&&Object(w.jsx)(U.a,{size:24})})}})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:4,children:Object(w.jsx)(ae.a,{size:"large",variant:"outlined",onClick:x,color:"primary",children:"Consultar"})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(Oo,{datos:n})})]})})},ho=function(){var e=po().listaPendientes;return Object(w.jsx)(ye,{icono:"pending_actions",nombretabla:"Entregas pendientes",subtitle:"Productos con entregas pendientes que a\xfan no salieron de stock",columnas:[{field:"codigo_producto",title:"CODIGO"},{field:"cantidad_producto",title:"CANT.",style:{backgroundColor:"#8a4ea191",padding:"2px 5px",borderRadius:"5px",cursor:"pointer",fontWeight:"bold"}},{field:"nro_factura",title:"Factura/Recibo NRO"},{field:"nombre_producto",title:"DESC."}],filas:e,Acciones:function(){return Object(w.jsx)(ee.a,{color:"primary",children:"pending"})},showOptions:!0})},fo=function(){var e=Object(c.useState)(0),t=Object(r.a)(e,2),a=t[0],n=t[1],o=function(e){var t=e.children,r=e.index;return a===r&&Object(w.jsx)("div",{style:{marginTop:"25px"},children:t})};return Object(w.jsxs)(w.Fragment,{children:[Object(w.jsxs)(Na.a,{indicatorColor:"primary",textColor:"primary",value:a,onChange:function(e,t){n(t)},children:[Object(w.jsx)(Ta.a,{label:"Buscar"}),Object(w.jsx)(Ta.a,{label:"Pendientes de entrega"})]}),Object(w.jsx)(o,{value:a,index:0,children:Object(w.jsx)(xo,{})}),Object(w.jsx)(o,{value:a,index:1,children:Object(w.jsx)(ho,{})})]})},go=function(){return Object(w.jsx)(mo,{children:Object(w.jsx)(fo,{})})},_o=Object(c.createContext)(),vo=function(){var e=Object(c.useContext)(_o);return{getFacturas:e.getFacturas,listaFacturas:e.listaFacturas,openModal:e.openModal,setOpenModal:e.setOpenModal,cargando:e.cargando,setCargando:e.setCargando}},Co=function(e){var t=e.children,a=Object(c.useState)(!1),n=Object(r.a)(a,2),o=n[0],i=n[1],s=Object(c.useState)([]),u=Object(r.a)(s,2),j=u[0],b=u[1],p=Object(c.useState)(!0),m=Object(r.a)(p,2),O=m[0],x=m[1],h=Object(c.useCallback)(Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.get({table:"empresas",include:"empresa_facturas,cajas",on:"id_empresa_empresa,id_empresa,id_caja,id_caja_empresa"});case 2:"ok"===(t=e.sent).response?t.found>0&&b(t.results):console.log(t),x(!1);case 5:case"end":return e.stop()}}),e)}))),[]);return Object(c.useEffect)((function(){var e=!0,t=new AbortController;return e&&h(),function(){e=!1,t.abort()}}),[h]),Object(w.jsx)(_o.Provider,{value:{getFacturas:h,listaFacturas:j,setListaFacturas:b,openModal:o,setOpenModal:i,cargando:O,setCargando:x},children:t})},ko=function(){var e=vo(),t=e.listaFacturas,a=e.setOpenModal,r=e.cargando,n=Object(w.jsx)(ae.a,{variant:"outlined",color:"primary",onClick:function(){return a(!0)},children:"Registrar"});return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)(ye,{nombretabla:"Facturas",icono:"text_snippet",bgicono:"#303f9f",subtitle:"Facturas habilitadas por la set",columnas:[{field:"id_empresa_factura",title:"ID"},{field:"propietario_empresa",title:"Propietario"},{field:"timbrado_factura",title:"Timbrado"},{field:"inicio_timbrado",title:"Fecha Inicio"},{field:"fin_timbrado",title:"Fecha fin"},{field:"nro_datos_factura",title:"Nros de factura"},{field:"nro_inicio_factura",title:"Nro inicio factura"},{field:"nro_fin_factura",title:"Nro fin factura"},{field:"nombre_caja",title:"Caja asignada"}],cargando:r,filas:t,namecolumnID:"id_empresa_factura",Acciones:function(){return Object(w.jsx)("div",{children:Object(w.jsx)(Pe.a,{children:Object(w.jsx)(ee.a,{children:"delete"})})})},search:n,showOptions:!0})})},So=function(){var e=kt(),t=I().token_user,a=vo(),n=a.openModal,o=a.setOpenModal,i=a.getFacturas,s={id_empresa_empresa:"1",id_caja_empresa:"",timbrado_factura:"",inicio_timbrado:"",fin_timbrado:"",nro_datos_factura:"",nro_inicio_factura:"",nro_fin_factura:"",last_nro_factura:""},u=Object(c.useState)(s),j=Object(r.a)(u,2),b=j[0],p=j[1],m=Object(c.useState)([]),O=Object(r.a)(m,2),x=O[0],h=O[1],f=function(){var e=Object(d.a)(l.a.mark((function e(a){var r,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.preventDefault(),(r=Object(Te.a)({},b)).last_nro_factura=b.nro_inicio_factura,localStorage.removeItem("facturasStorage"),e.next=6,k.insert({table:"empresa_facturas",data:r,token:t});case 6:"ok"===(n=e.sent).response?(i(),y()({icon:"success",text:"Registrado correctamente",timer:1200}),localStorage.removeItem("facturasStorage"),_()):console.log(n);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),g=function(e){var t=e.target,a=t.name,r=t.value;p(Object(Te.a)(Object(Te.a)({},b),{},Object(G.a)({},a,r)))},_=function(){o(!1),p(s)},v=function(){var e=Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.get({table:"cajas",fields:"nombre_caja,id_caja"});case 2:"ok"===(t=e.sent).response?h(t.results):console.log(t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(c.useEffect)((function(){v()}),[]),Object(w.jsx)(ze.a,{open:n,fullWidth:!0,maxWidth:"md",scroll:"body",onClose:_,children:Object(w.jsxs)("form",{onSubmit:f,children:[Object(w.jsx)(qe.a,{children:"Registrar talonario"}),Object(w.jsxs)(Ue.a,{children:[Object(w.jsx)(cn.a,{children:"Recuerde que este formulario solo ser\xe1 v\xe1lido cuando la SET le genere una factura"}),Object(w.jsxs)(Z.a,{container:!0,spacing:1,children:[Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(Fe.a,{fullWidth:!0,autoFocus:!0,label:"Timbrado nro",variant:"outlined",name:"timbrado_factura",onChange:g,helperText:"El timbrado debe estar correctamente",value:b.timbrado_factura,required:!0,className:e.textfield})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:6,children:Object(w.jsx)(Fe.a,{helperText:"Fecha inicio de timbrado",variant:"outlined",name:"inicio_timbrado",onChange:g,type:"date",value:b.inicio_timbrado,required:!0,fullWidth:!0,className:e.textfield})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:6,children:Object(w.jsx)(Fe.a,{fullWidth:!0,helperText:"Fecha fin de timbrado",variant:"outlined",name:"fin_timbrado",onChange:g,type:"date",value:b.fin_timbrado,required:!0,className:e.textfield})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:4,children:Object(w.jsx)(Fe.a,{fullWidth:!0,label:"Nros iniciales de factura",variant:"outlined",name:"nro_datos_factura",onChange:g,helperText:"Ej: 001-002",value:b.nro_datos_factura,required:!0,className:e.textfield})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:4,children:Object(w.jsx)(Fe.a,{fullWidth:!0,label:"Nro de inicio de factura",variant:"outlined",name:"nro_inicio_factura",onChange:g,helperText:"Ej: 300",type:"number",value:b.nro_inicio_factura,required:!0,className:e.textfield})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:4,children:Object(w.jsx)(Fe.a,{fullWidth:!0,label:"Nro de final de factura",variant:"outlined",name:"nro_fin_factura",onChange:g,helperText:"Ej: 350",type:"number",value:b.nro_fin_factura,required:!0,className:e.textfield})}),Object(w.jsxs)(Ve.a,{className:e.SelectForm,children:[Object(w.jsx)(He.a,{children:"Asignar factura a caja"}),Object(w.jsxs)(Ge.a,{value:b.id_caja_empresa,name:"id_caja_empresa",variant:"outlined",onChange:g,required:!0,children:[x.length<1&&Object(w.jsx)(Je.a,{disabled:!0,children:"No hay cajas disponibles"}),x.map((function(e){return Object(w.jsx)(Je.a,{value:e.id_caja,children:e.nombre_caja},e.id_caja)}))]})]})]})]}),Object(w.jsxs)(Ye.a,{children:[Object(w.jsx)(ae.a,{variant:"outlined",type:"submit",color:"primary",children:"Registrar"}),Object(w.jsx)(ae.a,{variant:"outlined",onClick:_,children:"Cancelar"})]})]})})},yo=function(){return Object(w.jsxs)(Co,{children:[Object(w.jsx)(ko,{}),Object(w.jsx)(So,{})]})},wo=Object(c.createContext)(),Fo=function(){var e=Object(c.useContext)(wo);return{lista:e.lista,getLista:e.getLista,loading:e.loading,dialogs:e.dialogs,setDialogs:e.setDialogs,form:e.form,setForm:e.setForm,initialForm:e.initialForm,listaRols:e.listaRols}},Io=function(e){var t=e.children,a=Object(c.useState)(!0),n=Object(r.a)(a,2),o=n[0],i=n[1],s=Object(c.useState)([]),u=Object(r.a)(s,2),j=u[0],b=u[1],p=Object(c.useState)([]),m=Object(r.a)(p,2),O=m[0],x=m[1],h=Object(c.useState)({agregar:!1}),f=Object(r.a)(h,2),g=f[0],_=f[1],v={id_empleado:"",nombre_empleado:"",apellido_empleado:"",telefono_empleado:"",doc_empleado:"",id_rol:"0",salario_empleado:"",tipo_salario:"1"},C=Object(c.useState)(v),S=Object(r.a)(C,2),y=S[0],F=S[1],I=Object(c.useCallback)(Object(d.a)(l.a.mark((function e(){var t,a,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i(!0),t=JSON.parse(localStorage.getItem("facturasStorage")),e.next=4,Promise.all([k.get({table:"empleados"}),k.get({table:"empleados_rols"})]);case 4:"ok"===(a=e.sent)[0].response?b(a[0].results):console.log(a),"ok"===a[1].response?x(a[1].results):console.log(a),t&&((r=Object(Te.a)({},t)).listaVendedores=a[0].results,localStorage.setItem("facturasStorage",JSON.stringify(r))),i(!1);case 9:case"end":return e.stop()}}),e)}))),[]);return Object(c.useEffect)((function(){var e=new AbortController,t=!0;return t&&I(),function(){t=!1,e.abort()}}),[I]),Object(w.jsx)(wo.Provider,{value:{lista:j,getLista:I,loading:o,dialogs:g,setDialogs:_,form:y,setForm:F,initialForm:v,listaRols:O},children:t})},Po=function(){var e=I().token_user,t=Object(c.useState)(!1),a=Object(r.a)(t,2),n=a[0],o=a[1],i=Fo(),s=i.dialogs,u=i.setDialogs,j=i.getLista,b=i.form,p=i.setForm,m=i.initialForm,O=i.listaRols,x=function(){u(Object(Te.a)(Object(Te.a)({},s),{},{agregar:!1})),p(m)},h=function(){var t=Object(d.a)(l.a.mark((function t(a){var r,n;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a.preventDefault(),o(!0),""!==b.id_empleado){t.next=10;break}return delete b.id_empleado,t.next=6,k.insert({token:e,table:"empleados",data:b});case 6:"ok"===(r=t.sent).response?y()({icon:"success",timer:1500,text:"Agregado correctamente"}):console.log(r),t.next=14;break;case 10:return t.next=12,k.update({token:e,table:"empleados",id:b.id_empleado,data:b});case 12:"ok"===(n=t.sent).response?y()({icon:"success",timer:1500,text:"Actualizado correctamente"}):console.log(n);case 14:u(Object(Te.a)(Object(Te.a)({},s),{},{agregar:!1})),o(!1),j();case 17:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),f=function(e){var t=e.target,a=t.name,r=t.value;p(Object(Te.a)(Object(Te.a)({},b),{},Object(G.a)({},a,r)))};return Object(w.jsx)(ze.a,{onClose:x,open:s.agregar,fullWidth:!0,children:Object(w.jsxs)("form",{onSubmit:h,children:[Object(w.jsx)(qe.a,{children:""===b.id_empleado?"Agregar empleado":"Editar empleado"}),Object(w.jsx)(Ue.a,{dividers:!0,children:Object(w.jsxs)(Z.a,{container:!0,spacing:2,children:[Object(w.jsx)(Z.a,{item:!0,xs:12,children:n&&Object(w.jsx)(Be.a,{})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:6,children:Object(w.jsx)(Fe.a,{required:!0,label:"Nombre",onChange:f,name:"nombre_empleado",value:b.nombre_empleado,helperText:"Nombres",fullWidth:!0,autoFocus:!0})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:6,children:Object(w.jsx)(Fe.a,{required:!0,label:"Apellido",onChange:f,name:"apellido_empleado",value:b.apellido_empleado,helperText:"Apellidos",fullWidth:!0})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:6,children:Object(w.jsx)(Fe.a,{required:!0,label:"Documento",onChange:f,name:"doc_empleado",value:b.doc_empleado,helperText:"Nro de documento",fullWidth:!0})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:6,children:Object(w.jsxs)(Ve.a,{fullWidth:!0,children:[Object(w.jsx)(He.a,{variant:"outlined",children:"Rol de empleado"}),Object(w.jsxs)(Ge.a,{name:"id_rol",value:b.id_rol,onChange:f,variant:"outlined",required:!0,children:[Object(w.jsx)(Je.a,{value:"0",disabled:!0,children:"Seleccione rol"}),O.map((function(e){return Object(w.jsx)(Je.a,{value:e.id_empleados_rol,children:e.descripcion_rol},e.id_empleados_rol)}))]})]})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:6,children:Object(w.jsx)(Fe.a,{label:"Nro de contacto",onChange:f,name:"telefono_empleado",value:b.telefono_empleado,fullWidth:!0})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:6,children:Object(w.jsx)(Fe.a,{required:!0,label:"Salario",onChange:f,name:"salario_empleado",value:b.salario_empleado,fullWidth:!0,InputProps:{inputComponent:Va,inputProps:{min:0}}})}),Object(w.jsxs)(Z.a,{item:!0,xs:12,children:[Object(w.jsx)(rt.a,{component:"legend",children:"Tipo de salario"}),Object(w.jsx)(ot.a,{value:"1",control:Object(w.jsx)(ct.a,{name:"tipo_salario",checked:"1"===b.tipo_salario,onChange:f,color:"primary"}),label:"Jornales",labelPlacement:"end"}),Object(w.jsx)(ot.a,{value:"2",control:Object(w.jsx)(ct.a,{name:"tipo_salario",checked:"2"===b.tipo_salario,onChange:f,color:"primary"}),label:"Comisiones",labelPlacement:"end"})]})]})}),Object(w.jsxs)(Ye.a,{children:[Object(w.jsx)(ae.a,{variant:"outlined",type:"onsubmit",children:"Guardar"}),Object(w.jsx)(ae.a,{variant:"outlined",onClick:x,children:"Cancelar"})]})]})})},Ao=function(){var e=Fo(),t=e.lista,a=e.dialogs,r=e.setDialogs,n=e.setForm,o=e.loading,c=Object(w.jsx)(ae.a,{variant:"outlined",onClick:function(){r({agregar:!0})},children:"Registrar"});return Object(w.jsx)(ye,{search:c,nombretabla:"Empleados",subtitle:"Lista de empleados",cargando:o,icono:"badge",columnas:[{field:"id_empleado",title:"#"},{field:"apellido_empleado",title:"Apellido"},{field:"nombre_empleado",title:"Nombre"},{field:"doc_empleado",title:"Doc"}],filas:t,Acciones:function(e){var t=e.filaProps;return Object(w.jsxs)(we.a,{direction:"row",spacing:1,justifyContent:"center",children:[Object(w.jsx)(Pe.a,{onClick:function(){return n(t),void r(Object(Te.a)(Object(Te.a)({},a),{},{agregar:!0}))},children:Object(w.jsx)(ee.a,{children:"edit"})}),Object(w.jsx)(Pe.a,{onClick:function(){},children:Object(w.jsx)(ee.a,{children:"visibility"})})]})},showOptions:!0})},Do=function(){return Object(w.jsxs)(Io,{children:[Object(w.jsx)(Ao,{}),Object(w.jsx)(Po,{})]})},Eo=Object(c.createContext)(),No=function(e){var t=e.children,a=I().token_user,n=Object(c.useState)(!0),o=Object(r.a)(n,2),i=o[0],s=o[1],u=Object(c.useState)(""),j=Object(r.a)(u,2),b=j[0],p=j[1],m=Object(c.useState)([]),O=Object(r.a)(m,2),x=O[0],h=O[1],f=Object(c.useState)({activo:!1,color:"error",mensaje:"",input:""}),g=Object(r.a)(f,2),_=g[0],v=g[1],C=Object(c.useState)(""),S=Object(r.a)(C,2),F=S[0],P=S[1],A=Object(c.useState)([]),D=Object(r.a)(A,2),E=D[0],N=D[1],T={id_productos_deposito:"",id_producto:"",codigo_producto:"",nombre_producto:"",stock_producto_deposito:"",nuevoStock:!1},R=Object(c.useRef)(null),M=Object(c.useState)(T),L=Object(r.a)(M,2),W=L[0],z=L[1],q=Object(c.useCallback)(Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.get({table:"depositos",where:"tipo_deposito,=,1"});case 2:"ok"===(t=e.sent).response&&t.found>0?h(t.results):console.log(t),s(!1);case 5:case"end":return e.stop()}}),e)}))),[]);return Object(c.useEffect)((function(){var e=!0,t=new AbortController;return e&&q(),function(){e=!1,t.abort()}}),[q]),Object(w.jsx)(Eo.Provider,{value:{finalizarCorreccion:function(){var e="productos_depositos",t=a;E.forEach((function(a){a.nuevoStock?k.insert({table:e,token:t,data:{id_producto_deposito:a.id_producto,id_deposito_deposito:a.id_deposito_deposito,stock_producto_deposito:a.stock_producto_deposito}}):a.update&&k.update({table:e,token:t,data:{stock_producto_deposito:a.stock_producto_deposito},id:a.id_productos_deposito})})),z(T),y()({text:"Corregido correctamente",timer:1200})},load:i,formulario:W,setFormulario:z,initialForm:T,listaDepositos:x,cambiarDeposito:function(e){p(e),z(T)},idDeposito:b,setIdDeposito:p,listaStock:E,setListaStock:N,corregirLista:function(){var e=R.current.value,t=Object(Te.a)({},W);if(""===b)return v(Object(Te.a)(Object(Te.a)({},_),{},{activo:!0,mensaje:"Elija un dep\xf3sito",input:"deposito"})),!1;if(""===e)return v(Object(Te.a)(Object(Te.a)({},_),{},{activo:!0,mensaje:"Ingrese cantidad",input:"cantidad"})),!1;var a=Object(Qe.a)(E),r=a.findIndex((function(e){return e.id_deposito===b}));if(r>=0)a[r].stock_producto_deposito=e,a[r].update=!0;else{var n=x.findIndex((function(e){return e.id_deposito===b})),o=x[n].nombre_deposito;a.push({id_producto:t.id_producto,id_deposito_deposito:b,nombre_deposito:o,id_productos_deposito:t.id_productos_deposito,stock_producto_deposito:e,nuevoStock:!0})}N(a),p(""),P(""),R.current.focus()},inputCorregir:R,msj:_,setMsj:v,cantidadNueva:F,setCantidadNueva:P},children:t})},To=function(){var e=function(){var e=Object(c.useContext)(Eo);return{finalizarCorreccion:e.finalizarCorreccion,load:e.load,formulario:e.formulario,setFormulario:e.setFormulario,initialForm:e.initialForm,listaDepositos:e.listaDepositos,cambiarDeposito:e.cambiarDeposito,idDeposito:e.idDeposito,setIdDeposito:e.setIdDeposito,listaStock:e.listaStock,setListaStock:e.setListaStock,corregirLista:e.corregirLista,inputCorregir:e.inputCorregir,msj:e.msj,setMsj:e.setMsj,cantidadNueva:e.cantidadNueva,setCantidadNueva:e.setCantidadNueva}}(),t=e.setFormulario,a=e.formulario,n=e.initialForm,o=e.load,i=e.listaStock,s=e.setListaStock,u=e.listaDepositos,j=e.setIdDeposito,b=e.idDeposito,p=e.corregirLista,m=e.inputCorregir,O=e.setCantidadNueva,x=e.cantidadNueva,h=e.finalizarCorreccion,f=Object(c.useRef)(null),g=Object(c.useState)([]),_=Object(r.a)(g,2),v=_[0],C=_[1],S=Object(c.useState)(""),y=Object(r.a)(S,2),F=y[0],I=y[1],P=Object(c.useState)(!1),A=Object(r.a)(P,2),D=A[0],E=A[1],N=Object(c.useState)(!1),T=Object(r.a)(N,2),R=T[0],M=T[1],L=function(){var e=Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:M(!0),h(),M(!1),f.current.focus();case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),W=function(){var e=Object(d.a)(l.a.mark((function e(t){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=t.target.value,I(a),E(!0),0===a.lenght||""===a?(C([]),E(!1)):setTimeout(Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.get({table:"productos",filtersField:"nombre_producto,codigo_producto",filtersSearch:a,pagesize:"20",where:"tipo_producto,=,1"});case 2:"ok"===(t=e.sent).response?C(t.results):console.log(t),E(!1);case 5:case"end":return e.stop()}}),e)}))),500);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),z=function(){var e=Object(d.a)(l.a.mark((function e(a,r){var n,o,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return C([]),o=r.id_producto,e.next=4,k.get({table:"productos_depositos",include:"depositos",on:"id_deposito_deposito,id_deposito",where:"id_producto_deposito,=,".concat(o)});case 4:"ok"===(c=e.sent).response?(s(c.results),t(r)):console.log(c),I(""),E(!1),null===(n=m.current)||void 0===n||n.focus();case 9:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}();return o?Object(w.jsx)(Z.a,{container:!0,spacing:2,alignItems:"center",children:Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(U.a,{})})}):Object(w.jsx)(st.a,{children:Object(w.jsxs)(Z.a,{container:!0,spacing:2,children:[Object(w.jsx)(Z.a,{item:!0,xs:12,children:R&&Object(w.jsx)(Be.a,{color:"primary"})}),Object(w.jsxs)(Z.a,{item:!0,xs:12,children:[Object(w.jsx)(te.a,{variant:"h6",children:"Correcci\xf3n de inventario "}),Object(w.jsx)(te.a,{variant:"body",children:"M\xf3dulo para corregir el inventario"})]}),Object(w.jsx)(Z.a,{item:!0,sm:12,md:6,children:Object(w.jsx)(sr.a,{disabled:!!(null===a||void 0===a?void 0:a.nombre_producto),loading:D,loadingText:"Cargando...",noOptionsText:"No hay productos con ese nombre",onChange:z,fullWidth:!0,isOptionEqualToValue:function(e,t){return(null===e||void 0===e?void 0:e.id_producto)===(null===t||void 0===t?void 0:t.id_producto)},inputValue:F,options:v,getOptionLabel:function(e){return e.nombre_producto+" - "+e.codigo_producto},clearOnBlur:!0,disableClearable:!0,renderInput:function(e){return Object(w.jsx)(Fe.a,Object(Te.a)(Object(Te.a)({},e),{},{autoFocus:!0,inputRef:f,onChange:W,fullWidth:!0,placeholder:"Escriba el nombre del producto",InputProps:Object(Te.a)(Object(Te.a)({},e.InputProps),{},{endAdornment:Object(w.jsxs)(w.Fragment,{children:[D&&Object(w.jsx)(U.a,{color:"inherit",size:20}),e.InputProps.endAdornment]})})}))}})}),""!==(null===a||void 0===a?void 0:a.nombre_producto)&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(de.a,{icon:!1,severity:"info",children:Object(w.jsxs)(te.a,{variant:"button",children:["CODIGO: ",Object(w.jsx)("u",{children:null===a||void 0===a?void 0:a.codigo_producto})]})})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(de.a,{icon:!1,severity:"success",children:Object(w.jsxs)(te.a,{variant:"button",children:["Producto: ",Object(w.jsx)("u",{children:null===a||void 0===a?void 0:a.nombre_producto})]})})}),Object(w.jsx)(Z.a,{item:!0,sm:12,md:3,children:Object(w.jsx)(Fe.a,{fullWidth:!0,label:"Cantidad",name:"cantidadNueva",onChange:function(e){return O(e.target.value)},value:x,inputRef:m,InputProps:{inputComponent:Va}})}),Object(w.jsx)(Z.a,{item:!0,sm:12,md:3,children:Object(w.jsxs)(Ve.a,{fullWidth:!0,children:[Object(w.jsx)(He.a,{variant:"outlined",children:"Elegir dep\xf3sito"}),Object(w.jsxs)(Ge.a,{name:"id_deposito_producto",value:b,onChange:function(e){var t;j(e.target.value),null===(t=m.current)||void 0===t||t.focus()},children:[Object(w.jsx)(Je.a,{value:"",disabled:!0,children:"Elegir dep\xf3sito"}),u.map((function(e){return Object(w.jsx)(Je.a,{value:e.id_deposito,children:e.nombre_deposito},e.id_deposito)}))]})]})}),Object(w.jsx)(Z.a,{item:!0,sm:12,md:6,children:Object(w.jsx)(ae.a,{variant:"outlined",onClick:p,size:"large",children:"Corregir"})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(Ut.a,{children:i.map((function(e,t){return Object(w.jsxs)(Bt.a,{children:[Object(w.jsx)(Wa.a,{children:Object(w.jsx)(Pe.a,{onClick:function(){j(e.id_deposito)},children:Object(w.jsx)(ee.a,{children:"chevron_right"})})}),Object(w.jsx)(Ht.a,{secondary:"Cantidad: ".concat(e.stock_producto_deposito),primary:"".concat(e.nombre_deposito)})]},t)}))})}),Object(w.jsxs)(Z.a,{item:!0,xs:12,children:[Object(w.jsx)(ae.a,{variant:"outlined",size:"large",onClick:L,children:"Finalizar"}),"  ",Object(w.jsx)(ae.a,{variant:"outlined",size:"large",onClick:function(){t(n),j(""),C([]),f.current.focus()},children:"Cancelar"})]})]})]})})},Ro=function(){return Object(w.jsx)(No,{children:Object(w.jsx)(To,{})})},Mo=Object(c.createContext)(),Lo=function(){var e=Object(c.useContext)(Mo);return{cargando:e.cargando,setCargando:e.setCargando,lista:e.lista,setLista:e.setLista,form:e.form,setForm:e.setForm,Guardar:e.Guardar,dialog:e.dialog,setDialog:e.setDialog,Clear:e.Clear}},Wo=function(e){var t=e.children,a=I().token_user,n=Object(c.useState)(!0),o=Object(r.a)(n,2),i=o[0],s=o[1],u=Object(c.useState)([]),j=Object(r.a)(u,2),b=j[0],p=j[1],m=Object(c.useState)(!1),O=Object(r.a)(m,2),x=O[0],h=O[1],f={id_unidad_medida:"",descripcion_medida:"",simbolo_medida:""},g=Object(c.useState)(f),_=Object(r.a)(g,2),v=_[0],C=_[1],S=function(){var e=Object(d.a)(l.a.mark((function e(){var t,r,n,o,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t="unidad_medidas",r=v,n=a,""!==v.id_unidad_medida){e.next=11;break}return delete v.id_unidad_medida,e.next=7,k.insert({table:t,data:r,token:n});case 7:"ok"===(o=e.sent).response?y()({text:"Agregado correctamente",icon:"success",timer:1800}):console.log(o),e.next=15;break;case 11:return e.next=13,k.update({table:t,data:r,token:n,id:v.id_unidad_medida});case 13:"ok"===(c=e.sent).response?y()({text:"Actualizado correctamente",icon:"success",timer:1800}):console.log(c);case 15:C(f);case 16:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),F=Object(c.useCallback)(Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.get({table:"unidad_medidas"});case 2:"ok"===(t=e.sent).response?p(t.results):console.log(t),s(!1);case 5:case"end":return e.stop()}}),e)}))),[]);return Object(c.useEffect)((function(){var e=!0,t=new AbortController;return e&&F(),function(){e=!1,t.abort()}}),[F]),Object(w.jsx)(Mo.Provider,{value:{cargando:i,setCargando:s,lista:b,setLista:p,form:v,setForm:C,Guardar:S,dialog:x,setDialog:h,Clear:function(){C(f)}},children:t})},zo=function(){var e=Lo(),t=e.form,a=e.setForm,r=e.dialog,n=e.setDialog,o=e.Guardar,c=function(){n(!1)},i=function(e){var r=e.target,n=r.value,o=r.name;a(Object(Te.a)(Object(Te.a)({},t),{},Object(G.a)({},o,n)))},s=function(e){e.preventDefault(),o()};return Object(w.jsx)("form",{onSubmit:s,children:Object(w.jsxs)(ze.a,{open:r,fullWidth:!0,onClose:c,TransitionComponent:yt.a,children:[Object(w.jsx)(qe.a,{children:"Medida"}),Object(w.jsx)(Ue.a,{dividers:!0,children:Object(w.jsxs)(Z.a,{container:!0,spacing:2,children:[Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(Fe.a,{required:!0,autoFocus:!0,fullWidth:!0,variant:"outlined",label:"Descripci\xf3n de medida",name:"descripcion_medida",value:t.descripcion_medida,onChange:i})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(Fe.a,{required:!0,label:"s\xedmbolo de abreviatura",variant:"outlined",name:"simbolo_medida",value:t.simbolo_medida,onChange:i})})]})}),Object(w.jsxs)(Ye.a,{children:[Object(w.jsx)(ae.a,{variant:"outlined",onClick:s,color:"primary",children:"Guardar"}),Object(w.jsx)(ae.a,{variant:"outlined",onClick:c,color:"primary",children:"Cerrar"})]})]})})},qo=function(){var e=Lo(),t=e.lista,a=e.cargando,r=e.setDialog,n=e.setForm,o=e.Clear,c=t.filter((function(e){return e.descripcion_medida.toLowerCase().includes("".toLowerCase())})),i=Object(w.jsx)(ae.a,{variant:"outlined",color:"primary",size:"large",onClick:function(){r(!0),o()},children:"Agregar"});return Object(w.jsx)(ye,{nombretabla:"Unidades de medidas",bgicono:"#3f51b5",cargando:a,icono:"account_balance",columnas:[{field:"id_unidad_medida",title:"#"},{field:"descripcion_medida",title:"Descripci\xf3n"},{field:"simbolo_medida",title:"Simbolo"}],filas:c,Acciones:function(e){var t=e.filaProps;return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)(Pe.a,{onClick:function(){return n(t),void r(!0)},children:Object(w.jsx)(ee.a,{children:"edit"})})})},search:i,showOptions:!0})},Uo=function(){return Object(w.jsxs)(Wo,{children:[Object(w.jsx)(qo,{}),Object(w.jsx)(zo,{})]})},Bo=a(882),Vo=Object(c.createContext)(),Ho=function(){var e=Object(c.useContext)(Vo);return{cargando:e.cargando,setCargando:e.setCargando,lista:e.lista,listaMensual:e.listaMensual,setListaMensual:e.setListaMensual,setLista:e.setLista,ingresosDia:e.ingresosDia,ingresosMes:e.ingresosMes,egresosDia:e.egresosDia,egresosMes:e.egresosMes,datosEgresosDiariosMes:e.datosEgresosDiariosMes,datosIngresosDiariosMes:e.datosIngresosDiariosMes,labelDiarioMes:e.labelDiarioMes,fechaMostrar:e.fechaMostrar,setFechaMostrar:e.setFechaMostrar,mesState:e.mesState,setMesState:e.setMesState}},Go=function(e){var t=e.children,a=new Date,n=Object(c.useState)(!0),o=Object(r.a)(n,2),i=o[0],s=o[1],u=Object(c.useState)([]),j=Object(r.a)(u,2),b=j[0],p=j[1],m=Object(c.useState)([]),O=Object(r.a)(m,2),x=O[0],h=O[1],f=Object(c.useState)(a.getFullYear().toString()+"-"+(a.getMonth()+1).toString().padStart(2,0)),g=Object(r.a)(f,2),_=g[0],v=g[1],C=ue.fechaEs(),S=Object(c.useState)(C),y=Object(r.a)(S,2),F=y[0],I=y[1],P=a.getFullYear().toString()+"-"+(a.getMonth()+1).toString().padStart(2,0)+"-"+a.getDate().toString().padStart(2,0),A=_+"-"+"01".toString(),D=Object(c.useState)(0),E=Object(r.a)(D,2),N=E[0],T=E[1],R=Object(c.useState)(0),M=Object(r.a)(R,2),L=M[0],W=M[1],z=Object(c.useState)(0),q=Object(r.a)(z,2),U=q[0],B=q[1],V=Object(c.useState)(0),H=Object(r.a)(V,2),G=H[0],J=H[1],Y=Object(c.useState)([]),K=Object(r.a)(Y,2),X=K[0],Q=K[1],Z=Object(c.useState)([]),$=Object(r.a)(Z,2),ee=$[0],te=$[1],ae=Object(c.useState)([]),re=Object(r.a)(ae,2),ne=re[0],oe=re[1],ce=Object(c.useCallback)(Object(d.a)(l.a.mark((function e(){var t,a,r,n,o,c,i,d,u,j,b,m,O,x,f,g,v,C,S,y,w,F,I,D,E,N,R,M,L;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s(!0),t=new Date(_),a=t.getMonth()+2,r=t.getFullYear(),n=ue.getDaysInMonth(r,a),o=new Date(r,t.getMonth()+1,n),c=new Date(o),i=c.getFullYear().toString()+"-"+(c.getMonth()+1).toString().padStart(2,0)+"-"+c.getDate().toString().padStart(2,0),e.next=10,Promise.all([k.get({table:"cajas_movimientos",include:"cajas_registros",on:"id_tipo_registro,id_cajas_registro",fields:"*",where:"fecha_movimiento,between,'".concat(P," 00:00:00',and,'").concat(P," 23:59:59'")}),k.get({table:"cajas_movimientos",include:"cajas_registros",on:"id_tipo_registro,id_cajas_registro",fields:"*",where:"fecha_movimiento,between,'".concat(A," 00:00:00',and,'").concat(i," 23:59:59'")})]);case 10:if(d=e.sent,"ok"===(u=d[0]).response?(j=0,b=0,p(u.results),u.results.forEach((function(e){"1"===e.tipo_registro?j+=parseFloat(e.monto_movimiento):"0"===e.tipo_registro&&(b+=parseFloat(e.monto_movimiento))})),T(j),B(b)):console.log(u),"ok"===(m=d[1]).response){for(h(m.results),O=[],x=[],f=m.results,g=f.length,v=0,C="",S=!0,y=[],w=0,F=0,I=0,D=1,E=new Date(A);E<=new Date(i);E.setDate(E.getDate()+1)){for(C=E.getFullYear().toString()+"-"+(E.getMonth()+1).toString().padStart(2,0)+"-"+E.getDate().toString().padStart(2,0),y.push(D.toString().padStart(2,0)),D++,N=0,R=0;S&&g>0&&v<g;)M=f[v].fecha_movimiento.substr(0,10),L=parseInt(f[v].tipo_registro),M===C?(1===L?(R+=parseFloat(f[v].monto_movimiento),I+=parseFloat(f[v].monto_movimiento)):0===L&&(N+=parseFloat(f[v].monto_movimiento),F+=parseFloat(f[v].monto_movimiento)),v++):S=!1;O[w]=R,x[w]=-1*N,S=!0,w++}oe(y),W(I),Q(O),te(x),J(F)}else console.log(u);s(!1);case 16:case"end":return e.stop()}}),e)}))),[A,P,_]);return Object(c.useEffect)((function(){var e=!0,t=new AbortController;return e&&ce(),function(){e=!1,t.abort()}}),[ce]),Object(w.jsx)(Vo.Provider,{value:{cargando:i,setCargando:s,lista:b,setLista:p,listaMensual:x,setListaMensual:h,ingresosDia:N,ingresosMes:L,egresosDia:U,egresosMes:G,datosEgresosDiariosMes:ee,datosIngresosDiariosMes:X,labelDiarioMes:ne,fechaMostrar:F,setFechaMostrar:I,mesState:_,setMesState:v},children:t})};function Jo(){var e=Ho(),t=e.ingresosDia,a=e.ingresosMes,r=e.egresosDia,n=e.egresosMes;return Object(w.jsxs)(Z.a,{container:!0,spacing:1,children:[Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(de.a,{variant:"outlined",severity:"info",children:Object(w.jsx)(te.a,{variant:"overline"})})}),Object(w.jsx)(Z.a,{xs:12,sm:6,md:3,item:!0,children:Object(w.jsx)(Ft.a,{children:Object(w.jsxs)(Bo.a,{style:{textAlign:"center"},children:[Object(w.jsx)(de.a,{icon:Object(w.jsx)(ee.a,{children:"trending_up"}),severity:"success",children:Object(w.jsx)(te.a,{variant:"button",gutterBottom:!0,children:"Ingresos del d\xeda"})}),Object(w.jsx)(ee.a,{color:"primary",style:{fontSize:"60px"},children:"trending_up"}),Object(w.jsxs)(te.a,{variant:"h6",children:[" ",ue.numberSeparator(t)," "]})]})})}),Object(w.jsx)(Z.a,{xs:12,sm:6,md:3,item:!0,children:Object(w.jsx)(Ft.a,{children:Object(w.jsxs)(Bo.a,{style:{textAlign:"center"},children:[Object(w.jsx)(de.a,{icon:Object(w.jsx)(ee.a,{children:"trending_down"}),severity:"error",children:Object(w.jsx)(te.a,{variant:"button",gutterBottom:!0,children:"Egresos del d\xeda"})}),Object(w.jsx)(ee.a,{color:"error",style:{fontSize:"60px"},children:"trending_down"}),Object(w.jsx)(te.a,{variant:"h6",children:ue.numberSeparator(r)})]})})}),Object(w.jsx)(Z.a,{xs:12,sm:6,md:3,item:!0,children:Object(w.jsx)(Ft.a,{children:Object(w.jsxs)(Bo.a,{style:{textAlign:"center"},children:[Object(w.jsx)(de.a,{icon:Object(w.jsx)(ee.a,{children:"trending_up"}),severity:"success",children:Object(w.jsx)(te.a,{variant:"button",gutterBottom:!0,children:"Ingresos del mes"})}),Object(w.jsx)(ee.a,{color:"primary",style:{fontSize:"60px"},children:"trending_up"}),Object(w.jsx)(te.a,{variant:"h6",children:ue.numberSeparator(a)})]})})}),Object(w.jsx)(Z.a,{xs:12,sm:6,md:3,item:!0,children:Object(w.jsx)(Ft.a,{children:Object(w.jsxs)(Bo.a,{style:{textAlign:"center"},children:[Object(w.jsx)(de.a,{icon:Object(w.jsx)(ee.a,{children:"trending_down"}),severity:"error",children:Object(w.jsx)(te.a,{variant:"button",gutterBottom:!0,children:"Egresos del mes"})}),Object(w.jsx)(ee.a,{color:"error",style:{fontSize:"60px"},children:"trending_down"}),Object(w.jsx)(te.a,{variant:"h6",children:ue.numberSeparator(n)})]})})})]})}function Yo(){var e=Ho().listaMensual.filter((function(e){return"0"===e.tipo_registro})).reverse();return Object(w.jsx)(ne.a,{component:A.a,children:Object(w.jsxs)(oe.a,{children:[Object(w.jsx)("caption",{children:"Pagos realizados"}),Object(w.jsx)(ce.a,{children:Object(w.jsxs)(ie.a,{children:[Object(w.jsx)(se.a,{children:"Descripci\xf3n"}),Object(w.jsx)(se.a,{align:"right",children:"Fecha"}),Object(w.jsx)(se.a,{align:"right",children:"Monto"})]})}),Object(w.jsx)(le.a,{children:e.map((function(e,t){return Object(w.jsxs)(ie.a,{children:[Object(w.jsx)(se.a,{component:"th",scope:"row",children:e.detalles_movimiento}),Object(w.jsxs)(se.a,{align:"right",children:[" ",ue.fechaActualDMY(e.fecha_movimiento)]}),Object(w.jsxs)(se.a,{align:"right",children:[" ",ue.numberSeparator(e.monto_movimiento)]})]},t)}))})]})})}var Ko=a(385),Xo=function(){var e=Ho(),t=e.labelDiarioMes,a=e.datosEgresosDiariosMes,r=e.datosIngresosDiariosMes;return Object(w.jsx)(Ko.a,{height:"40vh",width:"100%",data:{labels:t,datasets:[{label:"Ingresos del d\xeda",data:r,backgroundColor:"#b9ddff",borderWidth:1,borderColor:"#1976d2",fill:!0},{label:"Egresos del d\xeda",data:a,backgroundColor:"#f5005791",borderWidth:1,borderColor:"#f50057",fill:!0}]}})};function Qo(){var e=Ho().listaMensual.filter((function(e){return"1"===e.tipo_registro})).reverse().slice(0,6);return Object(w.jsx)(ne.a,{component:A.a,children:Object(w.jsxs)(oe.a,{children:[Object(w.jsx)("caption",{children:"\xdaltimos ingresos"}),Object(w.jsx)(ce.a,{children:Object(w.jsxs)(ie.a,{children:[Object(w.jsx)(se.a,{children:"Descripci\xf3n"}),Object(w.jsx)(se.a,{align:"right",children:"Fecha"}),Object(w.jsx)(se.a,{align:"right",children:"Monto"}),Object(w.jsx)(se.a,{align:"right",children:"Sin efectivo"})]})}),Object(w.jsx)(le.a,{children:e.map((function(e,t){return Object(w.jsxs)(ie.a,{children:[Object(w.jsx)(se.a,{component:"th",scope:"row",children:e.detalles_movimiento}),Object(w.jsxs)(se.a,{align:"right",children:[" ",ue.fechaActualDMY(e.fecha_movimiento)]}),Object(w.jsxs)(se.a,{align:"right",children:[" ",ue.numberSeparator(e.monto_movimiento)]}),Object(w.jsxs)(se.a,{align:"right",children:[" ",ue.numberSeparator(e.monto_sin_efectivo)]})]},t)}))})]})})}var Zo=function(){var e=Ho(),t=e.fechaMostrar,a=e.cargando,r=e.mesState,n=e.setMesState;if(a)return Object(w.jsx)(V,{});return Object(w.jsx)(st.a,{disableGutters:!0,maxWidth:"md",children:Object(w.jsxs)(Z.a,{container:!0,spacing:2,children:[Object(w.jsxs)(Z.a,{item:!0,xs:12,sm:6,children:[Object(w.jsx)(te.a,{variant:"h6",children:"Informes gr\xe1ficos"}),Object(w.jsx)(te.a,{variant:"button",children:t})]}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:6,children:Object(w.jsx)(Fe.a,{type:"month",helperText:"Seleccionar mes",onChange:function(e){return n(e.target.value)},value:r})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(Jo,{})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(Ft.a,{children:Object(w.jsxs)(Bo.a,{children:[Object(w.jsxs)(te.a,{variant:"h6",children:["Informe del mes ",ue.fechaMesEs(r)]}),Object(w.jsx)(Xo,{})]})})}),Object(w.jsxs)(Z.a,{item:!0,xs:12,sm:6,children:[Object(w.jsx)(de.a,{severity:"success",icon:Object(w.jsx)(ee.a,{children:"credit_score"}),children:Object(w.jsxs)(te.a,{variant:"h6",children:["\xdaltimos ingresos mes ",ue.fechaMesEs(r)]})}),Object(w.jsx)(Qo,{})]}),Object(w.jsxs)(Z.a,{item:!0,xs:12,sm:6,children:[Object(w.jsxs)(de.a,{severity:"error",icon:Object(w.jsx)(ee.a,{children:"local_atm"}),children:[" ",Object(w.jsxs)(te.a,{variant:"h6",children:["\xdaltimos egresos mes ",ue.fechaMesEs(r)]})," "]}),Object(w.jsx)(Yo,{})]})]})})},$o=function(){return Object(w.jsx)(Go,{children:Object(w.jsx)(Zo,{})})},ec=Object(c.createContext)(),tc=function(e){var t=e.children,a=Object(c.useState)(!0),n=Object(r.a)(a,2),o=n[0],i=n[1],s=Object(c.useState)([]),u=Object(r.a)(s,2),j=u[0],b=u[1],p=Object(c.useCallback)(Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.get({table:"impuestos"});case 2:"ok"===(t=e.sent).response?b(t.results):console.log(t),i(!1);case 5:case"end":return e.stop()}}),e)}))),[]);return Object(c.useEffect)((function(){var e=!0,t=new AbortController;return e&&p(),function(){e=!1,t.abort()}}),[p]),Object(w.jsx)(ec.Provider,{value:{cargando:o,setCargando:i,lista:j,setLista:b},children:t})},ac=function(){var e=function(){var e=Object(c.useContext)(ec);return{cargando:e.cargando,setCargando:e.setCargando,lista:e.lista,setLista:e.setLista}}(),t=e.lista,a=e.cargando,r=t.filter((function(e){return e.nombre_impuesto.toLowerCase().includes("".toLowerCase())}));return Object(w.jsx)(ye,{nombretabla:"Impuestos",bgicono:"#3f51b5",cargando:a,icono:"account_balance",columnas:[{field:"id_impuesto",title:"#"},{field:"nombre_impuesto",title:"Nombre Impuesto"},{field:"porcentaje_impuesto",title:"porcentaje",extraitem:" %"}],filas:r,Acciones:function(){return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)(Pe.a,{children:Object(w.jsx)(ee.a,{children:"more_vert"})})})},showOptions:!0})},rc=function(){return Object(w.jsx)(tc,{children:Object(w.jsx)(ac,{})})},nc=Object(c.createContext)(),oc=function(){var e=Object(c.useContext)(nc);return{cargando:e.cargando,setCargando:e.setCargando,listaPagar:e.listaPagar,setListaPagar:e.setListaPagar,listaCobrar:e.listaCobrar,listaCajas:e.listaCajas,setListaCajas:e.setListaCajas,setListaCobrar:e.setListaCobrar,dialogs:e.dialogs,setDialogs:e.setDialogs,formPagar:e.formPagar,setformPagar:e.setformPagar,formasDePago:e.formasDePago,setFormasDePago:e.setFormasDePago,idCaja:e.idCaja,setIdCaja:e.setIdCaja,idFormasPago:e.idFormasPago,setIdFormasPago:e.setIdFormasPago,obs:e.obs,setObs:e.setObs,pagarCuenta:e.pagarCuenta,cargandoMov:e.cargandoMov,setCargandoMov:e.setCargandoMov,formCobrar:e.formCobrar,setformCobrar:e.setformCobrar,cobrarCuenta:e.cobrarCuenta,totalCobrar:e.totalCobrar,setTotalCobrar:e.setTotalCobrar}},cc=function(e){var t=e.children,a=I(),n=a.id_user,o=a.token_user,i=Object(c.useState)(!0),s=Object(r.a)(i,2),u=s[0],j=s[1],b=Object(c.useState)(!1),p=Object(r.a)(b,2),m=p[0],O=p[1],x=Object(c.useState)([]),h=Object(r.a)(x,2),f=h[0],g=h[1],_=Object(c.useState)([]),v=Object(r.a)(_,2),C=v[0],S=v[1],F=Object(c.useState)(0),P=Object(r.a)(F,2),A=P[0],D=P[1],E=Object(c.useState)([]),N=Object(r.a)(E,2),T=N[0],R=N[1],M=Object(c.useState)([]),L=Object(r.a)(M,2),W=L[0],z=L[1],q=Object(c.useState)({pagar:!1,cobrar:!1}),U=Object(r.a)(q,2),B=U[0],V=U[1],H=Object(c.useState)(""),G=Object(r.a)(H,2),J=G[0],Y=G[1],K=Object(c.useState)(""),X=Object(r.a)(K,2),Q=X[0],Z=X[1],$=Object(c.useState)(""),ee=Object(r.a)($,2),te=ee[0],ae=ee[1],re=ue.getFechaHorarioString(),ne=Object(c.useState)({id_compra:"",total_factura_compra:"",nro_factura_compra:""}),oe=Object(r.a)(ne,2),ce=oe[0],ie=oe[1],se=Object(c.useState)({monto_total_factura:"",id_factura:"",nro_factura:"",nombre_caja:""}),le=Object(r.a)(se,2),de=le[0],je=le[1],be=function(){var e=Object(d.a)(l.a.mark((function e(t){var a,r,c,i,s,d,u,j,b;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return O(!0),i=T.findIndex((function(e){return e.id_caja===J})),s=parseFloat(T[i].monto_caja)+parseFloat(de.monto_total_factura),e.next=5,k.update({data:{monto_caja:s,ult_mov_caja:re},token:o,id:J,table:"cajas"});case 5:return d=e.sent,null!==(a="ok"!==d.response)&&void 0!==a||console.log(d),e.next=9,k.update({table:"facturas",data:{estado_factura:1},id:de.id_factura,token:o});case 9:return u=e.sent,null!==(r="ok"!==u.response)&&void 0!==r||console.log(u),j={id_caja_movimiento:J,id_user_movimiento:n,id_tipo_registro:2,monto_movimiento:"1"===Q?de.monto_total_factura:0,monto_sin_efectivo:"1"!==Q?de.monto_total_factura:0,detalles_movimiento:"Cobro de ventas a cr\xe9dito factura nro: ".concat(de.nro_factura),fecha_movimiento:re},e.next=14,k.insert({table:"cajas_movimientos",token:o,data:j});case 14:b=e.sent,console.log(b),null!==(c="ok"!==b.response)&&void 0!==c||console.log(b),O(!1),y()({title:"Se ha cobrado correctamente",icon:"success",timer:1800}),V({pagar:!1,cobrar:!1}),me();case 21:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),pe=function(){var e=Object(d.a)(l.a.mark((function e(){var t,a,r,c,i,s,d,u,j;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return O(!0),e.next=3,k.update({table:"compras",token:o,data:{estado_compra:1},id:ce.id_compra});case 3:return c=e.sent,null!==(t="ok"!==c.response)&&void 0!==t||console.log(c),i=T.findIndex((function(e){return e.id_caja===J})),s=parseFloat(T[i].monto_caja)-parseFloat(ce.total_factura_compra),e.next=9,k.update({data:{monto_caja:s},token:o,id:J,table:"cajas"});case 9:return d=e.sent,null!==(a="ok"!==d.response)&&void 0!==a||console.log(d),u={id_caja_movimiento:J,id_user_movimiento:n,id_tipo_registro:7,monto_movimiento:"1"===Q?ce.total_factura_compra:0,monto_sin_efectivo:"1"!==Q?ce.total_factura_compra:0,detalles_movimiento:"Pago de compras a cr\xe9dito factura nro: ".concat(ce.nro_factura_compra),fecha_movimiento:re},e.next=14,k.insert({table:"cajas_movimientos",token:o,data:u});case 14:j=e.sent,null!==(r="ok"!==j.response)&&void 0!==r||console.log(j),O(!1),y()({title:"Se ha pagado correctamente",icon:"success",timer:1800}),V({pagar:!1,cobrar:!1}),me();case 20:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),me=Object(c.useCallback)(Object(d.a)(l.a.mark((function e(){var t,a,r,o,c,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([k.get({table:"facturas",include:"clientes,cajas",on:"id_cliente,id_cliente_factura,id_caja,id_caja_factura",where:"tipo_factura,=,2,and,estado_factura,=,2"}),k.get({table:"compras",where:"tipo_factura_compra,=,2,and,estado_compra,=,2"}),k.get({table:"cajas",include:"cajas_users",on:"id_caja_caja,id_caja",where:"id_user_caja,=,".concat(n,",and,estado_caja,=,1")}),k.get({table:"facturas_formas_pagos"})]);case 2:t=e.sent,"ok"===(a=t[0]).response&&(S(t[0].results),r=0,a.results.forEach((function(e){r+=parseFloat(e.monto_total_factura)})),D(r)),"ok"===(o=t[1]).response?g(o.results):console.log(o),"ok"===(c=t[2]).response?R(c.results):console.log(c),"ok"===(i=t[3]).response?z(i.results):console.log(i),j(!1);case 12:case"end":return e.stop()}}),e)}))),[n]);return Object(c.useEffect)((function(){var e=!0,t=new AbortController;return e&&me(),function(){e=!1,t.abort()}}),[me]),Object(w.jsx)(nc.Provider,{value:{cargando:u,setCargando:j,listaPagar:f,setListaPagar:g,listaCobrar:C,listaCajas:T,setListaCajas:R,setListaCobrar:S,dialogs:B,setDialogs:V,formPagar:ce,setformPagar:ie,formasDePago:W,setFormasDePago:z,idCaja:J,setIdCaja:Y,idFormasPago:Q,setIdFormasPago:Z,obs:te,setObs:ae,pagarCuenta:pe,cargandoMov:m,setCargandoMov:O,formCobrar:de,setformCobrar:je,cobrarCuenta:be,totalCobrar:A,setTotalCobrar:D},children:t})},ic=function(){var e=_t().MONEDA_PRINCIPAL,t=oc(),a=t.cargando,r=t.listaCobrar,n=t.setformCobrar,o=t.setDialogs,c=t.dialogs,i=t.listaCajas,s=t.setIdCaja,l=t.totalCobrar,d=Object(w.jsx)(w.Fragment,{children:Object(w.jsx)(Fe.a,{label:"Buscar por cliente",InputProps:{endAdornment:Object(w.jsx)(Ie.a,{position:"end",children:Object(w.jsx)(Pe.a,{onClick:function(){console.log("buscar")},children:Object(w.jsx)(ee.a,{children:"search"})})})}})}),u="Total a cobrar: "+ue.numberSeparator(l)+" "+e.abreviatura_moneda;return Object(w.jsx)(w.Fragment,{children:Object(w.jsx)(ye,{nombretabla:"Cuentas a cobrar",caption:u,subtitle:"Lista de ventas/facturas a cobrar",namecolumnID:"id_factura",Acciones:function(e){var t=e.filaProps;return Object(w.jsx)(ae.a,{variant:"outlined",onClick:function(){return function(e){var t=i.findIndex((function(t){return t.id_caja===e.id_caja_factura}));s(i[t].id_caja),n(e),o(Object(Te.a)(Object(Te.a)({},c),{},{cobrar:!0}))}(t)},startIcon:Object(w.jsx)(ee.a,{color:"primary",children:"paid"}),children:"Cobrar"})},cargando:a,columnas:[{field:"nro_factura",title:"NRO",isNumber:!0,style:{fontWeight:"bold"}},{field:"nombre_caja",title:"Caja"},{field:"nombre_cliente",title:"Cliente"},{field:"fecha_cobro_factura",title:"Fecha de cobro",style:{fontWeight:"bold"}},{field:"monto_total_factura",title:"Total",isNumber:!0,style:{fontWeight:"bold"}},{field:"estado_factura",title:"Estado",items:{1:"Pagado",2:"Pendiente de cobro"},comparaItem:"estado_factura"}],filas:r,search:d,showOptions:!0})})},sc=function(){var e=oc(),t=e.dialogs,a=e.setDialogs,r=e.formCobrar,n=e.formasDePago,o=e.idFormasPago,c=e.setIdFormasPago,i=e.obs,s=e.setObs,l=e.cobrarCuenta,d=e.cargandoMov,u=function(){a(Object(Te.a)(Object(Te.a)({},t),{},{cobrar:!1}))};return Object(w.jsx)(ze.a,{onClose:u,TransitionComponent:yt.a,fullWidth:!0,open:t.cobrar,children:Object(w.jsxs)("form",{onSubmit:function(e){e.preventDefault(),l()},children:[Object(w.jsx)(qe.a,{children:"Cuenta a cobrar"}),Object(w.jsx)(Ue.a,{children:Object(w.jsxs)(Z.a,{container:!0,spacing:2,children:[Object(w.jsx)(Z.a,{item:!0,xs:12,children:d&&Object(w.jsx)(Be.a,{})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsxs)(de.a,{severity:"info",children:["Nro de factura a cobrar: ",r.nro_factura]})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsxs)(de.a,{severity:"warning",children:["Caja: ",r.nombre_caja]})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsxs)(Ve.a,{fullWidth:!0,children:[Object(w.jsx)(He.a,{variant:"outlined",children:"Formas de pago"}),Object(w.jsx)(Ge.a,{required:!0,name:"id_formas_pago",value:o,onChange:function(e){c(e.target.value)},children:n.map((function(e,t){return Object(w.jsx)(Je.a,{value:e.id_facturas_formas_pago,children:e.descripcion_forma_pago},t)}))})]})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(Fe.a,{label:"Monto a cobrar",fullWidth:!0,value:r.monto_total_factura,disabled:!0,InputProps:{inputComponent:Va}})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(Fe.a,{label:"Observaciones y referencias",fullWidth:!0,value:i,onChange:function(e){return s(e.target.value)}})})]})}),Object(w.jsxs)(Ye.a,{children:[Object(w.jsx)(ae.a,{disabled:d,variant:"outlined",type:"submit",children:"Cobrar"}),Object(w.jsx)(ae.a,{variant:"outlined",onClick:u,children:"Cerrar"})]})]})})},lc=function(){var e=oc(),t=e.dialogs,a=e.setDialogs,n=e.listaCajas,o=e.formPagar,i=e.formasDePago,s=e.idCaja,u=e.setIdCaja,j=e.idFormasPago,b=e.setIdFormasPago,p=e.obs,m=e.setObs,O=e.pagarCuenta,x=e.cargandoMov,h=Object(c.useState)({error:!1,errorMsj:""}),f=Object(r.a)(h,2),g=f[0],_=f[1],v=function(){a(Object(Te.a)(Object(Te.a)({},t),{},{pagar:!1}))},C=function(){var e=Object(d.a)(l.a.mark((function e(t){var a,r,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),a=n.findIndex((function(e){return e.id_caja===s})),r=parseFloat(n[a].monto_caja),c=parseFloat(o.total_factura_compra),!(r<c&&"1"===j)){e.next=9;break}return _({error:!0,errorMsj:"No hay suficiente dinero en la caja para pagar esta cuenta"}),e.abrupt("return",!1);case 9:_({error:!1,errorMsj:""}),O();case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(w.jsx)(ze.a,{onClose:v,TransitionComponent:yt.a,fullWidth:!0,open:t.pagar,children:Object(w.jsxs)("form",{onSubmit:C,children:[Object(w.jsx)(qe.a,{children:"Cuenta a pagar "}),Object(w.jsx)(Ue.a,{children:Object(w.jsxs)(Z.a,{container:!0,spacing:2,children:[Object(w.jsxs)(Z.a,{item:!0,xs:12,children:[x&&Object(w.jsx)(Be.a,{}),g.error&&Object(w.jsx)(de.a,{severity:"error",children:g.errorMsj})]}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsxs)(Ve.a,{fullWidth:!0,children:[Object(w.jsx)(He.a,{variant:"outlined",children:"Seleccione la caja"}),Object(w.jsxs)(Ge.a,{name:"id_caja_movimiento",variant:"outlined",value:s,onChange:function(e){u(e.target.value)},required:!0,children:[Object(w.jsx)(Je.a,{disabled:!0,value:"",children:"Seleccione una caja"}),n.map((function(e,t){return Object(w.jsx)(Je.a,{value:e.id_caja,children:e.nombre_caja},t)}))]})]})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsxs)(Ve.a,{fullWidth:!0,children:[Object(w.jsx)(He.a,{variant:"outlined",children:"Formas de pago"}),Object(w.jsx)(Ge.a,{required:!0,name:"id_formas_pago",variant:"outlined",value:j,onChange:function(e){b(e.target.value)},children:i.map((function(e,t){return Object(w.jsx)(Je.a,{value:e.id_facturas_formas_pago,children:e.descripcion_forma_pago},t)}))})]})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(Fe.a,{label:"Monto",fullWidth:!0,value:o.total_factura_compra,disabled:!0,InputProps:{inputComponent:Va}})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(Fe.a,{label:"Observaciones y referencias",fullWidth:!0,value:p,onChange:function(e){return m(e.target.value)}})})]})}),Object(w.jsxs)(Ye.a,{children:[Object(w.jsx)(ae.a,{disabled:x,variant:"outlined",type:"submit",children:"Pagar"}),Object(w.jsx)(ae.a,{variant:"outlined",onClick:v,children:"Cerrar"})]})]})})},dc=function(){var e=oc(),t=e.cargando,a=e.listaPagar,r=e.dialogs,n=e.setDialogs,o=e.setformPagar;return Object(w.jsx)(ye,{nombretabla:"Cuentas a Pagar",subtitle:"Lista de compras a pagar",namecolumnID:"id_factura",Acciones:function(e){var t=e.filaProps;return Object(w.jsx)(ae.a,{variant:"outlined",onClick:function(){var e;e=t,n(Object(Te.a)(Object(Te.a)({},r),{},{pagar:!0})),o(e)},startIcon:Object(w.jsx)(ee.a,{color:"primary",children:"paid"}),children:"Pagar"})},cargando:t,columnas:[{field:"nro_factura_compra",title:"Nro factura",style:{fontWeight:"bold"}},{field:"total_factura_compra",title:"Total",isNumber:!0,style:{fontWeight:"bold"}},{field:"fecha_pago_compra",title:"Fecha a pagar",isDate:!0},{field:"fecha_compra",title:"Fecha de compra",isDate:!0},{field:"estado_compra",title:"Estado",items:{1:"Pagado",2:"Pendiente de pago"},comparaItem:"estado_compra",style:{fontWeight:"bold"}}],filas:a,showOptions:!0})},uc=function(){var e=Object(c.useState)(0),t=Object(r.a)(e,2),a=t[0],n=t[1],o=function(e){var t=e.children,r=e.index;return a===r&&Object(w.jsx)("div",{style:{marginTop:"25px"},children:t})};return Object(w.jsxs)(w.Fragment,{children:[Object(w.jsxs)(Na.a,{indicatorColor:"primary",textColor:"primary",value:a,onChange:function(e,t){n(t)},children:[Object(w.jsx)(Ta.a,{label:"Cuentas a cobrar"}),Object(w.jsx)(Ta.a,{label:"Cuentas a pagar"})]}),Object(w.jsxs)(o,{value:a,index:0,children:[Object(w.jsx)(ic,{}),Object(w.jsx)(sc,{})]}),Object(w.jsxs)(o,{value:a,index:1,children:[Object(w.jsx)(dc,{}),Object(w.jsx)(lc,{})]})]})},jc=function(){return Object(w.jsx)(cc,{children:Object(w.jsx)(uc,{})})},bc=Object(c.createContext)(),pc=function(){var e=Object(c.useContext)(bc);return{lista:e.lista,listaEmpleados:e.listaEmpleados,listaServicios:e.listaServicios,cargando:e.cargando,setCargando:e.setCargando,getLista:e.getLista,dialogs:e.dialogs,setDialogs:e.setDialogs,form:e.form,setForm:e.setForm,initialForm:e.initialForm,formEdit:e.formEdit,setFormEdit:e.setFormEdit,initialFormEdit:e.initialFormEdit,cambiarEstado:e.cambiarEstado,AgregarTurno:e.AgregarTurno,getServiciosEdit:e.getServiciosEdit}},mc=function(e){var t=e.children,a=I().token_user,n=Object(c.useState)([]),o=Object(r.a)(n,2),i=o[0],s=o[1],u=Object(c.useState)([]),j=Object(r.a)(u,2),b=j[0],p=j[1],m=Object(c.useState)([]),O=Object(r.a)(m,2),x=O[0],h=O[1],f=Object(c.useState)({lista:!0,servicios:!0,editar:!0,serviciosEdit:!0}),g=Object(r.a)(f,2),_=g[0],v=g[1],C={id_cliente_turno:"",id_empleado_turno:"",servicios:[],nombre_cliente:"",nombre_empleado:"",nombre_producto:"",fecha_tomada:"",fecha_turno:"",horario_turno:"",estado_turno:"0"},S=Object(c.useState)(C),F=Object(r.a)(S,2),P=F[0],A=F[1],D={id_turno:"",id_cliente_turno:"",id_empleado_turno:"",servicios:[],nombre_cliente:"",nombre_empleado:"",nombre_producto:"",fecha_tomada:"",fecha_turno:"",horario_turno:"",estado_turno:"0"},E=Object(c.useState)(D),N=Object(r.a)(E,2),T=N[0],R=N[1],M=Object(c.useState)({agregar:!1,registrarCliente:!1,editar:!1}),L=Object(r.a)(M,2),W=L[0],z=L[1],q=Object(c.useCallback)(Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.get({table:"empleados"});case 2:"ok"===(t=e.sent).response?p(t.results):console.log(t);case 4:case"end":return e.stop()}}),e)}))),[]),U=Object(c.useCallback)(Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.get({table:"productos",where:"tipo_producto,=,2",fields:"nombre_producto,id_producto"});case 2:"ok"===(t=e.sent).response?h(t.results):console.log(t);case 4:case"end":return e.stop()}}),e)}))),[]),B=function(){var e=Object(d.a)(l.a.mark((function e(t){var a,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return v(Object(Te.a)(Object(Te.a)({},_),{},{serviciosEdit:!0})),a=Object(Te.a)({},t),e.next=4,k.get({table:"turnos_servicios",include:"productos",on:"id_servicio_turno,id_producto",where:"id_turno_servicio,=,".concat(t.id_turno)});case 4:"ok"===(r=e.sent).response?a.servicios=r.results:console.log(r),R(a),v(Object(Te.a)(Object(Te.a)({},_),{},{serviciosEdit:!1}));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),V=Object(c.useCallback)(Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.get({table:"turnos",include:"clientes,empleados",on:"id_cliente,id_cliente_turno,id_empleado_turno,id_empleado",sort:"fecha_turno",where:"estado_turno,<>,2",fields:"nombre_cliente,fecha_tomada,fecha_turno,estado_turno,id_turno,id_cliente_turno,horario_turno,nombre_empleado,id_empleado_turno"});case 2:"ok"===(t=e.sent).response?s(t.results):console.log(t),v({lista:!1,servicios:!0});case 5:case"end":return e.stop()}}),e)}))),[]),H=function(){var e=Object(d.a)(l.a.mark((function e(){var t,r,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return v(Object(Te.a)(Object(Te.a)({},_),{},{lista:!0})),z(Object(Te.a)(Object(Te.a)({},W),{},{agregar:!1})),t=Object(Te.a)({},P),r=Object(Te.a)({},P),delete t.nombre_cliente,delete t.fecha_tomada,delete t.nombre_empleado,delete t.nombre_producto,delete t.servicios,e.next=11,k.insert({table:"turnos",data:t,token:a});case 11:"ok"===(n=e.sent).response?(r.servicios.forEach(function(){var e=Object(d.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.insert({table:"turnos_servicios",data:{id_turno_servicio:n.last_id,id_servicio_turno:t.id_producto},token:a});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),V(),y()({text:"Agregado correctamente",icon:"success",timer:1300})):console.log(n),v(Object(Te.a)(Object(Te.a)({},_),{},{lista:!1}));case 14:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),G=function(){var e=Object(d.a)(l.a.mark((function e(){var t,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return v(Object(Te.a)(Object(Te.a)({},_),{},{serviciosEdit:!0})),z(Object(Te.a)(Object(Te.a)({},W),{},{editar:!1})),delete(t=Object(Te.a)({},T)).nombre_cliente,delete t.nombre_empleado,delete t.nombre_producto,delete t.servicios,e.next=9,k.update({table:"turnos",data:t,id:t.id_turno,token:a});case 9:"ok"===(r=e.sent).response?(V(),y()({text:"Actualizado",icon:"success",timer:1300})):console.log(r),v(Object(Te.a)(Object(Te.a)({},_),{},{serviciosEdit:!0}));case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(c.useEffect)((function(){var e=!0,t=new AbortController;return e&&(q(),V(),U()),function(){e=!1,t.abort()}}),[q,V,U]),Object(w.jsx)(bc.Provider,{value:{lista:i,listaServicios:x,listaEmpleados:b,cargando:_,setCargando:v,getLista:V,dialogs:W,setDialogs:z,form:P,setForm:A,initialForm:C,formEdit:T,setFormEdit:R,initialFormEdit:D,cambiarEstado:G,AgregarTurno:H,getServiciosEdit:B},children:t})},Oc=function(){var e=pc(),t=e.dialogs,a=e.setDialogs,n=e.setForm,o=e.form,i=I().token_user,s={ruc_cliente:"",nombre_cliente:"",direccion_cliente:"",telefono_cliente:"",email_cliente:""},u={ruc_cliente:!1,nombre_cliente:!1,ruc_error:"",nombre_error:""},j=Object(c.useState)(s),b=Object(r.a)(j,2),p=b[0],m=b[1],O=Object(c.useState)(u),x=Object(r.a)(O,2),h=x[0],f=x[1],g=Object(c.useState)(!1),_=Object(r.a)(g,2),v=_[0],C=_[1],S=Object(c.useRef)(null),y=Object(c.useRef)(null),F=function(){var e=Object(d.a)(l.a.mark((function e(){var t,a,r,c,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(f(u),!(p.ruc_cliente.length<3)){e.next=5;break}return f(Object(Te.a)(Object(Te.a)({},h),{},{ruc_cliente:!0,ruc_error:"Complete este dato"})),null===(t=S.current)||void 0===t||t.focus(),e.abrupt("return",!1);case 5:if(!(p.nombre_cliente.length<4)){e.next=9;break}return f(Object(Te.a)(Object(Te.a)({},h),{},{nombre_cliente:!0,nombre_error:"El nombre debe tener al menos 5 letras"})),null===(a=y.current)||void 0===a||a.focus(),e.abrupt("return",!1);case 9:return r=S.current.value,C(!0),e.next=13,k.get({table:"clientes",fields:"id_cliente",where:"ruc_cliente,=,'".concat(r,"'")});case 13:if(0!==e.sent.found){e.next=27;break}return e.prev=15,e.next=18,k.insert({table:"clientes",data:p,token:i});case 18:"ok"===(c=e.sent).response&&(s=c.last_id,n(Object(Te.a)(Object(Te.a)({},o),{},{id_cliente_turno:s,nombre_cliente:y.current.value})),A()),e.next=25;break;case 22:e.prev=22,e.t0=e.catch(15),C(!1);case 25:e.next=29;break;case 27:f(Object(Te.a)(Object(Te.a)({},h),{},{ruc_cliente:!0,ruc_error:"Ese cliente ya esta registrado."})),S.current.focus();case 29:C(!1);case 30:case"end":return e.stop()}}),e,null,[[15,22]])})));return function(){return e.apply(this,arguments)}}(),P=function(e){var t=e.target,a=t.name,r=t.value;m(Object(Te.a)(Object(Te.a)({},p),{},Object(G.a)({},a,r)))},A=function(){a(Object(Te.a)(Object(Te.a)({},t),{},{registrarCliente:!1})),m(s),f(u),C(!1)};return Object(w.jsx)("form",{onSubmit:F,children:Object(w.jsxs)(ze.a,{open:t.registrarCliente,onClose:A,fullWidth:!0,children:[Object(w.jsx)(qe.a,{children:"Registrar cliente"}),Object(w.jsx)(Ue.a,{dividers:!0,children:Object(w.jsxs)(Z.a,{container:!0,spacing:2,children:[Object(w.jsx)(Z.a,{item:!0,xs:12,children:v&&Object(w.jsx)(Be.a,{})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(Fe.a,{autoComplete:"off",required:!0,inputRef:S,onChange:P,label:"Nro Documento",autoFocus:!0,fullWidth:!0,name:"ruc_cliente",value:p.ruc_cliente,variant:"outlined",InputProps:{startAdornment:Object(w.jsx)(Ie.a,{position:"start",children:Object(w.jsx)(ee.a,{color:"disabled",children:"description"})})},error:h.ruc_cliente,helperText:h.ruc_error})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(Fe.a,{required:!0,inputRef:y,autoComplete:"off",label:"Nombre",fullWidth:!0,name:"nombre_cliente",variant:"outlined",onChange:P,value:p.nombre_cliente,InputProps:{startAdornment:Object(w.jsx)(Ie.a,{position:"start",children:Object(w.jsx)(ee.a,{color:"disabled",children:"person"})})},error:h.nombre_cliente,helperText:h.nombre_error})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(Fe.a,{label:"Tel\xe9fono",fullWidth:!0,autoComplete:"off",onChange:P,name:"telefono_cliente",variant:"outlined",value:p.telefono_cliente,InputProps:{startAdornment:Object(w.jsx)(Ie.a,{position:"start",children:Object(w.jsx)(ee.a,{color:"disabled",children:"phone"})})}})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(Fe.a,{label:"Direcci\xf3n",fullWidth:!0,autoComplete:"off",onChange:P,name:"direccion_cliente",variant:"outlined",value:p.direccion_cliente,InputProps:{startAdornment:Object(w.jsx)(Ie.a,{position:"start",children:Object(w.jsx)(ee.a,{color:"disabled",children:"location_city"})})}})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(Fe.a,{label:"Email",fullWidth:!0,autoComplete:"off",onChange:P,name:"email_cliente",variant:"outlined",value:p.email_cliente,InputProps:{startAdornment:Object(w.jsx)(Ie.a,{position:"start",children:Object(w.jsx)(ee.a,{color:"disabled",children:"alternate_email"})})}})})]})}),Object(w.jsxs)(Ye.a,{children:[Object(w.jsx)(ae.a,{variant:"outlined",color:"primary",onClick:function(){F()},type:"submit",children:"Registrar"}),Object(w.jsx)(ae.a,{variant:"outlined",onClick:A,children:"Cancelar"})]})]})})},xc=a(844),hc=a(841),fc=function(){var e=pc(),t=e.dialogs,a=e.setDialogs,n=e.form,o=e.setForm,i=e.AgregarTurno,s=e.cargando,u=e.listaEmpleados,j=e.listaServicios,b=Object(c.useState)([]),p=Object(r.a)(b,2),m=p[0],O=p[1],x=Object(c.useState)({completo:!1,mensaje:""}),h=Object(r.a)(x,2),f=h[0],g=h[1],_=Object(c.useRef)(null),v=function(){return a(Object(Te.a)(Object(Te.a)({},t),{},{agregar:!1}))},C=function(e){var t=e.target,a=t.value,r=t.name;o(Object(Te.a)(Object(Te.a)({},n),{},Object(G.a)({},r,a)))},S=function(){var e=Object(d.a)(l.a.mark((function e(t){var a,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.target.value,e.next=3,k.get({table:"clientes",filtersSearch:a,filtersField:"nombre_cliente"});case 3:"ok"===(r=e.sent).response?O(r.results):console.log(r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(w.jsx)(ze.a,{open:t.agregar,maxWidth:"md",onClose:v,fullWidth:!0,children:s.servicios?Object(w.jsx)(V,{}):Object(w.jsxs)(c.Fragment,{children:[Object(w.jsx)(qe.a,{children:""===n.id_turno?"AGENDAR TURNO":"CAMBIAR ESTADO"}),Object(w.jsx)(Ue.a,{dividers:!0,children:Object(w.jsxs)(Z.a,{container:!0,spacing:2,children:[f.completo&&Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(de.a,{severity:"error",children:f.mensaje})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(sr.a,{loadingText:"Cargando...",noOptionsText:"No hay clientes con ese nombre",onChange:function(e,t){o(Object(Te.a)(Object(Te.a)({},n),{},{id_cliente_turno:t.id_cliente,nombre_cliente:t.nombre_cliente}))},disableClearable:!0,options:m,getOptionLabel:function(e){return e.nombre_cliente+" "+e.ruc_cliente},fullWidth:!0,renderInput:function(e){return Object(w.jsx)(Fe.a,Object(Te.a)(Object(Te.a)({},e),{},{autoFocus:!0,inputRef:_,onChange:S,fullWidth:!0,label:"Buscar por nombre de cliente..."}))}})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:7,children:Object(w.jsxs)(Ve.a,{fullWidth:!0,children:[Object(w.jsx)(He.a,{children:"Seleccione empleado"}),Object(w.jsxs)(Ge.a,{name:"id_empleado_turno",value:n.id_empleado_turno,onChange:C,children:[Object(w.jsx)(Je.a,{value:"0",disabled:!0,children:"Seleccione empleado"}),u.map((function(e,t){return Object(w.jsx)(Je.a,{value:e.id_empleado,children:e.nombre_empleado},t)}))]})]})}),Object(w.jsx)(Z.a,{item:!0,sm:5,xs:12,justifyContent:"flex-end",children:Object(w.jsx)(ae.a,{variant:"outlined",onClick:function(){return a(Object(Te.a)(Object(Te.a)({},t),{},{registrarCliente:!0}))},children:"Registrar nuevo cliente"})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(re.a,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:n.servicios.map((function(e,t){return Object(w.jsx)(xc.a,{label:e.nombre_producto,value:e.id_producto,color:"primary",variant:"outlined",onDelete:function(){return function(e){var t=Object(Te.a)({},n),a=t.servicios.findIndex((function(t){return t.id_producto===e.id_producto}));a>-1&&t.servicios.splice(a,1),o(t)}(e)}},t)}))})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsxs)(Ve.a,{fullWidth:!0,children:[Object(w.jsx)(He.a,{children:"Seleccione servicio"}),Object(w.jsx)(Ge.a,{multiple:!0,onChange:function(e){var t=Object(Te.a)({},n),a=e.target.value,r=t.servicios.length;if(t.servicios.findIndex((function(e){return e.id_producto===a[r]}))>-1);else{var c=j.find((function(e){return e.id_producto===a[r]}));c&&(t.servicios.push(c),o(t))}},name:"servicios",value:n.servicios,input:Object(w.jsx)(hc.a,{label:"Servicios"}),children:j.map((function(e,t){return Object(w.jsxs)(Je.a,{value:e.id_producto,children:[Object(w.jsx)(za.a,{checked:n.servicios.findIndex((function(t){return t.id_producto===e.id_producto}))>-1}),Object(w.jsx)(Ht.a,{primary:e.nombre_producto})]},t)}))})]})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsxs)(de.a,{severity:"info",icon:!1,variant:"outlined",children:["CLIENTE: ",n.nombre_cliente]})}),Object(w.jsx)(Z.a,{item:!0,xs:6,children:Object(w.jsxs)(Ve.a,{component:"fieldset",children:[Object(w.jsx)(rt.a,{component:"legend",children:"Estado de atencion"}),Object(w.jsxs)(nt.a,{onChange:C,name:"estado_turno",children:[Object(w.jsx)(ot.a,{value:"0",control:Object(w.jsx)(ct.a,{color:"error",checked:"0"===n.estado_turno}),label:"EN ESPERA"}),Object(w.jsx)(ot.a,{value:"1",control:Object(w.jsx)(ct.a,{color:"success",checked:"1"===n.estado_turno}),label:"ATENDIDO"})]})]})}),Object(w.jsxs)(Z.a,{item:!0,xs:6,children:[Object(w.jsx)(Fe.a,{helperText:"Fecha de turno",type:"date",name:"fecha_turno",onChange:C,required:!0,fullWidth:!0}),Object(w.jsx)(Fe.a,{fullWidth:!0,helperText:"Horario",type:"time",name:"horario_turno",onChange:C,required:!0})]})]})}),Object(w.jsxs)(Ye.a,{children:[Object(w.jsx)(ae.a,{variant:"outlined",onClick:function(){var e=n;if(e.servicios.length<1||""===e.id_empleado_turno||""===e.horario_turno||""===e.fecha_turno||""===e.id_cliente_turno)return g(Object(Te.a)(Object(Te.a)({},f),{},{completo:!0,mensaje:"Complete todos los datos correctamente"})),!1;i()},color:"primary",children:"AGREGAR TURNO"}),Object(w.jsx)(ae.a,{variant:"outlined",color:"secondary",onClick:v,children:"Cancelar"})]})]})})},gc=a(821),_c=function(){var e=pc(),t=e.dialogs,a=e.setDialogs,r=e.cargando,n=e.listaEmpleados,o=e.formEdit,c=e.setFormEdit,i=e.cambiarEstado,s=function(){a(Object(Te.a)(Object(Te.a)({},t),{},{editar:!1}))},l=function(e){var t=e.target,a=t.value,r=t.name;c(Object(Te.a)(Object(Te.a)({},o),{},Object(G.a)({},r,a)))};return Object(w.jsxs)(ze.a,{open:t.editar,maxWidth:"md",onClose:s,fullWidth:!0,children:[Object(w.jsx)(qe.a,{children:"Cambiar estado"}),Object(w.jsx)(Ue.a,{dividers:!0,children:Object(w.jsxs)(Z.a,{container:!0,spacing:2,children:[Object(w.jsx)(Z.a,{item:!0,xs:12,children:r.serviciosEdit&&Object(w.jsx)(Be.a,{})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsxs)(de.a,{severity:"info",icon:!1,children:["CLIENTE: ",o.nombre_cliente]})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(gc.a,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:o.servicios.map((function(e,t){return Object(w.jsx)(xc.a,{label:e.nombre_producto,value:e.id_producto,color:"primary",variant:"outlined"},t)}))})}),Object(w.jsx)(Z.a,{item:!0,xs:6,children:Object(w.jsxs)(Ve.a,{fullWidth:!0,children:[Object(w.jsx)(He.a,{children:"Seleccione empleado"}),Object(w.jsxs)(Ge.a,{name:"id_empleado_turno",value:o.id_empleado_turno,onChange:l,children:[Object(w.jsx)(Je.a,{value:"0",disabled:!0,children:"Seleccione empleado"}),n.map((function(e,t){return Object(w.jsx)(Je.a,{value:e.id_empleado,children:e.nombre_empleado},t)}))]})]})}),Object(w.jsx)(Z.a,{item:!0,xs:6,children:Object(w.jsxs)(Ve.a,{component:"fieldset",children:[Object(w.jsx)(rt.a,{component:"legend",children:"Cambiar estado"}),Object(w.jsxs)(nt.a,{onChange:l,name:"estado_turno",children:[Object(w.jsx)(ot.a,{value:"0",control:Object(w.jsx)(ct.a,{color:"error",checked:"0"===o.estado_turno}),label:"EN ESPERA"}),Object(w.jsx)(ot.a,{value:"1",control:Object(w.jsx)(ct.a,{color:"success",checked:"1"===o.estado_turno}),label:"ATENDIDO"}),Object(w.jsx)(ot.a,{value:"2",control:Object(w.jsx)(ct.a,{checked:"2"===o.estado_turno}),label:"FINALIZADO"})]})]})})]})}),Object(w.jsxs)(Ye.a,{children:[Object(w.jsx)(ae.a,{variant:"outlined",onClick:i,color:"primary",children:"CAMBIAR ESTADO"}),Object(w.jsx)(ae.a,{variant:"outlined",color:"secondary",onClick:s,children:"CANCELAR"})]})]})},vc=function(){var e=pc(),t=e.lista,a=e.cargando,r=e.setCargando,n=e.dialogs,o=e.setDialogs,c=e.setForm,i=e.initialForm,s=e.getServiciosEdit,l=t,d=Object(w.jsx)(ae.a,{variant:"outlined",color:"primary",size:"large",onClick:function(){c(i),o(Object(Te.a)(Object(Te.a)({},n),{},{agregar:!0})),r(Object(Te.a)(Object(Te.a)({},a),{},{servicios:!1}))},children:"Agregar"});return Object(w.jsx)(ye,{nombretabla:"Turnos",subtitle:"Modulo de turnos",bgicono:"#3f51b5",cargando:a.lista,icono:"login",columnas:[{field:"id_turno",title:"#"},{field:"nombre_cliente",title:"Cliente"},{field:"nombre_empleado",title:"Atendido por:"},{field:"fecha_turno",title:"Fecha"},{field:"horario_turno",title:"Horario"},{field:"estado_turno",title:"Estado",items:{0:"EN ESPERA",1:"ATENDIDO",2:"FINALIZADO"},comparaItem:"estado_turno",styleCondicion:{0:{backgroundColor:"#dd4632",padding:"6px",borderRadius:"5px",color:"#fff"},1:{backgroundColor:"#00ce4f",padding:"6px",borderRadius:"5px",color:"#fff"},2:{backgroundColor:"#0082ce",padding:"6px",borderRadius:"5px",color:"#fff"}}}],filas:l,Acciones:function(e){var t=e.filaProps;return Object(w.jsxs)(we.a,{direction:"row",spacing:1,children:[Object(w.jsx)(ae.a,{variant:"outlined",onClick:function(){console.log(t)},children:"Ver detalles"}),Object(w.jsx)(ae.a,{variant:"outlined",onClick:function(){s(t),o(Object(Te.a)(Object(Te.a)({},n),{},{editar:!0}))},children:"Cambiar estado"})]})},search:d})},Cc=function(){return Object(w.jsxs)(mc,{children:[Object(w.jsx)(vc,{}),Object(w.jsx)(fc,{}),Object(w.jsx)(_c,{}),Object(w.jsx)(Oc,{})]})},kc=Object(c.createContext)(),Sc=function(){var e=Object(c.useContext)(kc);return{eventos:e.eventos,lista:e.lista,addEvent:e.addEvent,loading:e.loading,form:e.form,setForm:e.setForm,initialForm:e.initialForm,dialogs:e.dialogs,setDialogs:e.setDialogs,insertarAgendar:e.insertarAgendar,updateAgenda:e.updateAgenda,borrarAgenda:e.borrarAgenda}},yc=function(e){var t=e.children,a=Object(c.useState)([]),n=Object(r.a)(a,2),o=n[0],i=n[1],s=Object(c.useState)([]),u=Object(r.a)(s,2),j=u[0],b=u[1],p=I().token_user,m={descripcion_agenda:"",fecha_inicio_agenda:"",fecha_fin_agenda:"",horario_agenda:"12:00",color_agenda:"#0066cc"},O=Object(c.useState)(m),x=Object(r.a)(O,2),h=x[0],f=x[1],g=Object(c.useState)({general:!0}),_=Object(r.a)(g,2),v=_[0],C=_[1],S=Object(c.useState)({agregar:!1,editar:!1}),F=Object(r.a)(S,2),P=F[0],A=F[1],D=Object(c.useCallback)((function(e){f({descripcion_agenda:"",fecha_inicio_agenda:e,fecha_fin_agenda:e,horario_agenda:"12:00",color_agenda:"#0066cc"}),A(Object(Te.a)(Object(Te.a)({},P),{},{agregar:!0}))}),[P]),E=Object(c.useCallback)(Object(d.a)(l.a.mark((function e(){var t,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return C({general:!0}),e.next=3,k.get({table:"agendas"});case 3:"ok"===(t=e.sent).response?(b(t.results),a=[],t.results.forEach((function(e){a.push({id:e.id_agenda,title:e.descripcion_agenda,start:e.fecha_inicio_agenda+"T"+e.horario_agenda,end:e.fecha_fin_agenda,allDay:!1,color:e.color_agenda})})),i(a)):console.log(t),C({general:!1});case 6:case"end":return e.stop()}}),e)}))),[]),N=Object(c.useCallback)(Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.update({table:"agendas",data:h,token:p,id:h.id_agenda});case 2:"ok"===(t=e.sent).response?(y()({text:"Reagendado correctamente",icon:"success",timer:1400}),A(Object(Te.a)(Object(Te.a)({},P),{},{editar:!1})),f({descripcion_agenda:"",fecha_inicio_agenda:"",fecha_fin_agenda:"",horario_agenda:"12:00",color_agenda:"#0066cc"}),E()):console.log(t);case 4:case"end":return e.stop()}}),e)}))),[h,p,E,P]),T=Object(c.useCallback)(Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.delete({table:"agendas",id:h.id_agenda,token:p});case 2:"ok"===(t=e.sent).response?(y()({text:"Borrado correctamente",icon:"success",timer:1400}),A(Object(Te.a)(Object(Te.a)({},P),{},{editar:!1})),f({descripcion_agenda:"",fecha_inicio_agenda:"",fecha_fin_agenda:"",horario_agenda:"12:00",color_agenda:"#0066cc"}),E()):console.log(t);case 4:case"end":return e.stop()}}),e)}))),[P,h,E,p]),R=Object(c.useCallback)(Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==h.descripcion_agenda){e.next=2;break}return e.abrupt("return",!1);case 2:return e.next=4,k.insert({table:"agendas",data:h,token:p});case 4:"ok"===(t=e.sent).response?(A(Object(Te.a)(Object(Te.a)({},P),{},{agregar:!1})),f({descripcion_agenda:"",fecha_inicio_agenda:"",fecha_fin_agenda:"",horario_agenda:"12:00",color_agenda:"#0066cc"}),E()):console.log(t);case 6:case"end":return e.stop()}}),e)}))),[P,h,p,E]);return Object(c.useEffect)((function(){var e=new AbortController,t=!0;return t&&E(),function(){t=!1,e.abort()}}),[E]),Object(w.jsx)(kc.Provider,{value:{eventos:o,lista:j,addEvent:D,loading:v,form:h,setForm:f,initialForm:m,dialogs:P,setDialogs:A,insertarAgendar:R,updateAgenda:N,borrarAgenda:T},children:t})},wc=function(){var e=Sc(),t=e.dialogs,a=e.setDialogs,r=e.form,n=e.setForm,o=e.insertarAgendar,c=function(e){var t=e.target,a=t.value,o=t.name;n(Object(Te.a)(Object(Te.a)({},r),{},Object(G.a)({},o,a)))},i=function(){a(Object(Te.a)(Object(Te.a)({},t),{},{agregar:!1}))};return Object(w.jsxs)(ze.a,{open:t.agregar,onClose:i,fullWidth:!0,children:[Object(w.jsx)(qe.a,{children:"Agendar"}),Object(w.jsx)(Ue.a,{dividers:!0,children:Object(w.jsxs)(Z.a,{container:!0,spacing:2,children:[Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(Fe.a,{autoComplete:"off",autoFocus:!0,fullWidth:!0,label:"Descripci\xf3n de agenda",name:"descripcion_agenda",value:r.descripcion_agenda,onChange:c})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(Fe.a,{fullWidth:!0,label:"Fecha de inicio",name:"fecha_inicio_agenda",value:r.fecha_inicio_agenda,type:"date",onChange:c})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(Fe.a,{fullWidth:!0,label:"Fecha de fin",name:"fecha_fin_agenda",value:r.fecha_fin_agenda,type:"date",onChange:c})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(Fe.a,{fullWidth:!0,label:"Horario",name:"horario_agenda",value:r.horario_agenda,type:"time",onChange:c})}),Object(w.jsxs)(Z.a,{item:!0,xs:12,children:["Color de agenda: ",Object(w.jsx)(gc.a,{sx:{background:r.color_agenda,width:40,height:40}})]}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(we.a,{direction:"row",spacing:1,children:["#0066cc","#00cc66","#D90B1C","#202731","#970FF2","#EAF205"].map((function(e,t){return Object(w.jsx)(xc.a,{sx:{bgcolor:e,width:40,height:40,cursor:"pointer"},onClick:function(){return t=e,void n(Object(Te.a)(Object(Te.a)({},r),{},{color_agenda:t}));var t}},t)}))})})]})}),Object(w.jsxs)(Ye.a,{children:[Object(w.jsx)(ae.a,{variant:"outlined",onClick:o,children:"Agendar"}),Object(w.jsx)(ae.a,{variant:"outlined",onClick:i,children:"Cerrar"})]})]})},Fc=function(){var e=Sc(),t=e.dialogs,a=e.setDialogs,r=e.form,n=e.setForm,o=e.updateAgenda,c=e.borrarAgenda,i=function(e){var t=e.target,a=t.value,o=t.name;n(Object(Te.a)(Object(Te.a)({},r),{},Object(G.a)({},o,a)))},s=function(){return a(Object(Te.a)(Object(Te.a)({},t),{},{editar:!1}))};return Object(w.jsxs)(ze.a,{open:t.editar,onClose:s,fullWidth:!0,children:[Object(w.jsx)(qe.a,{children:"Reagendar"}),Object(w.jsx)(Ue.a,{dividers:!0,children:Object(w.jsxs)(Z.a,{container:!0,spacing:2,children:[Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(Fe.a,{autoComplete:"off",autoFocus:!0,fullWidth:!0,label:"Descripci\xf3n de agenda",name:"descripcion_agenda",value:r.descripcion_agenda,onChange:i})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(Fe.a,{fullWidth:!0,label:"Fecha de inicio",name:"fecha_inicio_agenda",value:r.fecha_inicio_agenda,type:"date",onChange:i})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(Fe.a,{fullWidth:!0,label:"Fecha de fin",name:"fecha_fin_agenda",value:r.fecha_fin_agenda,type:"date",onChange:i})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(Fe.a,{fullWidth:!0,label:"Horario",name:"horario_agenda",value:r.horario_agenda,type:"time",onChange:i})}),Object(w.jsxs)(Z.a,{item:!0,xs:12,children:["Color de agenda: ",Object(w.jsx)(re.a,{sx:{background:r.color_agenda,width:40,height:40}})]}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(we.a,{direction:"row",spacing:1,children:["#0066cc","#00cc66","#D90B1C","#202731","#970FF2","#EAF205"].map((function(e,t){return Object(w.jsx)(xc.a,{sx:{bgcolor:e,width:40,height:40,cursor:"pointer"},onClick:function(){return t=e,void n(Object(Te.a)(Object(Te.a)({},r),{},{color_agenda:t}));var t}},t)}))})})]})}),Object(w.jsxs)(Ye.a,{children:[Object(w.jsx)(ae.a,{variant:"contained",color:"error",onClick:c,children:"Borrar"}),Object(w.jsx)(ae.a,{variant:"outlined",onClick:function(){o()},children:"Reagendar"}),Object(w.jsx)(ae.a,{variant:"outlined",onClick:s,children:"Cerrar"})]})]})},Ic=a(386),Pc=a(387),Ac=a(382),Dc=a.n(Ac),Ec=a(388),Nc=function(){var e=Sc(),t=e.eventos,a=e.addEvent,r=e.loading,n=e.lista,o=e.setForm,c=e.dialogs,i=e.setDialogs;return r.general?Object(w.jsx)(V,{}):Object(w.jsx)(Ic.a,{locale:Dc.a,plugins:[Pc.a,Ec.a],dayCellContent:function(e){return Object(w.jsx)(ae.a,{onClick:function(){return function(e){a(e.date.getFullYear().toString()+"-"+(e.date.getMonth()+1).toString().padStart(2,0)+"-"+e.date.getDate().toString().padStart(2,0))}(e)},children:e.dayNumberText})},editable:!0,eventTimeFormat:{hour:"numeric",minute:"2-digit",meridiem:!1},events:t,eventClick:function(e){return function(e){var t=Object(Qe.a)(n).find((function(t){return t.id_agenda===e}));t&&(o(t),i(Object(Te.a)(Object(Te.a)({},c),{},{editar:!0})))}(e.event.id)}})},Tc=function(){return Object(w.jsxs)(yc,{children:[Object(w.jsx)(Nc,{}),Object(w.jsx)(wc,{}),Object(w.jsx)(Fc,{})]})},Rc=a(383);var Mc=function(){var e=function(){var e=Object(H.f)().search;return i.a.useMemo((function(){return new URLSearchParams(e)}),[e])}().get("code")||"no-code",t=Object(c.useState)([0]),a=Object(r.a)(t,2),n=a[0],o=a[1],s=Object(Rc.a)({value:e,options:{background:"#fff",font:"monospace",height:50}}).inputRef;return Object(w.jsxs)(Z.a,{container:!0,spacing:2,justifyContent:"center",children:[Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(te.a,{variant:"h6",children:"C\xf3digo de barras"})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsxs)(we.a,{direction:{xs:"column",sm:"row"},spacing:{xs:1,sm:2,md:4},children:[Object(w.jsx)(ae.a,{variant:"outlined",size:"large",onClick:function(){Y()({type:"html",printable:"print_code"})},children:"Imprimir"}),Object(w.jsx)(ae.a,{variant:"outlined",size:"large",onClick:function(){var e=n.length+1,t=Object(Qe.a)(n);t.push(e),o(t)},children:"Agregar Copia"}),Object(w.jsx)(ae.a,{variant:"outlined",size:"large",onClick:function(){return Et.goto("productos")},children:"Productos"})]})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)("div",{id:"print_code",children:n.map((function(e){return Object(w.jsx)("canvas",{ref:s},e)}))})})]})},Lc=Object(c.createContext)(),Wc=function(){var e=Object(c.useContext)(Lc);return{openDialog:e.openDialog,setOpenDialog:e.setOpenDialog,cargas:e.cargas,lista:e.lista,setLista:e.setLista,enviarFormulario:e.enviarFormulario,dialogConfirmacion:e.dialogConfirmacion,setDialogConfirmacion:e.setDialogConfirmacion,enviarDeVerdad:e.enviarDeVerdad,password_confirm:e.password_confirm,setPassword_confirm:e.setPassword_confirm,mensajeError:e.mensajeError,setMensajeError:e.setMensajeError,formulario:e.formulario,setFormulario:e.setFormulario,initialForm:e.initialForm,borrarUser:e.borrarUser,openDialogFormEdit:e.openDialogFormEdit,setOpenDialogFormEdit:e.setOpenDialogFormEdit,openDialogPermisos:e.openDialogPermisos,setOpenDialogPermisos:e.setOpenDialogPermisos,changePassword:e.changePassword,dialogChangePassword:e.dialogChangePassword,setDialogChangePassword:e.setDialogChangePassword,openchangePassword:e.openchangePassword,idUserPermiso:e.idUserPermiso,setIdUserPermiso:e.setIdUserPermiso,nombreUserPermiso:e.nombreUserPermiso,setNombreUserPermiso:e.setNombreUserPermiso,listaPermisos:e.listaPermisos,setListaPermisos:e.setListaPermisos}},zc=function(e){var t=e.children,a=Object(c.useState)(!1),n=Object(r.a)(a,2),o=n[0],i=n[1],s=Object(c.useState)(null),u=Object(r.a)(s,2),j=u[0],b=u[1],p=Object(c.useState)(""),m=Object(r.a)(p,2),O=m[0],x=m[1],h=Object(c.useState)([]),f=Object(r.a)(h,2),g=f[0],_=f[1],v=Object(c.useState)(!1),C=Object(r.a)(v,2),S=C[0],F=C[1],P=Object(c.useState)(!1),A=Object(r.a)(P,2),D=A[0],E=A[1],N=Object(c.useState)(!1),T=Object(r.a)(N,2),R=T[0],M=T[1],L=Object(c.useState)(!1),W=Object(r.a)(L,2),z=W[0],q=W[1],U=Object(c.useState)(""),B=Object(r.a)(U,2),V=B[0],H=B[1],G=Object(c.useState)(""),J=Object(r.a)(G,2),Y=J[0],K=J[1],X=Object(c.useState)([]),Q=Object(r.a)(X,2),Z=Q[0],$=Q[1],ee=Object(c.useState)({listas:!0,guardar:!1}),te=Object(r.a)(ee,2),ae=te[0],re=te[1],ne=I(),oe=ne.token_user,ce=ne.id_user,ie=ne.username_user,se=ne.DescifrarTexto,le={id_user:"",nombre_user:"",username_user:"",password_user:"",email_user:"",rol_user:""},de=Object(c.useState)(le),ue=Object(r.a)(de,2),je=ue[0],be=ue[1],pe=function(){var e=Object(d.a)(l.a.mark((function e(t){var a,r,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.old,e.next=3,k.confirmPassword({username_user:se(ie),password_user:a});case 3:if("ok"!==(r=e.sent).response||1!==r.found){e.next=12;break}return n={password_user:t.new,id_user:ce},e.next=8,k.updatePassword(n);case 8:"ok"===e.sent.response&&(q(!1),y()({icon:"success",text:"Contrase\xf1a cambiada exitosamente, para mayor seguridad, cierre la sesi\xf3n e inicie nuevamente.",timer:6e3})),e.next=13;break;case 12:y()({text:"Contrase\xf1a incorrecta",timer:6e3,icon:"error"});case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),me=function(){var e=Object(d.a)(l.a.mark((function e(t){var a,r,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),a=je.username_user,r=je.email_user,""!==je.id_user){e.next=8;break}return e.next=5,k.get({table:"users",token:oe,where:"username_user,=,'".concat(a,"',or,email_user,=,'").concat(r,"'")});case 5:n=e.sent,e.next=11;break;case 8:return e.next=10,k.get({table:"users",token:oe,where:"(username_user,=,'".concat(a,"',or,email_user,=,'").concat(r,"'),and,id_user,!=,").concat(je.id_user)});case 10:n=e.sent;case 11:n.found<1?M(!0):y()({text:"Usuario o email est\xe1n ocupados, elija otros",timer:3e3,icon:"error"});case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Oe=function(){var e=Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.confirmPassword({username_user:se(ie),password_user:V});case 2:"ok"===(t=e.sent).response?""===je.id_user?fe():he():K(t.message);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),xe=function(){K(""),H(""),M(!1),E(!1),F(!1),be(le),ge()},he=function(){var e=Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return re(Object(Te.a)(Object(Te.a)({},ae),{},{guardar:!0})),delete je.password_user,e.next=4,k.update({table:"users",token:oe,data:je,id:je.id_user});case 4:"ok"===e.sent.response&&(y()({icon:"success",text:"Actualizado correctamente",timer:2e3}),xe(),E(!1)),re(Object(Te.a)(Object(Te.a)({},ae),{},{guardar:!1}));case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),fe=function(){var e=Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return re(Object(Te.a)(Object(Te.a)({},ae),{},{guardar:!0})),delete je.id_user,e.next=4,k.register({datos:je});case 4:"ok"===(t=e.sent).response?y()({icon:"success",text:"Agregado correctamente",timer:2e3}):console.log(t),re(Object(Te.a)(Object(Te.a)({},ae),{},{guardar:!1})),xe();case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ge=Object(c.useCallback)(Object(d.a)(l.a.mark((function e(){var t,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return re({listas:!0,guardar:!1}),e.next=3,Promise.all([k.get({table:"users",token:oe}),k.get({table:"permisos",sort:"-descripcion_permiso"})]);case 3:t=e.sent,$(t[0].results),(a=Object(Qe.a)(t[1].results)).forEach((function(e,t){a[t].checked=!1})),_(a),re({guardar:!1,listas:!1});case 9:case"end":return e.stop()}}),e)}))),[oe]);return Object(c.useEffect)((function(){var e=new AbortController,t=!0;return t&&ge(),function(){t=!1,e.abort()}}),[ge]),Object(w.jsx)(Lc.Provider,{value:{openDialog:S,setOpenDialog:F,cargas:ae,lista:Z,setLista:$,enviarFormulario:me,dialogConfirmacion:R,setDialogConfirmacion:M,enviarDeVerdad:Oe,password_confirm:V,setPassword_confirm:H,mensajeError:Y,setMensajeError:K,formulario:je,setFormulario:be,initialForm:le,borrarUser:function(e,t){e===ce?y()({icon:"error",title:"Que est\xe1s haciendo?",text:"No te puedes borrar a ti mismo",timer:1400}):y()({title:"Borrar",icon:"warning",text:"Borrar a ".concat(t),buttons:["Cancelar","Borrar"]}).then((function(t){t&&y()({title:"Confirmar contrase\xf1a",icon:"info",dangerMode:!0,buttons:["Cancelar","Confirmar"],content:{element:"input",attributes:{placeholder:"Debemos estar seguros de que no eres un farzante",type:"password"}}}).then(function(){var t=Object(d.a)(l.a.mark((function t(a){var r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!a){t.next=13;break}return t.next=3,k.confirmPassword({username_user:se(ie),password_user:a});case 3:if("ok"!==(r=t.sent).response){t.next=12;break}return re(Object(Te.a)(Object(Te.a)({},ae),{},{guardar:!0})),t.next=8,Promise.all([k.delete({table:"users",id:e,token:oe}),k.delete({table:"permisos_users",namecolumns:"id_user_permiso",ids:e,token:oe})]);case 8:"ok"===t.sent[1].response&&(y()({icon:"success",title:"Borrado correctamente",timer:1200}),ge()),t.next=13;break;case 12:y()({icon:"error",title:"Ha ocurrido un error",text:r.message});case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}))},table:"users",openDialogFormEdit:D,setOpenDialogFormEdit:E,openDialogPermisos:o,setOpenDialogPermisos:i,changePassword:pe,dialogChangePassword:z,setDialogChangePassword:q,openchangePassword:function(e){ce===e.id_user&&q(!0)},idUserPermiso:j,setIdUserPermiso:b,nombreUserPermiso:O,setNombreUserPermiso:x,listaPermisos:g,setListaPermisos:_},children:t})},qc=function(){var e=Wc(),t=e.setIdUserPermiso,a=e.setOpenDialog,n=e.cargas,o=e.openDialog,i=e.lista,s=e.borrarUser,l=e.setFormulario,d=e.setOpenDialogFormEdit,u=e.initialForm,j=e.setOpenDialogPermisos,b=e.setNombreUserPermiso,p=e.openchangePassword,m=Object(c.useState)(""),O=Object(r.a)(m,2),x=O[0],h=O[1],f=i.filter((function(e){return e.nombre_user.toLowerCase().includes(x.toLowerCase())})),g=Object(w.jsxs)(we.a,{spacing:2,direction:"row",children:[Object(w.jsx)(Fe.a,{InputProps:{endAdornment:Object(w.jsx)(Ie.a,{position:"end",children:Object(w.jsx)(Pe.a,{children:Object(w.jsx)(ee.a,{children:"search"})})})},onChange:function(e){return h(e.target.value)},variant:"outlined",label:"Buscar"}),Object(w.jsx)(ae.a,{color:"primary",variant:"outlined",size:"large",onClick:function(){a(!o),l(u)},children:"AGREGAR"})]});return Object(w.jsx)(ye,{nombretabla:"Usuarios",subtitle:"En el m\xf3dulo USUARIO podr\xe1 registrar nuevos usuarios en el sistema ya sea un administrador o un cajero, tambi\xe9n podr\xe1 ver la lista de usuarios registrados, buscar usuarios en el sistema, actualizar datos de otros usuarios y los suyos.",namecolumnID:"id_user",columnas:[{field:"id_user",title:"ID"},{field:"nombre_user",title:"Nombre"},{field:"username_user",title:"Username"},{field:"last_login_user",title:"Ult. Logueo"},{field:"rol_user",title:"Rol",items:{1:"Administrador",2:"Gerente",3:"Caja",4:"Vendedor",5:"Entrega"},comparaItem:"rol_user"}],filas:f,icono:"person",bgicono:"#303f9f",Acciones:function(e){var a=e.id,r=e.extraprops,n=e.filaProps;return Object(w.jsxs)(we.a,{spacing:1,direction:"row",children:[Object(w.jsx)(De.a,{size:"small",color:"success",variant:"round",onClick:function(){j(!0),t(a),b(r)},children:Object(w.jsx)(ee.a,{children:"manage_accounts"})}),Object(w.jsx)(De.a,{size:"small",onClick:function(){p(n)},children:Object(w.jsx)(ee.a,{children:"key"})}),Object(w.jsx)(De.a,{size:"small",color:"primary",variant:"round",onClick:function(){!function(e){var t=Object(Qe.a)(i),a=t.findIndex((function(t){return t.id_user===e}));t[a].password_user="",l(t[a]),d(!0)}(a)},children:Object(w.jsx)(ee.a,{children:"edit"})}),Object(w.jsx)(De.a,{size:"small",color:"secondary",variant:"round",onClick:function(){s(a,r)},children:Object(w.jsx)(ee.a,{children:"delete"})})]})},extraprops:"nombre_user",search:g,cargando:n.listas,showOptions:!0})},Uc=function(){var e=Object(c.useState)("password"),t=Object(r.a)(e,2),a=t[0],n=t[1],o=Wc(),i=o.openDialog,s=o.enviarFormulario,l=o.setOpenDialog,d=o.formulario,u=o.setFormulario,j=o.cargas,b=Object(c.useCallback)((function(){n("text"===a?"password":"text")}),[a]),p=function(){l(!1)},m=function(e){var t=e.target,a=t.name,r=t.value;u(Object(Te.a)(Object(Te.a)({},d),{},Object(G.a)({},a,r)))};return Object(w.jsx)("form",{onSubmit:s,children:Object(w.jsxs)(ze.a,{open:i,fullWidth:!0,onClose:function(){return p()},children:[Object(w.jsx)(qe.a,{children:"Agregar"}),Object(w.jsx)(Ue.a,{dividers:!0,children:Object(w.jsxs)(Z.a,{container:!0,spacing:2,children:[Object(w.jsx)(Z.a,{item:!0,xs:12,children:j.guardar&&Object(w.jsx)(Be.a,{})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:6,children:Object(w.jsx)(Fe.a,{autoFocus:!0,required:!0,label:"Nombre completo",autoComplete:"off",name:"nombre_user",onChange:m,value:d.nombre_user,InputProps:{startAdornment:Object(w.jsx)(Ie.a,{position:"start",children:Object(w.jsx)(ee.a,{color:"disabled",children:"account_circle"})})},fullWidth:!0,variant:"outlined",error:!1,helperText:"Nombre del usuario"})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:6,children:Object(w.jsx)(Fe.a,{label:"Login de usuario",autoComplete:"off",name:"username_user",required:!0,InputProps:{startAdornment:Object(w.jsx)(Ie.a,{position:"start",children:Object(w.jsx)(ee.a,{color:"disabled",children:"person"})})},onChange:m,value:d.username_user,fullWidth:!0,variant:"outlined",helperText:"Username con el que se loguea"})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsxs)(rt.a,{children:[Object(w.jsx)(He.a,{children:"Rol de usuario"}),Object(w.jsxs)(Ge.a,{value:d.rol_user,variant:"outlined",label:"Rol de usuario",fullWidth:!0,name:"rol_user",onChange:m,children:[Object(w.jsx)(Je.a,{value:"",disabled:!0,children:"Seleccione un rol"}),Object(w.jsx)(Je.a,{value:1,children:"Administrador"}),Object(w.jsx)(Je.a,{value:2,children:"Gerente"}),Object(w.jsx)(Je.a,{value:3,children:"Cajero"}),Object(w.jsx)(Je.a,{value:4,children:"Vendedor"}),Object(w.jsx)(Je.a,{value:5,children:"Entrega"})]})]})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(Fe.a,{name:"email_user",autoComplete:"off",onChange:m,value:d.email_user,required:!0,InputProps:{startAdornment:Object(w.jsx)(Ie.a,{position:"start",children:Object(w.jsx)(ee.a,{color:"disabled",children:"email"})})},label:"Correo Electr\xf3nico",type:"email",fullWidth:!0,variant:"outlined"})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(Fe.a,{name:"password_user",onChange:m,required:!0,value:d.password_user,InputProps:{endAdornment:Object(w.jsx)(Ie.a,{position:"end",children:Object(w.jsx)(Pe.a,{onClick:b,children:Object(w.jsx)(ee.a,{children:"visibility"})})}),startAdornment:Object(w.jsx)(Ie.a,{position:"start",children:Object(w.jsx)(ee.a,{color:"disabled",children:"vpn_key"})})},label:"Contrase\xf1a",type:a,fullWidth:!0,variant:"outlined"})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(de.a,{severity:"info",children:"Recuerde elegir una contrase\xf1a segura. No ponga 123, fecha de nacimiento, o nombre de perro, nah ! mentira, puede poner la contrase\xf1a que le guste y crea que sea segura."})})]})}),Object(w.jsxs)(Ye.a,{children:[Object(w.jsx)(ae.a,{onClick:s,color:"primary",variant:"outlined",children:"Agregar"}),Object(w.jsx)(ae.a,{onClick:function(){return p()},variant:"outlined",color:"error",children:"Cancelar"})]})]})})},Bc=Object(z.a)((function(e){return{textfield:{margin:e.spacing(3,0)}}})),Vc=function(){var e=Wc(),t=e.dialogConfirmacion,a=e.setDialogConfirmacion,r=e.enviarDeVerdad,n=e.setPassword_confirm,o=e.password_confirm,i=e.mensajeError,s=Bc(),l=Object(c.useRef)(null);return Object(w.jsx)(w.Fragment,{children:Object(w.jsxs)(ze.a,{open:t,onClose:function(){return a(!1)},fullWidth:!0,children:[Object(w.jsxs)(Ue.a,{children:[""!==i&&Object(w.jsx)(de.a,{severity:"error",children:Object(w.jsx)(Ar.a,{children:i})}),Object(w.jsx)(Fe.a,{type:"password",className:s.textfield,fullWidth:!0,inputRef:l,label:"Confirmar contrase\xf1a",value:o,onChange:function(e){return n(e.target.value)},onKeyPress:function(e){"Enter"===e.code&&r()},autoFocus:!0,autoComplete:"off",variant:"outlined"})]}),Object(w.jsxs)(Ye.a,{children:[Object(w.jsx)(ae.a,{variant:"outlined",color:"primary",onClick:r,children:"Confirmar"}),Object(w.jsx)(ae.a,{variant:"outlined",color:"secondary",onClick:function(){return a(!1)},children:"Cancelar"})]})]})})},Hc=function(){var e=Wc(),t=e.openDialogFormEdit,a=e.setOpenDialogFormEdit,n=e.formulario,o=e.setFormulario,i=e.enviarFormulario,s=e.id_user,l=Object(c.useState)("password"),d=Object(r.a)(l,2),u=d[0],j=d[1],b=Object(c.useCallback)((function(){j("text"===u?"password":"text")}),[u]),p=function(e){var t=e.target,a=t.name,r=t.value;o(Object(Te.a)(Object(Te.a)({},n),{},Object(G.a)({},a,r)))},m=function(){a(!1)};return Object(w.jsx)(ze.a,{fullWidth:!0,open:t,onClose:m,children:Object(w.jsxs)("form",{onSubmit:i,children:[Object(w.jsx)(qe.a,{children:"Editar usuario"}),Object(w.jsx)(Ue.a,{dividers:!0,children:Object(w.jsxs)(Z.a,{container:!0,spacing:2,children:[Object(w.jsx)(Z.a,{item:!0,xs:12,sm:6,children:Object(w.jsx)(Fe.a,{autoFocus:!0,required:!0,label:"Nombre completo",autoComplete:"off",name:"nombre_user",onChange:p,value:n.nombre_user,InputProps:{startAdornment:Object(w.jsx)(Ie.a,{position:"start",children:Object(w.jsx)(ee.a,{color:"disabled",children:"account_circle"})})},fullWidth:!0,variant:"outlined",error:!1,helperText:"Nombre del usuario"})}),Object(w.jsx)(Z.a,{item:!0,xs:12,sm:6,children:Object(w.jsx)(Fe.a,{label:"Login de usuario",autoComplete:"off",name:"username_user",required:!0,InputProps:{startAdornment:Object(w.jsx)(Ie.a,{position:"start",children:Object(w.jsx)(ee.a,{color:"disabled",children:"person"})})},onChange:p,value:n.username_user,fullWidth:!0,variant:"outlined",helperText:"Username con el que se loguea"})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsxs)(rt.a,{children:[Object(w.jsx)(He.a,{children:"Rol de usuario"}),Object(w.jsxs)(Ge.a,{value:n.rol_user,variant:"outlined",label:"Rol de usuario",fullWidth:!0,name:"rol_user",onChange:p,children:[Object(w.jsx)(Je.a,{value:1,children:"Administrador"}),Object(w.jsx)(Je.a,{value:2,children:"Gerente"}),Object(w.jsx)(Je.a,{value:3,children:"Cajero"}),Object(w.jsx)(Je.a,{value:4,children:"Vendedor"}),Object(w.jsx)(Je.a,{value:5,children:"Entrega"})]})]})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(Fe.a,{name:"email_user",autoComplete:"off",onChange:p,value:n.email_user,required:!0,InputProps:{startAdornment:Object(w.jsx)(Ie.a,{position:"start",children:Object(w.jsx)(ee.a,{color:"disabled",children:"email"})})},label:"Correo Electr\xf3nico",type:"email",fullWidth:!0,variant:"outlined"})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:n.id_user===s&&Object(w.jsx)(Fe.a,{name:"password_user",onChange:p,required:!0,value:n.password_user,InputProps:{endAdornment:Object(w.jsx)(Ie.a,{position:"end",children:Object(w.jsx)(Pe.a,{onClick:b,children:Object(w.jsx)(ee.a,{children:"visibility"})})}),startAdornment:Object(w.jsx)(Ie.a,{position:"start",children:Object(w.jsx)(ee.a,{color:"disabled",children:"vpn_key"})})},label:"Contrase\xf1a",type:u,fullWidth:!0,variant:"outlined"})})]})}),Object(w.jsxs)(Ye.a,{children:[Object(w.jsx)(ae.a,{type:"submit",color:"primary",variant:"outlined",children:"Editar"}),Object(w.jsx)(ae.a,{onClick:function(){m()},variant:"outlined",color:"secondary",children:"Cancelar"})]})]})})},Gc=function(){var e=Wc(),t=e.openDialogPermisos,a=e.setOpenDialogPermisos,n=e.nombreUserPermiso,o=e.setNombreUserPermiso,i=e.setIdUserPermiso,s=e.idUserPermiso,u=e.listaPermisos,j=I().token_user,b=Object(c.useState)([]),p=Object(r.a)(b,2),m=p[0],O=p[1],x=Object(c.useState)(!0),h=Object(r.a)(x,2),f=h[0],g=h[1],_=function(){a(!1),i(null),o("")},v=function(){var e=Object(d.a)(l.a.mark((function e(t,a,r){var n,o,c,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(g(!0),(n=Object(Qe.a)(m))[r].checked=!t,O(n),!1!==t){e.next=12;break}return o={id_user_permiso:s,id_permiso_permiso:a},e.next=8,k.insert({table:"permisos_users",data:o,token:j});case 8:"ok"!==(c=e.sent).response&&console.log(c),e.next=16;break;case 12:return e.next=14,k.delete({token:j,table:"permisos_users",namecolumns:"id_user_permiso,id_permiso_permiso",ids:"".concat(s,",").concat(a)});case 14:"ok"!==(i=e.sent).response&&console.log(i);case 16:g(!1);case 17:case"end":return e.stop()}}),e)})));return function(t,a,r){return e.apply(this,arguments)}}(),C=Object(c.useCallback)(Object(d.a)(l.a.mark((function e(){var t,a,r,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===s){e.next=7;break}return g(!0),e.next=4,k.get({table:"permisos_users",where:"id_user_permiso,=,".concat(s)});case 4:"ok"===(t=e.sent).response?(a=t.results,r=Object(Qe.a)(u),n=[],r.forEach((function(e){var t=a.findIndex((function(t){return t.id_permiso_permiso===e.id_permiso}));n.push(Object(Te.a)(Object(Te.a)({},r),{},{id_permiso:e.id_permiso,checked:!(t<0),clave_permiso:e.clave_permiso,descripcion_permiso:e.descripcion_permiso}))})),O(n)):console.log(t),g(!1);case 7:case"end":return e.stop()}}),e)}))),[s,u]);return Object(c.useEffect)((function(){var e=new AbortController,t=!0;return t&&C(),function(){t=!1,e.abort()}}),[C]),Object(w.jsxs)(ze.a,{open:t,onClose:_,fullWidth:!0,children:[Object(w.jsxs)(qe.a,{children:["Permisos para: ",n]}),Object(w.jsxs)(Ue.a,{dividers:!0,children:[f&&Object(w.jsx)(Be.a,{}),Object(w.jsx)(Ut.a,{children:m.map((function(e,t){return Object(w.jsx)(Bt.a,{children:Object(w.jsx)(ot.a,{control:Object(w.jsx)(za.a,{checkedIcon:Object(w.jsx)(ee.a,{color:"success",sx:{fontSize:33},children:"toggle_on"}),icon:Object(w.jsx)(ee.a,{children:"toggle_off"}),color:"primary",name:e.clave_permiso,onChange:function(){v(e.checked,e.id_permiso,t)},checked:e.checked}),label:e.descripcion_permiso})},e.id_permiso)}))})]}),Object(w.jsx)(Ye.a,{children:Object(w.jsx)(ae.a,{variant:"outlined",onClick:_,children:"Cerrar"})})]})},Jc=function(){var e=Wc(),t=e.dialogChangePassword,a=e.setDialogChangePassword,n=e.changePassword,o=Object(c.useState)({old:"",new:""}),i=Object(r.a)(o,2),s=i[0],l=i[1],d=function(e){var t=e.target,a=t.name,r=t.value;l(Object(Te.a)(Object(Te.a)({},s),{},Object(G.a)({},a,r)))},u=function(){a(!1)};return Object(w.jsxs)(ze.a,{open:t,onClose:u,fullWidth:!0,children:[Object(w.jsx)(qe.a,{children:"Cambiar contrase\xf1a"}),Object(w.jsx)(Ue.a,{dividers:!0,children:Object(w.jsxs)(Z.a,{container:!0,spacing:2,children:[Object(w.jsx)(Z.a,{item:!0,xs:12}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(Fe.a,{type:"password",autoFocus:!0,fullWidth:!0,onChange:d,value:s.old,name:"old",label:"Contrase\xf1a antigua"})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(Fe.a,{type:"password",fullWidth:!0,onChange:d,value:s.new,name:"new",label:"Contrase\xf1a nueva"})})]})}),Object(w.jsxs)(Ye.a,{children:[Object(w.jsx)(ae.a,{variant:"outlined",onClick:function(){n(s)},children:"Cambiar"}),Object(w.jsx)(ae.a,{variant:"outlined",onClick:u,children:"Cerrar"})]})]})},Yc=function(){return Object(w.jsxs)(zc,{children:[Object(w.jsx)(qc,{}),Object(w.jsx)(Vc,{}),Object(w.jsx)(Uc,{}),Object(w.jsx)(Gc,{}),Object(w.jsx)(Hc,{}),Object(w.jsx)(Jc,{})]})},Kc=Object(z.a)((function(e){return{centerDiv:{minHeight:"calc(100vh - 20px)",justifyContent:"center",alignItems:"center",display:"flex",flexDirection:"column",margin:"5px 10px"},formulario:{padding:20,margin:"5px auto",border:"1px solid whitesmoke",borderRadius:10},icon:{fontSize:80,marginTop:e.spacing(-8)}}}));function Xc(){var e=I(),t=e.Loguearse,a=e.logueado,n=e.mensajeAlerta,o=e.cargandoMensaje,i=e.cargando,s=e.recordar,l=e.setRecordar,d=Object(c.useState)((function(){return{username_user:"",password_user:""}})),u=Object(r.a)(d,2),j=u[0],b=u[1],p=Object(c.useRef)(null),m=Object(c.useState)("password"),x=Object(r.a)(m,2),h=x[0],f=x[1],g=function(e){var t=e.target,a=t.name,r=t.value;b(Object(Te.a)(Object(Te.a)({},j),{},Object(G.a)({},a,r)))},_=Kc();return i?Object(w.jsx)(V,{}):a?Object(w.jsx)(H.a,{to:"/dashboard"}):Object(w.jsx)(Ee.a.div,{initial:{opacity:0,y:"-50px"},animate:{opacity:1,y:0},transition:{duration:.4},className:_.centerDiv,children:Object(w.jsx)(st.a,{maxWidth:"xs",children:Object(w.jsxs)(re.a,{boxShadow:3,className:_.formulario,children:[Object(w.jsx)(we.a,{justifyContent:"center",alignItems:"center",children:Object(w.jsx)(ee.a,{className:_.icon,children:O})}),Object(w.jsx)("form",{onSubmit:function(e){e.preventDefault(),t(j)},children:Object(w.jsxs)(Z.a,{container:!0,spacing:3,justifyContent:"center",alignItems:"center",children:[Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)("h2",{style:{textAlign:"center"},children:"Ingresar"})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:n&&Object(w.jsxs)(de.a,{severity:"error",icon:!1,variant:"outlined",children:[" ",n]})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(Fe.a,{value:j.username_user,onChange:g,required:!0,autoComplete:"off",id:"username_user",name:"username_user",autoFocus:!0,label:"Usuario",fullWidth:!0,InputProps:{startAdornment:Object(w.jsx)(Ie.a,{position:"start",children:Object(w.jsx)(ee.a,{color:"disabled",children:"perm_identity"})})}})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(Fe.a,{inputRef:p,value:j.password_user,onChange:g,required:!0,id:"password_user",name:"password_user",label:"Contrase\xf1a",fullWidth:!0,type:h,InputProps:{startAdornment:Object(w.jsx)(Ie.a,{position:"start",children:Object(w.jsx)(ee.a,{color:"disabled",children:"lock"})}),endAdornment:Object(w.jsx)(Ie.a,{position:"end",children:Object(w.jsx)(Pe.a,{onClick:function(){f("text"===h?"password":"text"),p.current.focus()},children:Object(w.jsx)(ee.a,{children:"text"===h?"visibility_off":"visibility"})})})}})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(ot.a,{control:Object(w.jsx)(za.a,{checked:s,onChange:function(e){return l(e.target.checked)}}),label:"Recordarme"})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(Dt,{type:"submit",variant:"contained",color:"primary",disabled:o,fullWidth:!0,startIcon:Object(w.jsx)(ee.a,{children:o?"rotate_left":"login"}),children:o?"Cargando...":"Ingresar"})})]})})]})})})}var Qc=function(){return Object(w.jsx)(Xc,{})},Zc=Object(c.createContext)(),$c=function(e){var t=e.children,a=Object(c.useState)([]),n=Object(r.a)(a,2),o=n[0],i=n[1],s=Object(c.useState)(!0),u=Object(r.a)(s,2),j=u[0],b=u[1],p=Object(c.useCallback)(Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return b(!0),e.next=3,k.get({table:"notas_pedidos",include:"clientes",on:"id_cliente,id_cliente_pedido"});case 3:"ok"===(t=e.sent).response?i(t.results):console.log(t),b(!1);case 6:case"end":return e.stop()}}),e)}))),[]);return Object(c.useEffect)((function(){var e=new AbortController,t=!0;return t&&p(),function(){t=!1,e.abort()}}),[p]),Object(w.jsx)(Zc.Provider,{value:{lista:o,cargas:j},children:t})},ei=function(){var e=function(){var e=Object(c.useContext)(Zc);return{lista:e.lista,cargas:e.cargas}}(),t=e.lista,a=e.cargas;return Object(w.jsx)(ga,{nombretabla:"Notas de pedido",columnas:[{field:"id_notas_pedido",title:"NRO",style:{fontWeight:"bold"}},{field:"ruc_cliente",title:"Doc.",style:{fontWeight:"bold"}},{field:"nombre_cliente",title:"CLIENTE",style:{fontWeight:"bold"}},{field:"fecha_pedido",title:"Fecha y hora",style:{fontWeight:"bold"}}],filas:t,icono:"receipt",bgicono:"#303f9f",Acciones:function(e){e.filaProps;return Object(w.jsxs)(we.a,{direction:"row",justifyContent:"center",spacing:2,children:[Object(w.jsx)(ae.a,{variant:"outlined",children:"Procesar nota"}),Object(w.jsx)(ae.a,{variant:"outlined",children:"Ver detalles"})]})},cargando:a,showOptions:!0})},ti=function(){return Object(w.jsx)($c,{children:Object(w.jsx)(ei,{})})},ai=function(e){return v.a.AES.decrypt(e,g).toString(v.a.enc.Utf8)},ri={get:function(){var e=Object(d.a)(l.a.mark((function e(t){var a,r,n,o,c,i,s,d,u,b,p,m,O,h,g,_,v,C,k,S,y,w,F,I;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.table,r=t.sort,n=void 0===r?"":r,o=t.pagenumber,c=void 0===o?"":o,i=t.pagesize,s=void 0===i?"":i,d=t.fields,u=void 0===d?"":d,b=t.where,p=void 0===b?"":b,m=t.include,O=void 0===m?"":m,h=t.on,g=void 0===h?"":h,_=t.token,v=void 0===_?"":_,C=t.filtersSearch,k=void 0===C?"":C,S=t.filtersField,y=void 0===S?"":S,e.prev=1,w=ai(v),F="".concat(x).concat(a,"?where=").concat(p,"&sort=").concat(n,"&page[number]=").concat(c,"&page[size]=").concat(s,"&fields=").concat(u,"&include=").concat(O,"&on=").concat(g,"&token=").concat(w,"&filters[search]=").concat(k,"&filters[field]=").concat(y),e.next=6,fetch(F,{headers:{"X-Api-Token":f}});case 6:return I=e.sent,e.next=9,I.json();case 9:return e.abrupt("return",e.sent);case 12:return e.prev=12,e.t0=e.catch(1),j.a.isCancel(e.t0)&&console.log("Request canceled",e.t0),e.abrupt("return",{response:"Error",message:e.t0});case 16:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t){return e.apply(this,arguments)}}(),getPromise:function(e){var t=e.table,a=e.sort,r=void 0===a?"":a,n=e.pagenumber,o=void 0===n?"":n,c=e.pagesize,i=void 0===c?"":c,s=e.fields,l=void 0===s?"":s,d=e.where,u=void 0===d?"":d,j=e.include,b=void 0===j?"":j,p=e.on,m=void 0===p?"":p,O=e.token,h=void 0===O?"":O,g=e.filtersSearch,_=void 0===g?"":g,v=e.filtersField,C=void 0===v?"":v;return new Promise((function(e,a){try{var n=ai(h),c="".concat(x).concat(t,"?where=").concat(u,"&sort=").concat(r,"&page[number]=").concat(o,"&page[size]=").concat(i,"&fields=").concat(l,"&include=").concat(b,"&on=").concat(m,"&token=").concat(n,"&filters[search]=").concat(_,"&filters[field]=").concat(C);fetch(c,{headers:{"X-Api-Token":f}}).then((function(e){return e.json()})).then((function(t){return e(t)}))}catch(s){a(s)}}))},deleteImage:function(){var e=Object(d.a)(l.a.mark((function e(t){var a,r,n,o,c,i,s,d;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.table,r=t.path,n=t.idImage,o=t.token,e.prev=1,c=ai(o),i="".concat(x).concat(a,"/").concat(r,"/?accion=deleteImage&token=").concat(c,"&idImage=").concat(n),e.next=6,j()({url:i,method:"DELETE",headers:{"X-Api-Token":f}});case 6:return s=e.sent,e.next=9,s.data;case 9:return e.abrupt("return",e.sent);case 12:return e.prev=12,e.t0=e.catch(1),d=[{results:"error",response:"error",message:e.t0}],e.abrupt("return",d);case 16:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t){return e.apply(this,arguments)}}(),uploadImage:function(){var e=Object(d.a)(l.a.mark((function e(t){var a,r,n,o,c,i,s,d,u,b,p;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.file,r=t.token,n=t.table,o=void 0===n?"":n,c=t.data,i=t.path,s=void 0===i?Date.now():i,(d=new FormData).append("table",o),d.append("path",s),d.append("data",JSON.stringify(c)),d.append("image",a),e.prev=6,u=ai(r),e.next=10,j()({url:"".concat(x,"Upload/?token=").concat(u),method:"POST",data:d,headers:{"Content-Type":"multipart/form-data","X-Api-Token":f}});case 10:return b=e.sent,e.next=13,b.data;case 13:return e.abrupt("return",e.sent);case 16:return e.prev=16,e.t0=e.catch(6),p=[{results:"error",response:"error"}],e.abrupt("return",p);case 20:case"end":return e.stop()}}),e,null,[[6,16]])})));return function(t){return e.apply(this,arguments)}}(),login:function(){var e=Object(d.a)(l.a.mark((function e(t){var a,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,j()({url:"".concat(x,"Auth/Login"),method:"POST",data:JSON.stringify(t),headers:{"X-Api-Token":f}});case 3:return a=e.sent,e.next=6,a.data;case 6:return e.abrupt("return",e.sent);case 9:return e.prev=9,e.t0=e.catch(0),console.log(e.t0),r=[{results:"error",response:"error",message:e.t0}],e.abrupt("return",r);case 14:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),validateToken:function(){var e=Object(d.a)(l.a.mark((function e(t){var a,r,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=ai(t),e.next=4,j()({url:"".concat(x,"Auth/ValidateToken"),method:"POST",data:JSON.stringify({token:a}),headers:{"X-Api-Token":f}});case 4:return r=e.sent,e.next=7,r.data;case 7:return e.abrupt("return",e.sent);case 10:return e.prev=10,e.t0=e.catch(0),n=[{results:"error",response:"error",message:e.t0}],e.abrupt("return",n);case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}(),confirmPassword:function(){var e=Object(d.a)(l.a.mark((function e(t){var a,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,j()({url:"".concat(x,"Auth/ConfirmPassword"),method:"POST",data:JSON.stringify(t),headers:{"X-Api-Token":f}});case 3:return a=e.sent,e.next=6,a.data;case 6:return e.abrupt("return",e.sent);case 9:return e.prev=9,e.t0=e.catch(0),r=[{results:"error",response:"error",message:e.t0}],e.abrupt("return",r);case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),register:function(){var e=Object(d.a)(l.a.mark((function e(t){var a,r,n,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.datos,e.prev=1,r="".concat(x,"Auth/Register"),e.next=5,j()({url:r,method:"POST",data:JSON.stringify(a),headers:{"X-Api-Token":f}});case 5:return n=e.sent,e.next=8,n.data;case 8:return e.abrupt("return",e.sent);case 11:return e.prev=11,e.t0=e.catch(1),o=[{results:"error",response:"error",message:e.t0}],e.abrupt("return",o);case 15:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t){return e.apply(this,arguments)}}(),insert:function(){var e=Object(d.a)(l.a.mark((function e(t){var a,r,n,o,c,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.table,r=t.data,n=t.token,e.prev=1,o=ai(n),e.next=5,j()({url:"".concat(x).concat(a,"/?token=").concat(o),method:"POST",data:JSON.stringify(r),headers:{"X-Api-Token":f}});case 5:return c=e.sent,e.next=8,c.data;case 8:return e.abrupt("return",e.sent);case 11:return e.prev=11,e.t0=e.catch(1),i=[{results:"error",response:"error"}],e.abrupt("return",i);case 15:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t){return e.apply(this,arguments)}}(),update:function(){var e=Object(d.a)(l.a.mark((function e(t){var a,r,n,o,c,i,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.table,r=t.data,n=t.id,o=t.token,e.prev=1,c=ai(o),e.next=5,j()({url:"".concat(x).concat(a,"/").concat(n,"/?token=").concat(c),method:"PUT",data:JSON.stringify(r),headers:{"X-Api-Token":f}});case 5:return i=e.sent,e.next=8,i.data;case 8:return e.abrupt("return",e.sent);case 11:return e.prev=11,e.t0=e.catch(1),s=[{results:"error",response:"error",message:e.t0}],e.abrupt("return",s);case 15:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t){return e.apply(this,arguments)}}(),delete:function(){var e=Object(d.a)(l.a.mark((function e(t){var a,r,n,o,c,i,s,d,u,b,p,m,O;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.table,r=t.id,n=void 0===r?"":r,o=t.token,c=t.namecolumns,i=void 0===c?"":c,s=t.ids,d=void 0===s?"":s,e.prev=1,u=ai(o),b=""!==n?n+"/":"",p="".concat(x).concat(a,"/").concat(b,"?token=").concat(u,"&namecolumns=").concat(i,"&ids=").concat(d),e.next=7,j()({url:p,method:"DELETE",headers:{"X-Api-Token":f}});case 7:return m=e.sent,e.next=10,m.data;case 10:return e.abrupt("return",e.sent);case 13:return e.prev=13,e.t0=e.catch(1),O=[{results:"error",response:"error",message:e.t0}],e.abrupt("return",O);case 17:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(t){return e.apply(this,arguments)}}()},ni=Object(c.createContext)();function oi(){var e=Object(c.useContext)(ni);return{cargas:e.cargas,idDepositoSelect:e.idDepositoSelect,setIdDepositoSelect:e.setIdDepositoSelect,cant:e.cant,setCant:e.setCant,error:e.error,idDeposito:e.idDeposito,setIdDeposito:e.setIdDeposito,transferir:e.transferir,listaDepositos:e.listaDepositos,dialogs:e.dialogs,setDialogs:e.setDialogs,formulario:e.formulario,setFormulario:e.setFormulario}}var ci=function(e){var t=e.children,a=I().token_user,n=Object(c.useState)({lista:!0,transferencia:!1}),o=Object(r.a)(n,2),i=o[0],s=o[1],u=Object(c.useState)({active:!1,msj:"",id:""}),j=Object(r.a)(u,2),b=j[0],p=j[1],m=Object(c.useState)({transferir:!1}),O=Object(r.a)(m,2),x=O[0],h=O[1],f=Object(c.useState)([]),g=Object(r.a)(f,2),_=g[0],v=g[1],C=Object(c.useState)(0),k=Object(r.a)(C,2),S=k[0],F=k[1],P=Object(c.useState)(""),A=Object(r.a)(P,2),D=A[0],E=A[1],N=Object(c.useState)(""),T=Object(r.a)(N,2),R=T[0],M=T[1],L=Object(c.useState)({id_producto:"",codigo_producto:"",nombre_producto:"",stock:[]}),W=Object(r.a)(L,2),z=W[0],q=W[1],U=Object(c.useCallback)(Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s({lista:!0,transferencia:!1}),e.next=3,ri.get({table:"depositos",where:"tipo_deposito,=,1"});case 3:"ok"===(t=e.sent).response?v(t.results):console.log(t);case 5:case"end":return e.stop()}}),e)}))),[]),B=function(){var e=Object(d.a)(l.a.mark((function e(){var t,r,n,o,c,i,d,u,j,b,m,O,f;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==D){e.next=3;break}return p({active:!0,msj:"Seleccione dep\xf3sito.",id:"deposito"}),e.abrupt("return",!1);case 3:if(t=z.stock.findIndex((function(e){return e.id_deposito_deposito===R})),r=parseFloat(z.stock[t].stock_producto_deposito),n=parseFloat(S),o=z.id_producto,c=z.stock[t].id_productos_deposito,!(r<n)){e.next=11;break}return p({active:!0,msj:"No hay suficiente stock.",id:"cantidad"}),e.abrupt("return",!1);case 11:return i=r-n,s({lista:!1,transferencia:!0}),d={stock_producto_deposito:i},e.next=16,Promise.all([ri.update({table:"productos_depositos",id:c,data:d,token:a}),ri.get({table:"productos_depositos",where:"id_producto_deposito,=,".concat(o,",and,id_deposito_deposito,=,").concat(D)})]);case 16:if("ok"!==(u=e.sent)[1].response){e.next=34;break}if(!(u[1].found>0)){e.next=27;break}return j=u[1].results[0].id_productos_deposito,b=n+parseFloat(u[1].results[0].stock_producto_deposito),e.next=23,ri.update({table:"productos_depositos",id:j,data:{stock_producto_deposito:b},token:a});case 23:"ok"!==(m=e.sent).response&&console.log(m),e.next=32;break;case 27:return O={stock_producto_deposito:n,id_producto_deposito:o,id_deposito_deposito:D},e.next=30,ri.insert({table:"productos_depositos",data:O,token:a});case 30:"ok"!==(f=e.sent).response&&console.log(f);case 32:e.next=35;break;case 34:console.log(u);case 35:p({active:!1,msj:"",id:""}),h(Object(Te.a)(Object(Te.a)({},x),{},{transferir:!1})),s({lista:!1,transferencia:!1}),q({id_producto:"",codigo_producto:"",nombre_producto:"",stock:[]}),y()({text:"Transferido correctamente",icon:"success",timer:1200});case 40:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(c.useEffect)((function(){var e=!0,t=new AbortController;return e&&U(),function(){e=!1,t.abort()}}),[U]),Object(w.jsx)(ni.Provider,{value:{cargas:i,idDepositoSelect:R,setIdDepositoSelect:M,cant:S,setCant:F,error:b,idDeposito:D,setIdDeposito:E,transferir:B,listaDepositos:_,dialogs:x,setDialogs:h,formulario:z,setFormulario:q},children:t})},ii=function(){var e=oi(),t=e.dialogs,a=e.setDialogs,r=e.listaDepositos,n=e.formulario,o=e.idDeposito,c=e.setIdDeposito,i=e.transferir,s=e.error,l=e.setCant,d=e.cant,u=e.idDepositoSelect,j=e.cargas,b=function(){a(Object(Te.a)(Object(Te.a)({},t),{},{transferir:!1})),l(0),c("")},p=r.filter((function(e){return e.id_deposito!==u}));return Object(w.jsxs)(ze.a,{open:t.transferir,onClose:b,fullWidth:!0,children:[Object(w.jsxs)(qe.a,{children:["Transferir ",n.nombre_producto]}),Object(w.jsx)(Ue.a,{dividers:!0,children:Object(w.jsxs)(Z.a,{container:!0,spacing:2,children:[Object(w.jsx)(Z.a,{item:!0,xs:12,children:j.transferencia&&Object(w.jsx)(Be.a,{})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:s.active&&Object(w.jsx)(de.a,{icon:!1,severity:"error",children:s.msj})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(Fe.a,{InputProps:{inputComponent:Va},autoFocus:!0,onChange:function(e){l(e.target.value)},value:d,label:"Cantidad",fullWidth:!0})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsxs)(Ve.a,{fullWidth:!0,children:[Object(w.jsx)(He.a,{variant:"outlined",children:"Dep\xf3sito"}),Object(w.jsxs)(Ge.a,{required:!0,error:"deposito"===s.id,name:"id_deposito",value:o,onChange:function(e){c(e.target.value)},variant:"outlined",children:[Object(w.jsx)(Je.a,{disabled:!0,value:"",children:"Seleccione dep\xf3sito"}),p.map((function(e){return Object(w.jsx)(Je.a,{value:e.id_deposito,children:e.nombre_deposito},e.id_deposito)}))]})]})})]})}),Object(w.jsxs)(Ye.a,{children:[Object(w.jsx)(ae.a,{variant:"outlined",onClick:i,children:"Tranferir"}),Object(w.jsx)(ae.a,{variant:"outlined",onClick:b,children:"Cerrar"})]})]})},si=function(){var e=Object(c.useState)(!1),t=Object(r.a)(e,2),a=t[0],n=t[1],o=Object(c.useState)([]),i=Object(r.a)(o,2),s=i[0],u=i[1],j=Object(c.useState)(""),b=Object(r.a)(j,2),p=b[0],m=b[1],O=Object(c.useRef)(null),x=oi(),h=x.formulario,f=x.setFormulario,g=x.setDialogs,_=x.dialogs,v=x.setIdDepositoSelect,C=function(){var e=Object(d.a)(l.a.mark((function e(t){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=t.target.value,m(a),n(!0),""===a?(u([]),n(!1)):setTimeout(Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ri.get({table:"productos",filtersField:"nombre_producto,codigo_producto",filtersSearch:a,pagesize:"20",fields:"nombre_producto,codigo_producto,id_producto"});case 2:"ok"===(t=e.sent).response?u(t.results):console.log(t),n(!1);case 5:case"end":return e.stop()}}),e)}))),500);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),k=function(){var e=Object(d.a)(l.a.mark((function e(t,a){var r,o,c,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u([]),r=a.id_producto,o=a.codigo_producto,c=a.nombre_producto,e.next=6,ri.get({table:"productos_depositos",include:"depositos",on:"id_deposito_deposito,id_deposito",where:"id_producto_deposito,=,".concat(r)});case 6:"ok"===(i=e.sent).response?f({id_producto:r,codigo_producto:o,nombre_producto:c,stock:i.results}):console.log(i),m(""),n(!1);case 10:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}();return Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("h2",{children:"Transferencias de productos"}),Object(w.jsxs)(Z.a,{container:!0,spacing:2,children:[Object(w.jsx)(Z.a,{item:!0,sm:12,children:Object(w.jsx)(sr.a,{disabled:""!==h.nombre_producto,loading:a,loadingText:"Cargando...",noOptionsText:"No hay productos con ese nombre",onChange:k,fullWidth:!0,isOptionEqualToValue:function(e,t){return(null===e||void 0===e?void 0:e.id_producto)===(null===t||void 0===t?void 0:t.id_producto)},inputValue:p,options:s,getOptionLabel:function(e){return e.nombre_producto+" - "+e.codigo_producto},clearOnBlur:!0,disableClearable:!0,renderInput:function(e){return Object(w.jsx)(Fe.a,Object(Te.a)(Object(Te.a)({},e),{},{autoFocus:!0,inputRef:O,onChange:C,InputProps:Object(Te.a)(Object(Te.a)({},e.InputProps),{},{endAdornment:Object(w.jsxs)(w.Fragment,{children:[a&&Object(w.jsx)(U.a,{color:"inherit",size:20}),e.InputProps.endAdornment]})}),fullWidth:!0,placeholder:"Escriba el nombre o c\xf3digo del producto"}))}})}),""!==(null===h||void 0===h?void 0:h.nombre_producto)&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(ae.a,{variant:"outlined",onClick:function(){m(""),u([]),n(!1),f({id_producto:"",codigo_producto:"",nombre_producto:"",stock:[]}),O.current.focus()},children:"Limpiar"})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(de.a,{icon:!1,severity:"info",children:Object(w.jsxs)(te.a,{variant:"button",children:["CODIGO: ",Object(w.jsx)("u",{children:null===h||void 0===h?void 0:h.codigo_producto})]})})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(de.a,{icon:!1,severity:"success",children:Object(w.jsxs)(te.a,{variant:"button",children:["Producto: ",Object(w.jsx)("u",{children:null===h||void 0===h?void 0:h.nombre_producto})]})})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(Ut.a,{children:h.stock.map((function(e,t){return Object(w.jsxs)(Bt.a,{children:[Object(w.jsx)(Wa.a,{children:Object(w.jsx)(Ae.a,{arrow:!0,title:Object(w.jsx)("h3",{children:"Transferir"}),placement:"top",children:Object(w.jsx)(Pe.a,{onClick:function(){v(e.id_deposito_deposito),g(Object(Te.a)(Object(Te.a)({},_),{},{transferir:!0}))},children:Object(w.jsx)(ee.a,{children:"sync_alt"})})})}),Object(w.jsx)(Ht.a,{secondary:"Cantidad: ".concat(e.stock_producto_deposito),primary:"".concat(e.nombre_deposito)})]},t)}))})})]})]})]})},li=function(){return Object(w.jsxs)(ci,{children:[Object(w.jsx)(ii,{}),Object(w.jsx)(si,{})]})},di=a(883),ui=function(){return Object(w.jsxs)(re.a,{children:[Object(w.jsxs)("h2",{children:["INFORMACION Y AYUDA ",Object(w.jsx)(ee.a,{color:"primary",children:"help"})]}),Object(w.jsxs)(Z.a,{container:!0,children:[Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(de.a,{icon:!1,children:Object(w.jsxs)(te.a,{variant:"h6",children:["Sistema de ventas, facturaci\xf3n e inventario. ",Object(w.jsx)(di.a,{underline:"hover",href:"https://wa.me/595983202090",rel:"noreferrer",target:"_blank",children:" CONTACTO: 0983 202090"})]})})}),Object(w.jsx)(Z.a,{item:!0,xs:12,children:Object(w.jsx)(de.a,{variant:"outlined",severity:"info",icon:Object(w.jsx)(ee.a,{children:"done"}),children:Object(w.jsx)(te.a,{variant:"overline",children:"Sistema desarrollado por Derlis Ruiz Diaz."})})})]})]})},ji=function(e){var t=e.children,a=e.id,r=I(),n=r.logueado,o=(r.cargando,r.permisos);return n&&!o.some((function(e){return parseInt(e.id_permiso_permiso)===parseInt(a)}))?Object(w.jsx)(H.a,{to:"/notautorized"}):n?Object(w.jsx)(aa,{children:t}):Object(w.jsx)(H.a,{to:"/"})};function bi(){var e="/";return Object(w.jsxs)(H.d,{children:[Object(w.jsx)(H.b,{path:"/salir",element:Object(w.jsx)(fr,{})}),Object(w.jsx)(H.b,{path:"/ventas",element:Object(w.jsx)(ji,{id:1,children:Object(w.jsx)(tn,{})})}),Object(w.jsx)(H.b,{path:"/productos",element:Object(w.jsx)(ji,{id:8,children:Object(w.jsx)(Sa,{})})}),Object(w.jsx)(H.b,{path:"/productos/bc",element:Object(w.jsx)(ji,{id:8,children:Object(w.jsx)(Mc,{})})}),Object(w.jsx)(H.b,{path:"/productos/new",element:Object(w.jsx)(ji,{id:9,children:Object(w.jsx)(Ya,{})})}),Object(w.jsx)(H.b,{path:"/productos/new/:id",element:Object(w.jsx)(ji,{id:9,children:Object(w.jsx)(rr,{})})}),Object(w.jsx)(H.b,{path:"/categorias",element:Object(w.jsx)(ji,{id:10,children:Object(w.jsx)(We,{})})}),Object(w.jsx)(H.b,{path:"/categorias/new",element:Object(w.jsx)(ji,{id:11,children:Object(w.jsx)(Xe,{})})}),Object(w.jsx)(H.b,{path:"/categorias/new/:id",element:Object(w.jsx)(ji,{id:11,children:Object(w.jsx)(Xe,{})})}),Object(w.jsx)(H.b,{path:"/marcas",element:Object(w.jsx)(ji,{id:12,children:Object(w.jsx)(ln,{})})}),Object(w.jsx)(H.b,{path:"/proveedores",element:Object(w.jsx)(ji,{id:14,children:Object(w.jsx)(hr,{})})}),Object(w.jsx)(H.b,{path:"/facturas",element:Object(w.jsx)(ji,{id:4,children:Object(w.jsx)(Mt,{})})}),Object(w.jsx)(H.b,{path:"/entregas",element:Object(w.jsx)(ji,{id:16,children:Object(w.jsx)(go,{})})}),Object(w.jsx)(H.b,{path:"/entregas/view/:id",element:Object(w.jsx)(ji,{id:16,children:Object(w.jsx)(Oo,{})})}),Object(w.jsx)(H.b,{path:"/apartados",element:Object(w.jsx)(ji,{id:18,children:Object(w.jsx)(jr,{})})}),Object(w.jsx)(H.b,{path:"/compras",element:Object(w.jsx)(ji,{id:20,children:Object(w.jsx)(Sn,{})})}),Object(w.jsx)(H.b,{path:"/movimientos",element:Object(w.jsx)(ji,{id:24,children:Object(w.jsx)(Hn,{})})}),Object(w.jsx)(H.b,{path:"/cajas",element:Object(w.jsx)(ji,{id:22,children:Object(w.jsx)(Ln,{})})}),Object(w.jsx)(H.b,{path:"/clientes",element:Object(w.jsx)(ji,{id:28,children:Object(w.jsx)(tt,{})})}),Object(w.jsx)(H.b,{path:"/clientes/new",element:Object(w.jsx)(ji,{id:29,children:Object(w.jsx)(it,{})})}),Object(w.jsx)(H.b,{path:"/clientes/new/:id",element:Object(w.jsx)(ji,{id:29,children:Object(w.jsx)(it,{})})}),Object(w.jsx)(H.b,{path:"/monedas",element:Object(w.jsx)(ji,{id:30,children:Object(w.jsx)(jo,{})})}),Object(w.jsx)(H.b,{path:"/medidas",element:Object(w.jsx)(ji,{id:32,children:Object(w.jsx)(Uo,{})})}),Object(w.jsx)(H.b,{path:"/usuarios",element:Object(w.jsx)(ji,{id:34,children:Object(w.jsx)(Yc,{})})}),Object(w.jsx)(H.b,{path:"/settings",element:Object(w.jsx)(ji,{id:36,children:Object(w.jsx)(kr,{})})}),Object(w.jsx)(H.b,{path:"/dashboard",element:Object(w.jsx)(ji,{id:59,children:Object(w.jsx)(Ot,{})})}),Object(w.jsx)(H.b,{path:"/depositos",element:Object(w.jsx)(ji,{id:39,children:Object(w.jsx)(oo,{})})}),Object(w.jsx)(H.b,{path:"/empleados",element:Object(w.jsx)(ji,{id:41,children:Object(w.jsx)(Do,{})})}),Object(w.jsx)(H.b,{path:"/registrofacturas",element:Object(w.jsx)(ji,{id:38,children:Object(w.jsx)(yo,{})})}),Object(w.jsx)(H.b,{path:"/inventario",element:Object(w.jsx)(ji,{id:43,children:Object(w.jsx)(Ro,{})})}),Object(w.jsx)(H.b,{path:"/informes",element:Object(w.jsx)(ji,{id:44,children:Object(w.jsx)($o,{})})}),Object(w.jsx)(H.b,{path:"/impuestos",element:Object(w.jsx)(ji,{id:45,children:Object(w.jsx)(rc,{})})}),Object(w.jsx)(H.b,{path:"/cuentas",element:Object(w.jsx)(ji,{id:47,children:Object(w.jsx)(jc,{})})}),Object(w.jsx)(H.b,{path:"/registromovimientos",element:Object(w.jsx)(ji,{id:26,children:Object(w.jsx)(Qn,{})})}),Object(w.jsx)(H.b,{path:"/turnos",element:Object(w.jsx)(ji,{id:49,children:Object(w.jsx)(Cc,{})})}),Object(w.jsx)(H.b,{path:"/agenda",element:Object(w.jsx)(ji,{id:58,children:Object(w.jsx)(Tc,{})})}),Object(w.jsx)(H.b,{path:"/notas",element:Object(w.jsx)(ji,{id:6,children:Object(w.jsx)(ti,{})})}),Object(w.jsx)(H.b,{path:"/transferencias",element:Object(w.jsx)(ji,{id:60,children:Object(w.jsx)(li,{})})}),Object(w.jsx)(H.b,{path:"/info",element:Object(w.jsx)(ji,{id:59,children:Object(w.jsx)(ui,{})})}),Object(w.jsx)(H.b,{path:"/notautorized",element:Object(w.jsx)(Zn,{})}),Object(w.jsx)(H.b,{path:e,element:Object(w.jsx)(Qc,{})}),Object(w.jsx)(H.b,{path:"*",element:Object(w.jsx)(ra,{})})]})}function pi(){return I().cargando?Object(w.jsx)(V,{}):Object(w.jsx)(bi,{})}function mi(){var e=Object(H.f)().pathname;return Object(c.useEffect)((function(){window.scrollTo(0,0),document.title=h}),[e]),null}var Oi=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function xi(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var hi=Object(c.createContext)(),fi=function(e){var t=e.children,a=JSON.parse(localStorage.getItem("dataConfig")),n=Object(c.useState)(a||null),o=Object(r.a)(n,2),i=o[0],s=o[1],u=function(){var e=Object(d.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s(t),localStorage.setItem("dataConfig",JSON.stringify(t)),window.location.reload();case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(w.jsx)(hi.Provider,{value:{dataConfig:i,setDataConfig:s,setConfig:u},children:t})},gi=function(e){var t=e.basename,a=e.children,n=e.history,o=i.a.useState({action:n.action,location:n.location}),c=Object(r.a)(o,2),s=c[0],l=c[1];return i.a.useLayoutEffect((function(){return n.listen(l)}),[n]),Object(w.jsx)(H.c,{basename:t,children:a,location:s.location,navigationType:s.action,navigator:n})};o.a.render(Object(w.jsx)(pt,{children:Object(w.jsx)(fi,{children:Object(w.jsx)(P,{children:Object(w.jsx)(M,{children:Object(w.jsx)(W,{children:Object(w.jsx)(vt,{children:Object(w.jsxs)(gi,{history:p,children:[Object(w.jsx)(mi,{}),Object(w.jsx)(pi,{})]})})})})})})}),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("","/service-worker.js");Oi?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(a){var r=a.headers.get("content-type");404===a.status||null!=r&&-1===r.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):xi(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):xi(t,e)}))}}()}},[[742,1,2]]]);
//# sourceMappingURL=main.d3ff30cb.chunk.js.map